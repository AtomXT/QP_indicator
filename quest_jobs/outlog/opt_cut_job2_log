[3, 50, 'autompg']
[0.00590211 0.00739742 0.01237278 1.         1.        ]
Set parameter TokenServer to value "questlicense2.quest.northwestern.edu"
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job2.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
The relaxed obj is 0.04027515330811937.
The larges value of x is 1.9470711486023513
Use new Big-M 3.8941422972047026.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 100 rows, 103 columns and 200 nonzeros
Model fingerprint: 0x9cf75adb
Model has 206 quadratic objective terms
Variable types: 53 continuous, 50 integer (50 binary)
Coefficient statistics:
  Matrix range     [1e+00, 4e+00]
  Objective range  [4e-03, 3e+01]
  QObjective range [7e-02, 5e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 25.0000000
Presolve time: 0.00s
Presolved: 100 rows, 103 columns, 200 nonzeros
Presolved model has 206 quadratic objective terms
Variable types: 53 continuous, 50 integer (50 binary)

Root relaxation: objective 4.837058e+00, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    4.83706    0   29   25.00000    4.83706  80.7%     -    0s
H    0     0                       9.0978612    4.83706  46.8%     -    0s
H    0     0                       9.0515609    4.83706  46.6%     -    0s
     0     0    4.83706    0   29    9.05156    4.83706  46.6%     -    0s
H    0     0                       9.0480644    4.83706  46.5%     -    0s
     0     2    4.83706    0   29    9.04806    4.83706  46.5%     -    0s

Explored 165 nodes (1479 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 8 (of 52 available processors)

Solution count 2: 9.04806 25 

Optimal solution found (tolerance 1.00e-04)
Best objective 9.048064400493e+00, best bound 9.048064400493e+00, gap 0.0000%

User-callback calls 572, time in user-callback 0.00 sec
--------------------------------
solve the problem in original formulation
The obj is 9.048064400492706.
The root upper bound is: 9.048064400492706, lower bound is: 4.837057685480424. The root gap is: 46.5404%. Runtime: 0.08141207695007324.
[25 26 28 30 32]
Number of outliers: 5
--------------------------------
The decomposition time is 0.05826212652027607.
Optimal value: 1.7635583737926879
The decomposition time is 0.042310480028390884.
Optimal value: 0.5420560750576873
The decomposition time is 0.04941985197365284.
Optimal value: 6.6638878417868135
The best pair is: [[1, 2]]
------------------------
The decomposition time is 0.049066778272390366.
Optimal value: 6.6638878417868135
4.837065405820798
6.22265394565704
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 350 rows, 203 columns and 1150 nonzeros
Model fingerprint: 0x69693944
Model has 206 quadratic objective terms
Variable types: 53 continuous, 150 integer (150 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+03]
  Objective range  [4e-03, 3e+01]
  QObjective range [7e-02, 5e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 1e+03]
Found heuristic solution: objective 28.6952233
Presolve time: 0.00s
Presolved: 350 rows, 203 columns, 1150 nonzeros
Presolved model has 206 quadratic objective terms
Variable types: 53 continuous, 150 integer (150 binary)
Found heuristic solution: objective 20.7757988

Root relaxation: objective 4.837058e+00, 502 iterations, 0.00 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    4.83706    0   58   20.77580    4.83706  76.7%     -    0s
H    0     0                      15.2660101    4.83706  68.3%     -    0s
H    0     0                      11.5463425    4.83706  58.1%     -    0s
     0     0    4.83706    0   60   11.54634    4.83706  58.1%     -    0s
H    0     0                       9.0480644    4.83706  46.5%     -    0s
     0     2    5.44254    0   60    9.04806    5.44254  39.8%     -    0s

Cutting planes:
  Learned: 7
  Clique: 9

Explored 89 nodes (1665 simplex iterations) in 0.25 seconds (0.10 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 9.04806 11.5463 15.266 ... 28.6952

Optimal solution found (tolerance 1.00e-04)
Best objective 9.048064400493e+00, best bound 9.048020311893e+00, gap 0.0005%

User-callback calls 444, time in user-callback 0.00 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 9.04806440049272.
The root upper bound is: 9.04806440049272, lower bound is: 5.442535796839859. The root gap is: 39.8486%. Runtime: 0.24797892570495605.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 351 rows, 204 columns and 1253 nonzeros
Model fingerprint: 0x19b80462
Model has 206 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 54 continuous, 150 integer (150 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+03]
  QMatrix range    [1e-08, 4e+00]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [4e-03, 3e+01]
  QObjective range [7e-02, 5e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 1e+03]
Warning: diagonal adjustment of 1.7e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 351 rows, 204 columns, 1253 nonzeros
Presolved model has 206 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 54 continuous, 150 integer (150 binary)

Root relaxation: objective 6.222652e+00, 823 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    6.22265    0   58          -    6.22265      -     -    0s
     0     0    6.22265    0   58          -    6.22265      -     -    0s
     0     0    6.22266    0   58          -    6.22266      -     -    0s
H    0     0                      15.2660094    6.22266  59.2%     -    0s
H    0     0                      11.5463421    6.22737  46.1%     -    0s
     0     2    6.22737    0   58   11.54634    6.22737  46.1%     -    0s
H   31    20                       9.0480646    6.47713  28.4%  37.7    0s
H   34    20                       9.0480633    6.47713  28.4%  34.9    0s

Cutting planes:
  Learned: 19
  Clique: 9

Explored 567 nodes (7607 simplex iterations) in 0.45 seconds (0.21 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 9.04806 11.5463 15.266 

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (1.7508e-06) exceeds tolerance
Best objective 9.048063271736e+00, best bound 9.047160851874e+00, gap 0.0100%

User-callback calls 1450, time in user-callback 0.00 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job2.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
9.048063271735508
The root upper bound is: 11.546342142391895, lower bound is: 6.227368719092948. The root gap is: 46.0663%. Runtime: 0.4528219699859619.
--------------------------------------------------
   m   n  dataset formulation  ...    end_lb   end_gap  node_count      time
0  3  50  autompg    original  ...  9.048064  0.000000       165.0  0.081412
1  3  50  autompg         opt  ...  9.048020  0.000005        89.0  0.247979
2  3  50  autompg     opt_cut  ...  9.047161  0.000100       567.0  0.452822

[3 rows x 12 columns]
[3, 60, 'autompg']
[0.00392601 0.00767025 0.01327101 1.         1.        ]
The relaxed obj is 0.048373710565872585.
The larges value of x is 2.285081900100683
Use new Big-M 4.570163800201366.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 120 rows, 123 columns and 240 nonzeros
Model fingerprint: 0x8a38515f
Model has 246 quadratic objective terms
Variable types: 63 continuous, 60 integer (60 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [1e-01, 4e+01]
  QObjective range [1e-01, 6e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 30.0000000
Presolve time: 0.00s
Presolved: 120 rows, 123 columns, 240 nonzeros
Presolved model has 246 quadratic objective terms
Variable types: 63 continuous, 60 integer (60 binary)

Root relaxation: objective 4.614281e+00, 276 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    4.61428    0   35   30.00000    4.61428  84.6%     -    0s
H    0     0                      10.8845295    4.61428  57.6%     -    0s
H    0     0                      10.7488678    4.61428  57.1%     -    0s
H    0     0                      10.6750775    4.61428  56.8%     -    0s
H    0     0                      10.5510912    4.61428  56.3%     -    0s
H    0     0                      10.5026218    4.61428  56.1%     -    0s
     0     0    4.83798    0   35   10.50262    4.83798  53.9%     -    0s
     0     2    4.83798    0   35   10.50262    4.83798  53.9%     -    0s

Explored 1760 nodes (9416 simplex iterations) in 0.39 seconds (0.09 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 10.5026 10.7489 10.8845 30 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.050262184474e+01, best bound 1.050262184474e+01, gap 0.0000%

User-callback calls 3820, time in user-callback 0.01 sec
--------------------------------
solve the problem in original formulation
The obj is 10.50262184474414.
The root upper bound is: 10.50262184474414, lower bound is: 4.837978606205795. The root gap is: 53.9355%. Runtime: 0.38980984687805176.
[28 30 54]
Number of outliers: 3
--------------------------------
The decomposition time is 0.0646811742335558.
Optimal value: 1.1516408927422321
The decomposition time is 0.05977458134293556.
Optimal value: 0.8402135871690515
The decomposition time is 0.06834865547716618.
Optimal value: 9.77962911713393
The best pair is: [[1, 2]]
------------------------
The decomposition time is 0.06870171055197716.
Optimal value: 9.77962911713393
4.614291882815998
5.660331741394316
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 420 rows, 243 columns and 1380 nonzeros
Model fingerprint: 0x0c56c744
Model has 246 quadratic objective terms
Variable types: 63 continuous, 180 integer (180 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+03]
  Objective range  [1e-01, 4e+01]
  QObjective range [1e-01, 6e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-02, 1e+03]
Found heuristic solution: objective 19.1143647
Presolve time: 0.00s
Presolved: 420 rows, 243 columns, 1380 nonzeros
Presolved model has 246 quadratic objective terms
Variable types: 63 continuous, 180 integer (180 binary)

Root relaxation: objective 4.614281e+00, 692 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    4.61428    0   70   19.11436    4.61428  75.9%     -    0s
H    0     0                      12.7677444    4.61428  63.9%     -    0s
H    0     0                      11.3528555    4.61428  59.4%     -    0s
     0     0    4.61428    0   71   11.35286    4.61428  59.4%     -    0s
H    0     0                      10.5026218    4.61428  56.1%     -    0s
     0     2    5.26285    0   71   10.50262    5.26285  49.9%     -    0s

Cutting planes:
  Learned: 5
  Clique: 4

Explored 1392 nodes (11974 simplex iterations) in 0.35 seconds (0.28 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 10.5026 11.3529 12.7677 19.1144 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.050262184474e+01, best bound 1.050262184474e+01, gap 0.0000%

User-callback calls 3086, time in user-callback 0.00 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 10.502621844744137.
The root upper bound is: 10.502621844744137, lower bound is: 5.262846707400192. The root gap is: 49.8902%. Runtime: 0.34735608100891113.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 421 rows, 244 columns and 1503 nonzeros
Model fingerprint: 0x6b2f456c
Model has 246 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 64 continuous, 180 integer (180 binary)
Coefficient statistics:
  Matrix range     [2e-03, 1e+03]
  QMatrix range    [8e-09, 9e+00]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [1e-01, 4e+01]
  QObjective range [1e-01, 6e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-02, 1e+03]
Warning: diagonal adjustment of 4.5e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 421 rows, 244 columns, 1503 nonzeros
Presolved model has 246 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 64 continuous, 180 integer (180 binary)

Root relaxation: objective 5.660295e+00, 693 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    5.66029    0   70          -    5.66029      -     -    0s
     0     0    5.66031    0   70          -    5.66031      -     -    0s
H    0     0                      19.5069819    5.66031  71.0%     -    0s
H    0     0                      10.9260040    5.66033  48.2%     -    0s
     0     2    5.66033    0   70   10.92600    5.66033  48.2%     -    0s
H   31    34                      10.5026220    5.82523  44.5%  39.9    0s
H   37    34                      10.5026193    5.82523  44.5%  36.4    0s
H   64    50                      10.5026171    5.82523  44.5%  33.3    0s

Cutting planes:
  Learned: 22
  Clique: 7

Explored 2880 nodes (34526 simplex iterations) in 0.58 seconds (0.61 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 10.5026 10.926 19.507 

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (7.4364e-06) exceeds tolerance
Best objective 1.050261712958e+01, best bound 1.050261712958e+01, gap 0.0000%

User-callback calls 6119, time in user-callback 0.01 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job2.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
10.502617129578216
The root upper bound is: 10.926003968083567, lower bound is: 5.660326460458044. The root gap is: 48.194%. Runtime: 0.5793612003326416.
--------------------------------------------------
   m   n  dataset formulation  ...     end_lb   end_gap  node_count      time
0  3  50  autompg    original  ...   9.048064  0.000000       165.0  0.081412
1  3  50  autompg         opt  ...   9.048020  0.000005        89.0  0.247979
2  3  50  autompg     opt_cut  ...   9.047161  0.000100       567.0  0.452822
3  3  60  autompg    original  ...  10.502622  0.000000      1760.0  0.389810
4  3  60  autompg         opt  ...  10.502622  0.000000      1392.0  0.347356
5  3  60  autompg     opt_cut  ...  10.502617  0.000000      2880.0  0.579361

[6 rows x 12 columns]
[3, 70, 'autompg']
[0.00390478 0.00548318 0.01031156 1.         1.        ]
The relaxed obj is 0.05541761627829089.
The larges value of x is 2.4101746628439895
Use new Big-M 4.820349325687979.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 140 rows, 143 columns and 280 nonzeros
Model fingerprint: 0x40f1e940
Model has 286 quadratic objective terms
Variable types: 73 continuous, 70 integer (70 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [2e-01, 5e+01]
  QObjective range [4e-02, 7e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 35.0000000
Presolve time: 0.00s
Presolved: 140 rows, 143 columns, 280 nonzeros
Presolved model has 286 quadratic objective terms
Variable types: 73 continuous, 70 integer (70 binary)

Root relaxation: objective 5.264429e+00, 341 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    5.26443    0   44   35.00000    5.26443  85.0%     -    0s
H    0     0                      12.5292814    5.26443  58.0%     -    0s
H    0     0                      12.4469971    5.26443  57.7%     -    0s
H    0     0                      12.3570002    5.26443  57.4%     -    0s
     0     0    5.26443    0   44   12.35700    5.26443  57.4%     -    0s
H    0     0                      12.2950454    5.26443  57.2%     -    0s
     0     2    5.26443    0   44   12.29505    5.26443  57.2%     -    0s

Explored 4376 nodes (27980 simplex iterations) in 0.31 seconds (0.23 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 12.295 12.5293 35 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.229504536594e+01, best bound 1.229504536594e+01, gap 0.0000%

User-callback calls 9068, time in user-callback 0.01 sec
--------------------------------
solve the problem in original formulation
The obj is 12.295045365937767.
The root upper bound is: 12.295045365937767, lower bound is: 5.264428541245806. The root gap is: 57.1825%. Runtime: 0.31565213203430176.
[26 28 30 32 54]
Number of outliers: 5
--------------------------------
The decomposition time is 0.08163030445575714.
Optimal value: 1.4087546612744515
The decomposition time is 0.08253506571054459.
Optimal value: 4.183892142047109
The decomposition time is 0.08655328303575516.
Optimal value: 10.20061300815213
The best pair is: [[1, 2]]
------------------------
The decomposition time is 0.09107794985175133.
Optimal value: 10.20061300815213
5.264430837807733
5.264451180527541
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 490 rows, 283 columns and 1610 nonzeros
Model fingerprint: 0xe4695731
Model has 286 quadratic objective terms
Variable types: 73 continuous, 210 integer (210 binary)
Coefficient statistics:
  Matrix range     [2e-02, 1e+03]
  Objective range  [2e-01, 5e+01]
  QObjective range [4e-02, 7e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [8e-02, 1e+03]
Found heuristic solution: objective 18.2653572
Presolve time: 0.00s
Presolved: 490 rows, 283 columns, 1610 nonzeros
Presolved model has 286 quadratic objective terms
Variable types: 73 continuous, 210 integer (210 binary)

Root relaxation: objective 5.264429e+00, 705 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    5.26443    0   88   18.26536    5.26443  71.2%     -    0s
H    0     0                      14.6231881    5.26443  64.0%     -    0s
H    0     0                      12.3306878    5.26443  57.3%     -    0s
     0     0    5.26443    0   91   12.33069    5.26443  57.3%     -    0s
H    0     0                      12.2950454    5.26443  57.2%     -    0s
     0     2    7.41632    0   91   12.29505    7.41632  39.7%     -    0s

Cutting planes:
  Learned: 14
  Clique: 7

Explored 1823 nodes (24748 simplex iterations) in 0.45 seconds (0.54 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 12.295 12.3307 14.6232 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.229504536594e+01, best bound 1.229504536594e+01, gap 0.0000%

User-callback calls 3951, time in user-callback 0.01 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 12.295045365937767.
The root upper bound is: 12.295045365937767, lower bound is: 7.416316026649025. The root gap is: 39.6805%. Runtime: 0.45075201988220215.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 491 rows, 284 columns and 1753 nonzeros
Model fingerprint: 0x7b2f2728
Model has 286 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 74 continuous, 210 integer (210 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+03]
  QMatrix range    [1e-08, 9e+00]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [2e-01, 5e+01]
  QObjective range [4e-02, 7e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [8e-02, 1e+03]
Warning: diagonal adjustment of 1.4e-07 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 491 rows, 284 columns, 1753 nonzeros
Presolved model has 286 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 74 continuous, 210 integer (210 binary)

Root relaxation: objective 4.448185e+00, 803 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    4.44818    0   88          -    4.44818      -     -    0s
H    0     0                      15.4955196    4.44818  71.3%     -    0s
     0     0    4.44864    0   93   15.49552    4.44864  71.3%     -    0s
H    0     0                      12.2950455    4.44864  63.8%     -    0s
     0     0    5.18011    0   84   12.29505    5.18011  57.9%     -    0s
H    0     0                      12.2950454    5.18011  57.9%     -    0s
     0     0    5.21881    0   89   12.29505    5.21881  57.6%     -    0s
H    0     0                      12.2950394    5.21881  57.6%     -    0s
     0     0    5.22228    0   89   12.29504    5.22228  57.5%     -    0s
     0     0    7.15400    0   91   12.29504    7.15400  41.8%     -    0s
     0     0    7.15400    0   91   12.29504    7.15400  41.8%     -    0s
     0     0    7.20142    0   89   12.29504    7.20142  41.4%     -    0s
     0     0    7.20142    0   91   12.29504    7.20142  41.4%     -    0s
     0     0    7.20142    0   91   12.29504    7.20142  41.4%     -    0s
     0     0    7.20142    0   91   12.29504    7.20142  41.4%     -    0s
     0     2    7.20142    0   91   12.29504    7.20142  41.4%     -    0s
H  958   321                      12.2950388    8.59245  30.1%  17.7    0s

Cutting planes:
  Learned: 8

Explored 1920 nodes (39290 simplex iterations) in 1.52 seconds (1.27 work units)
Thread count was 8 (of 52 available processors)

Solution count 2: 12.295 15.4955 

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (8.5307e-06) exceeds tolerance
Best objective 1.229503879213e+01, best bound 1.229491649599e+01, gap 0.0010%

User-callback calls 4527, time in user-callback 0.01 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job2.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
12.295038792131859
The root upper bound is: 12.295039364385204, lower bound is: 7.201421951485786. The root gap is: 41.4282%. Runtime: 1.5246388912200928.
--------------------------------------------------
   m   n  dataset formulation  ...     end_lb   end_gap  node_count      time
0  3  50  autompg    original  ...   9.048064  0.000000       165.0  0.081412
1  3  50  autompg         opt  ...   9.048020  0.000005        89.0  0.247979
2  3  50  autompg     opt_cut  ...   9.047161  0.000100       567.0  0.452822
3  3  60  autompg    original  ...  10.502622  0.000000      1760.0  0.389810
4  3  60  autompg         opt  ...  10.502622  0.000000      1392.0  0.347356
5  3  60  autompg     opt_cut  ...  10.502617  0.000000      2880.0  0.579361
6  3  70  autompg    original  ...  12.295045  0.000000      4376.0  0.315652
7  3  70  autompg         opt  ...  12.295045  0.000000      1823.0  0.450752
8  3  70  autompg     opt_cut  ...  12.294916  0.000010      1920.0  1.524639

[9 rows x 12 columns]
[3, 80, 'autompg']
[0.00330536 0.00512383 0.00886908 1.         1.        ]
The relaxed obj is 0.06355273694434516.
The larges value of x is 2.5305865257328835
Use new Big-M 5.061173051465767.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 160 rows, 163 columns and 320 nonzeros
Model fingerprint: 0x1eaba93a
Model has 326 quadratic objective terms
Variable types: 83 continuous, 80 integer (80 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [3e-02, 5e+01]
  QObjective range [2e-01, 8e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 40.0000000
Presolve time: 0.00s
Presolved: 160 rows, 163 columns, 320 nonzeros
Presolved model has 326 quadratic objective terms
Variable types: 83 continuous, 80 integer (80 binary)

Root relaxation: objective 6.673184e+00, 391 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    6.67318    0   52   40.00000    6.67318  83.3%     -    0s
H    0     0                      17.4169926    6.67318  61.7%     -    0s
H    0     0                      17.2209245    6.67318  61.2%     -    0s
H    0     0                      16.8351569    6.67318  60.4%     -    0s
H    0     0                      16.7849627    6.67318  60.2%     -    0s
H    0     0                      16.6157010    6.67318  59.8%     -    0s
     0     0    6.89999    0   52   16.61570    6.89999  58.5%     -    0s
     0     2    6.89999    0   52   16.61570    6.89999  58.5%     -    0s

Explored 41269 nodes (291695 simplex iterations) in 1.90 seconds (2.29 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 16.6157 17.2209 17.417 40 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.661570096948e+01, best bound 1.661570096948e+01, gap 0.0000%

User-callback calls 83243, time in user-callback 0.10 sec
--------------------------------
solve the problem in original formulation
The obj is 16.615700969475675.
The root upper bound is: 16.615700969475675, lower bound is: 6.899985539725415. The root gap is: 58.4731%. Runtime: 1.8997249603271484.
[25 26 28 30 32 51 54 70 79]
Number of outliers: 9
--------------------------------
The decomposition time is 0.10316995717585087.
Optimal value: 1.2097839263659236
The decomposition time is 0.11020581237971783.
Optimal value: 19.28081355106644
The decomposition time is 0.1197461299598217.
Optimal value: 11.302941056416842
The best pair is: [[0, 2]]
------------------------
The decomposition time is 0.10960914194583893.
Optimal value: 19.28081355106644
6.673186889775799
8.881761502716778
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 560 rows, 323 columns and 1840 nonzeros
Model fingerprint: 0xb04afb88
Model has 326 quadratic objective terms
Variable types: 83 continuous, 240 integer (240 binary)
Coefficient statistics:
  Matrix range     [8e-02, 1e+03]
  Objective range  [3e-02, 5e+01]
  QObjective range [2e-01, 8e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-03, 1e+03]
Found heuristic solution: objective 25.8851881
Presolve time: 0.00s
Presolved: 560 rows, 323 columns, 1840 nonzeros
Presolved model has 326 quadratic objective terms
Variable types: 83 continuous, 240 integer (240 binary)

Root relaxation: objective 6.673184e+00, 913 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    6.67318    0  104   25.88519    6.67318  74.2%     -    0s
H    0     0                      17.0346518    6.67318  60.8%     -    0s
     0     0    6.67318    0  109   17.03465    6.67318  60.8%     -    0s
H    0     0                      16.7253409    8.78405  47.5%     -    0s
     0     2    8.78405    0  109   16.72534    8.78405  47.5%     -    0s
*  351   217              28      16.6157010   10.34980  37.7%  20.3    0s

Cutting planes:
  Learned: 25
  Clique: 11

Explored 8072 nodes (149862 simplex iterations) in 1.42 seconds (2.24 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 16.6157 16.7253 17.0347 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.661570096948e+01, best bound 1.661570096948e+01, gap 0.0000%

User-callback calls 16626, time in user-callback 0.02 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 16.615700969475668.
The root upper bound is: 16.725340934579872, lower bound is: 8.784054268320132. The root gap is: 47.4806%. Runtime: 1.4208581447601318.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 561 rows, 324 columns and 2003 nonzeros
Model fingerprint: 0x7fdb0a3f
Model has 326 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 84 continuous, 240 integer (240 binary)
Coefficient statistics:
  Matrix range     [2e-02, 1e+03]
  QMatrix range    [1e-08, 1e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [3e-02, 5e+01]
  QObjective range [2e-02, 8e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-03, 1e+03]
Warning: diagonal adjustment of 2.4e-08 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 561 rows, 324 columns, 2003 nonzeros
Presolved model has 326 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 84 continuous, 240 integer (240 binary)

Root relaxation: objective 8.881753e+00, 1108 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    8.88175    0  104          -    8.88175      -     -    0s
H    0     0                      17.0346524    8.88175  47.9%     -    0s
H    0     0                      17.0346519    8.88175  47.9%     -    0s
     0     0    8.88175    0  104   17.03465    8.88175  47.9%     -    0s
     0     0    8.88175    0  104   17.03465    8.88175  47.9%     -    0s
     0     0    8.88175    0  104   17.03465    8.88175  47.9%     -    0s
     0     0    8.88175    0  104   17.03465    8.88175  47.9%     -    0s
H    0     0                      17.0346518    8.89167  47.8%     -    0s
     0     2    8.89167    0  104   17.03465    8.89167  47.8%     -    0s
H   32    39                      16.7253407    8.89167  46.8%  41.9    0s
H   74    70                      16.6548126    8.89167  46.6%  34.8    0s
H  176   136                      16.6157014    8.90415  46.4%  29.9    0s
H  442   230                      16.6156921    8.93697  46.2%  24.5    0s

Cutting planes:
  Learned: 11

Explored 4829 nodes (94032 simplex iterations) in 3.15 seconds (3.71 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 16.6157 16.6548 16.7253 17.0347 
No other solutions better than 16.6157

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (9.2050e-06) exceeds tolerance
Best objective 1.661569209824e+01, best bound 1.661569210132e+01, gap 0.0000%

User-callback calls 10957, time in user-callback 0.02 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job2.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
16.615692098244015
The root upper bound is: 17.034651792097097, lower bound is: 8.891666276958166. The root gap is: 47.8025%. Runtime: 3.155773162841797.
--------------------------------------------------
    m   n  dataset formulation  ...     end_lb       end_gap  node_count      time
0   3  50  autompg    original  ...   9.048064  0.000000e+00       165.0  0.081412
1   3  50  autompg         opt  ...   9.048020  4.872711e-06        89.0  0.247979
2   3  50  autompg     opt_cut  ...   9.047161  9.973625e-05       567.0  0.452822
3   3  60  autompg    original  ...  10.502622  0.000000e+00      1760.0  0.389810
4   3  60  autompg         opt  ...  10.502622  0.000000e+00      1392.0  0.347356
5   3  60  autompg     opt_cut  ...  10.502617  0.000000e+00      2880.0  0.579361
6   3  70  autompg    original  ...  12.295045  0.000000e+00      4376.0  0.315652
7   3  70  autompg         opt  ...  12.295045  0.000000e+00      1823.0  0.450752
8   3  70  autompg     opt_cut  ...  12.294916  9.946788e-06      1920.0  1.524639
9   3  80  autompg    original  ...  16.615701  0.000000e+00     41269.0  1.899725
10  3  80  autompg         opt  ...  16.615701  0.000000e+00      8072.0  1.420858
11  3  80  autompg     opt_cut  ...  16.615692 -1.848775e-10      4829.0  3.155773

[12 rows x 12 columns]
[3, 90, 'autompg']
[0.00304563 0.00446297 0.00751559 1.         1.        ]
The relaxed obj is 0.0717736461939893.
The larges value of x is 2.4535683145326233
Use new Big-M 4.9071366290652465.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 180 rows, 183 columns and 360 nonzeros
Model fingerprint: 0x81417937
Model has 366 quadratic objective terms
Variable types: 93 continuous, 90 integer (90 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [2e-02, 5e+01]
  QObjective range [1e-01, 9e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 45.0000000
Presolve time: 0.00s
Presolved: 180 rows, 183 columns, 360 nonzeros
Presolved model has 366 quadratic objective terms
Variable types: 93 continuous, 90 integer (90 binary)

Root relaxation: objective 7.836440e+00, 410 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    7.83644    0   63   45.00000    7.83644  82.6%     -    0s
H    0     0                      19.7451032    7.83644  60.3%     -    0s
H    0     0                      19.7108125    7.83644  60.2%     -    0s
H    0     0                      19.0299782    7.83644  58.8%     -    0s
H    0     0                      18.9917243    7.83644  58.7%     -    0s
H    0     0                      18.8553921    7.83644  58.4%     -    0s
     0     0    7.92145    0   63   18.85539    7.92145  58.0%     -    0s
H    0     0                      18.8491461    7.92145  58.0%     -    0s
     0     2    7.92145    0   63   18.84915    7.92145  58.0%     -    0s

Explored 116639 nodes (739962 simplex iterations) in 4.92 seconds (6.86 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 18.8491 18.8554 19.7108 ... 45

Optimal solution found (tolerance 1.00e-04)
Best objective 1.884914608780e+01, best bound 1.884914608780e+01, gap 0.0000%

User-callback calls 234382, time in user-callback 0.29 sec
--------------------------------
solve the problem in original formulation
The obj is 18.84914608780193.
The root upper bound is: 18.84914608780193, lower bound is: 7.921447466293139. The root gap is: 57.9745%. Runtime: 4.925281047821045.
[25 26 28 30 32 54 70 79 84]
Number of outliers: 9
--------------------------------
The decomposition time is 0.2659274060279131.
Optimal value: 1.1889578950465514
The decomposition time is 0.15128592401742935.
Optimal value: 12.62106743769386
The decomposition time is 0.14558880403637886.
Optimal value: 12.055716817999759
The best pair is: [[0, 2]]
------------------------
The decomposition time is 0.1487205307930708.
Optimal value: 12.62106743769386
7.836448902589048
9.639966765945879
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 630 rows, 363 columns and 2070 nonzeros
Model fingerprint: 0x6da49618
Model has 366 quadratic objective terms
Variable types: 93 continuous, 270 integer (270 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+03]
  Objective range  [2e-02, 5e+01]
  QObjective range [1e-01, 9e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 1e+03]
Found heuristic solution: objective 29.6654042
Presolve time: 0.00s
Presolved: 630 rows, 363 columns, 2070 nonzeros
Presolved model has 366 quadratic objective terms
Variable types: 93 continuous, 270 integer (270 binary)

Root relaxation: objective 7.836440e+00, 1004 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    7.83644    0  126   29.66540    7.83644  73.6%     -    0s
H    0     0                      20.8075945    7.83644  62.3%     -    0s
H    0     0                      20.1434467    7.83644  61.1%     -    0s
     0     0    7.83644    0  131   20.14345    7.83644  61.1%     -    0s
H    0     0                      19.8499785    7.83644  60.5%     -    0s
H    0     0                      19.5612556    7.83644  59.9%     -    0s
H    0     0                      18.8727822    8.51999  54.9%     -    0s
     0     2    8.51999    0  131   18.87278    8.51999  54.9%     -    0s
H   32    40                      18.8599190   10.71267  43.2%  20.9    0s
H   33    40                      18.8491461   10.71267  43.2%  20.7    0s

Cutting planes:
  Learned: 19
  Clique: 8

Explored 11994 nodes (275513 simplex iterations) in 4.63 seconds (6.84 work units)
Thread count was 8 (of 52 available processors)

Solution count 8: 18.8491 18.8599 18.8728 ... 29.6654

Optimal solution found (tolerance 1.00e-04)
Best objective 1.884914608780e+01, best bound 1.884914608780e+01, gap 0.0000%

User-callback calls 25910, time in user-callback 0.04 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 18.849146087801934.
The root upper bound is: 18.872782221818614, lower bound is: 8.519985067257748. The root gap is: 54.8557%. Runtime: 4.63234281539917.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 631 rows, 364 columns and 2253 nonzeros
Model fingerprint: 0x6dbabf53
Model has 366 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 94 continuous, 270 integer (270 binary)
Coefficient statistics:
  Matrix range     [5e-04, 1e+03]
  QMatrix range    [1e-08, 7e+00]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [2e-02, 5e+01]
  QObjective range [5e-02, 9e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 1e+03]
Warning: diagonal adjustment of 2.9e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 631 rows, 364 columns, 2253 nonzeros
Presolved model has 366 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 94 continuous, 270 integer (270 binary)

Root relaxation: objective 9.639789e+00, 1067 iterations, 0.02 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    9.63979    0  124          -    9.63979      -     -    0s
     0     0    9.63998    0  127          -    9.63998      -     -    0s
     0     0    9.63998    0  127          -    9.63998      -     -    0s
     0     0    9.63998    0  127          -    9.63998      -     -    0s
H    0     0                      44.2481062    9.63998  78.2%     -    0s
H    0     0                      37.8588302    9.64000  74.5%     -    0s
H    0     0                      36.2573654    9.64000  73.4%     -    0s
     0     2    9.64000    0  127   36.25737    9.64000  73.4%     -    0s
H   31    40                      21.4731120    9.64006  55.1%  39.7    0s
H   32    40                      19.5585567    9.64006  50.7%  39.5    0s
H   64    78                      19.0027637    9.64006  49.3%  27.4    0s
H   95   100                      18.8727823    9.64006  48.9%  22.3    0s
H   96   100                      18.8491462    9.64006  48.9%  22.2    0s
H  295   207                      18.8491461    9.87336  47.6%  22.2    0s
H  298   207                      18.8491454    9.87336  47.6%  22.1    0s
* 7235    40              47      18.8491439   17.59288  6.66%  22.5    4s
  7339     2 infeasible   41        18.84914   18.18760  3.51%  22.4    5s

Cutting planes:
  Learned: 19
  Clique: 7

Explored 7391 nodes (165849 simplex iterations) in 5.01 seconds (6.43 work units)
Thread count was 8 (of 52 available processors)

Solution count 8: 18.8491 18.8728 19.0028 ... 44.2481

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (2.1655e-06) exceeds tolerance
Best objective 1.884914394206e+01, best bound 1.884914394240e+01, gap 0.0000%

User-callback calls 16843, time in user-callback 0.02 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job2.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
18.84914394205742
The root upper bound is: 36.25736543634669, lower bound is: 9.639999673957593. The root gap is: 73.4123%. Runtime: 5.013493061065674.
--------------------------------------------------
    m   n  dataset formulation  ...     end_lb       end_gap  node_count      time
0   3  50  autompg    original  ...   9.048064  0.000000e+00       165.0  0.081412
1   3  50  autompg         opt  ...   9.048020  4.872711e-06        89.0  0.247979
2   3  50  autompg     opt_cut  ...   9.047161  9.973625e-05       567.0  0.452822
3   3  60  autompg    original  ...  10.502622  0.000000e+00      1760.0  0.389810
4   3  60  autompg         opt  ...  10.502622  0.000000e+00      1392.0  0.347356
5   3  60  autompg     opt_cut  ...  10.502617  0.000000e+00      2880.0  0.579361
6   3  70  autompg    original  ...  12.295045  0.000000e+00      4376.0  0.315652
7   3  70  autompg         opt  ...  12.295045  0.000000e+00      1823.0  0.450752
8   3  70  autompg     opt_cut  ...  12.294916  9.946788e-06      1920.0  1.524639
9   3  80  autompg    original  ...  16.615701  0.000000e+00     41269.0  1.899725
10  3  80  autompg         opt  ...  16.615701  0.000000e+00      8072.0  1.420858
11  3  80  autompg     opt_cut  ...  16.615692 -1.848775e-10      4829.0  3.155773
12  3  90  autompg    original  ...  18.849146  0.000000e+00    116639.0  4.925281
13  3  90  autompg         opt  ...  18.849146  0.000000e+00     11994.0  4.632343
14  3  90  autompg     opt_cut  ...  18.849144 -1.810854e-11      7391.0  5.013493

[15 rows x 12 columns]
[3, 100, 'autompg']
[0.00285807 0.00378796 0.00682196 1.         1.        ]
The relaxed obj is 0.07853228658468225.
The larges value of x is 2.5386144951952163
Use new Big-M 5.077228990390433.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 200 rows, 203 columns and 400 nonzeros
Model fingerprint: 0x9611f19b
Model has 406 quadratic objective terms
Variable types: 103 continuous, 100 integer (100 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [7e-02, 6e+01]
  QObjective range [1e-01, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 50.0000000
Presolve time: 0.00s
Presolved: 200 rows, 203 columns, 400 nonzeros
Presolved model has 406 quadratic objective terms
Variable types: 103 continuous, 100 integer (100 binary)

Root relaxation: objective 8.012716e+00, 463 iterations, 0.00 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    8.01272    0   70   50.00000    8.01272  84.0%     -    0s
H    0     0                      21.1306967    8.01272  62.1%     -    0s
H    0     0                      20.7945262    8.01272  61.5%     -    0s
H    0     0                      19.6858154    8.01272  59.3%     -    0s
H    0     0                      19.6724868    8.01272  59.3%     -    0s
H    0     0                      19.5227040    8.01272  59.0%     -    0s
     0     0    8.41158    0   70   19.52270    8.41158  56.9%     -    0s
H    0     0                      19.4834687    8.41158  56.8%     -    0s
H    0     0                      19.4627952    8.41158  56.8%     -    0s
     0     2    8.41158    0   70   19.46280    8.41158  56.8%     -    0s
 108198  9894   19.38218   32   50   19.46280   18.84342  3.18%   7.0    5s

Explored 128209 nodes (866996 simplex iterations) in 5.74 seconds (8.84 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 19.4628 19.4835 19.5227 ... 50

Optimal solution found (tolerance 1.00e-04)
Best objective 1.946279521766e+01, best bound 1.946279521766e+01, gap 0.0000%

User-callback calls 257624, time in user-callback 0.31 sec
--------------------------------
solve the problem in original formulation
The obj is 19.462795217658595.
The root upper bound is: 19.462795217658595, lower bound is: 8.411584517800467. The root gap is: 56.7812%. Runtime: 5.740149974822998.
[25 26 28 30 32 51 54 70 79 84]
Number of outliers: 10
--------------------------------
The decomposition time is 0.163332162424922.
Optimal value: 1.3648264307590754
The decomposition time is 0.1597028337419033.
Optimal value: 3.956937935054878
The decomposition time is 0.1831497885286808.
Optimal value: 12.363219227556675
The best pair is: [[1, 2]]
------------------------
The decomposition time is 0.18459991738200188.
Optimal value: 12.363219227556675
8.01272062599643
10.053758498044395
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 700 rows, 403 columns and 2300 nonzeros
Model fingerprint: 0xec8b8c47
Model has 406 quadratic objective terms
Variable types: 103 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+03]
  Objective range  [7e-02, 6e+01]
  QObjective range [1e-01, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-02, 1e+03]
Found heuristic solution: objective 36.4807364
Presolve time: 0.00s
Presolved: 700 rows, 403 columns, 2300 nonzeros
Presolved model has 406 quadratic objective terms
Variable types: 103 continuous, 300 integer (300 binary)

Root relaxation: objective 8.012716e+00, 1147 iterations, 0.02 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    8.01272    0  140   36.48074    8.01272  78.0%     -    0s
H    0     0                      20.8200372    8.01272  61.5%     -    0s
H    0     0                      20.2514563    8.01272  60.4%     -    0s
H    0     0                      19.8734887    8.01272  59.7%     -    0s
H    0     0                      19.4853579    8.01272  58.9%     -    0s
     0     0    8.01272    0  145   19.48536    8.01272  58.9%     -    0s
     0     2    8.65925    0  145   19.48536    8.65925  55.6%     -    0s
H   37    40                      19.4627952   10.97436  43.6%  22.3    0s
 12358    30     cutoff   30        19.46280   18.49461  4.97%  21.5    5s

Cutting planes:
  Learned: 16
  Clique: 10

Explored 12569 nodes (269694 simplex iterations) in 5.10 seconds (7.41 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 19.4628 19.4854 19.8735 ... 36.4807

Optimal solution found (tolerance 1.00e-04)
Best objective 1.946279521766e+01, best bound 1.946279521766e+01, gap 0.0000%

User-callback calls 26930, time in user-callback 0.03 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 19.462795217658567.
The root upper bound is: 19.485357935665725, lower bound is: 8.659254735905531. The root gap is: 55.5602%. Runtime: 5.100596904754639.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 701 rows, 404 columns and 2503 nonzeros
Model fingerprint: 0x4d0f3563
Model has 406 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 104 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [5e-04, 1e+03]
  QMatrix range    [1e-08, 1e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [7e-02, 6e+01]
  QObjective range [1e-01, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-02, 1e+03]
Warning: diagonal adjustment of 6.8e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 701 rows, 404 columns, 2503 nonzeros
Presolved model has 406 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 104 continuous, 300 integer (300 binary)

Root relaxation: objective 1.005374e+01, 1357 iterations, 0.02 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   10.05374    0  138          -   10.05374      -     -    0s
     0     0   10.05376    0  138          -   10.05376      -     -    0s
     0     0   10.05376    0  138          -   10.05376      -     -    0s
     0     0   10.05376    0  138          -   10.05376      -     -    0s
     0     0   10.05376    0  138          -   10.05376      -     -    0s
H    0     0                      32.1546316   10.05376  68.7%     -    0s
H    0     0                      29.9072299   10.05376  66.4%     -    0s
     0     2   10.05376    0  138   29.90723   10.05376  66.4%     -    0s
H   31    40                      29.9072293   10.08625  66.3%  43.3    0s
H   32    40                      22.6788487   10.08625  55.5%  42.4    0s
H   33    40                      19.4853577   10.08625  48.2%  41.7    0s
H   68    63                      19.4627985   10.08625  48.2%  31.9    0s
H  322   220                      19.4627961   10.08625  48.2%  22.4    0s
H  330   220                      19.4627899   10.08625  48.2%  22.4    0s
H 1171   197                      19.4627874   11.16360  42.6%  33.6    2s
  3880   314     cutoff   22        19.46279   16.20376  16.7%  29.8    5s

Cutting planes:
  Learned: 17
  Clique: 10

Explored 4453 nodes (129544 simplex iterations) in 5.72 seconds (7.15 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 19.4628 19.4854 22.6788 ... 32.1546

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (9.7804e-06) exceeds tolerance
Best objective 1.946278742292e+01, best bound 1.946210998352e+01, gap 0.0035%

User-callback calls 11163, time in user-callback 0.02 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job2.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
19.462787422921444
The root upper bound is: 29.907229888648832, lower bound is: 10.053760772507928. The root gap is: 66.3835%. Runtime: 5.723417043685913.
--------------------------------------------------
    m    n  dataset formulation  ...     end_lb       end_gap  node_count      time
0   3   50  autompg    original  ...   9.048064  0.000000e+00       165.0  0.081412
1   3   50  autompg         opt  ...   9.048020  4.872711e-06        89.0  0.247979
2   3   50  autompg     opt_cut  ...   9.047161  9.973625e-05       567.0  0.452822
3   3   60  autompg    original  ...  10.502622  0.000000e+00      1760.0  0.389810
4   3   60  autompg         opt  ...  10.502622  0.000000e+00      1392.0  0.347356
5   3   60  autompg     opt_cut  ...  10.502617  0.000000e+00      2880.0  0.579361
6   3   70  autompg    original  ...  12.295045  0.000000e+00      4376.0  0.315652
7   3   70  autompg         opt  ...  12.295045  0.000000e+00      1823.0  0.450752
8   3   70  autompg     opt_cut  ...  12.294916  9.946788e-06      1920.0  1.524639
9   3   80  autompg    original  ...  16.615701  0.000000e+00     41269.0  1.899725
10  3   80  autompg         opt  ...  16.615701  0.000000e+00      8072.0  1.420858
11  3   80  autompg     opt_cut  ...  16.615692 -1.848775e-10      4829.0  3.155773
12  3   90  autompg    original  ...  18.849146  0.000000e+00    116639.0  4.925281
13  3   90  autompg         opt  ...  18.849146  0.000000e+00     11994.0  4.632343
14  3   90  autompg     opt_cut  ...  18.849144 -1.810854e-11      7391.0  5.013493
15  3  100  autompg    original  ...  19.462795  0.000000e+00    128209.0  5.740150
16  3  100  autompg         opt  ...  19.462795  0.000000e+00     12569.0  5.100597
17  3  100  autompg     opt_cut  ...  19.462110  3.480691e-05      4453.0  5.723417

[18 rows x 12 columns]
[3, 120, 'autompg']
[0.00230949 0.00333672 0.00562492 1.         1.        ]
The relaxed obj is 0.09396600087610096.
The larges value of x is 2.5710226645332637
Use new Big-M 5.142045329066527.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 240 rows, 243 columns and 480 nonzeros
Model fingerprint: 0xdce4c869
Model has 486 quadratic objective terms
Variable types: 123 continuous, 120 integer (120 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [8e-02, 7e+01]
  QObjective range [7e-02, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 60.0000000
Presolve time: 0.00s
Presolved: 240 rows, 243 columns, 480 nonzeros
Presolved model has 486 quadratic objective terms
Variable types: 123 continuous, 120 integer (120 binary)

Root relaxation: objective 1.060023e+01, 535 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   10.60023    0   84   60.00000   10.60023  82.3%     -    0s
H    0     0                      31.7564281   10.60023  66.6%     -    0s
H    0     0                      29.3785431   10.60023  63.9%     -    0s
H    0     0                      26.7098999   10.60023  60.3%     -    0s
H    0     0                      26.6519534   10.60023  60.2%     -    0s
H    0     0                      26.3819886   10.60023  59.8%     -    0s
     0     0   10.61880    0   84   26.38199   10.61880  59.7%     -    0s
     0     2   10.61880    0   84   26.38199   10.61880  59.7%     -    0s
 77700 47107   26.21275   29   76   26.38199   21.20488  19.6%   7.9    5s
 187318 103160   25.37147   36   60   26.38199   22.37690  15.2%   7.3   10s
 294743 153070   25.83333   42   56   26.38199   22.92118  13.1%   7.0   15s
 402082 198470   24.80585   33   66   26.38199   23.27030  11.8%   6.8   20s
 514387 242652     cutoff   36        26.38199   23.54022  10.8%   6.7   25s
 625729 281952   25.98906   34   67   26.38199   23.75097  10.0%   6.7   30s
 734436 318671   26.16711   31   75   26.38199   23.92210  9.32%   6.6   35s
 847227 352750     cutoff   33        26.38199   24.07537  8.74%   6.5   40s
 956603 382965     cutoff   34        26.38199   24.20177  8.26%   6.5   45s
 1066761 410190   25.53988   30   69   26.38199   24.31673  7.83%   6.5   50s
 1180084 435509   25.66273   31   61   26.38199   24.42288  7.43%   6.4   55s
 1292536 457443     cutoff   42        26.38199   24.51896  7.06%   6.4   60s
 1407220 476809   25.78063   33   65   26.38199   24.60963  6.72%   6.4   65s
 1514762 492106   26.35452   32   62   26.38199   24.68827  6.42%   6.4   70s
 1630879 505019   25.60236   35   64   26.38199   24.76690  6.12%   6.3   75s
 1745862 515676   26.34381   36   66   26.38199   24.84143  5.84%   6.3   80s
 1859009 523199   25.95751   32   69   26.38199   24.91165  5.57%   6.3   85s
 1978112 527970   26.10399   35   58   26.38199   24.98224  5.31%   6.2   90s
 2093251 529820     cutoff   32        26.38199   25.04905  5.05%   6.2   95s
 2209793 528475   26.22714   35   61   26.38199   25.11415  4.81%   6.2  100s
 2322019 524619     cutoff   35        26.38199   25.17641  4.57%   6.2  105s
 2432064 517935   25.56894   30   70   26.38199   25.23699  4.34%   6.2  110s
 2540543 508417     cutoff   32        26.38199   25.29620  4.12%   6.1  115s
 2652255 495378   26.32296   37   57   26.38199   25.35724  3.88%   6.1  120s
 2770666 478071   25.75104   33   59   26.38199   25.42141  3.64%   6.1  125s
 2879578 459135   26.32609   35   66   26.38199   25.48090  3.42%   6.1  130s
 2989898 436699   26.04994   35   61   26.38199   25.54191  3.18%   6.0  135s
 3103223 407954   26.34612   34   69   26.38199   25.60738  2.94%   6.0  140s
 3211718 377316     cutoff   33        26.38199   25.67245  2.69%   6.0  145s
 3326971 341489   26.22802   33   63   26.38199   25.74284  2.42%   6.0  150s
 3439649 303466     cutoff   34        26.38199   25.81419  2.15%   5.9  155s
 3549427 262870   26.19356   32   72   26.38199   25.88754  1.87%   5.9  160s
 3664229 216393     cutoff   38        26.38199   25.97036  1.56%   5.9  165s
 3774064 166869   26.32491   32   70   26.38199   26.05908  1.22%   5.9  170s
 3887823 106903     cutoff   37        26.38199   26.16858  0.81%   5.8  175s
 3989583 37836     cutoff   34        26.38199   26.30077  0.31%   5.8  180s

Explored 4033743 nodes (23148760 simplex iterations) in 182.14 seconds (344.30 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 26.382 29.3785 31.7564 60 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.638198858886e+01, best bound 2.638158321376e+01, gap 0.0015%

User-callback calls 8086622, time in user-callback 9.17 sec
--------------------------------
solve the problem in original formulation
The obj is 26.381988588861418.
The root upper bound is: 26.381988588861418, lower bound is: 10.61879705089547. The root gap is: 59.7498%. Runtime: 182.13898706436157.
[ 25  26  28  30  32  51  54  70  79  84 102 107 114 117]
Number of outliers: 14
--------------------------------
The decomposition time is 0.2579903993755579.
Optimal value: 1.167272039427183
The decomposition time is 0.19417460449039936.
Optimal value: 2.854474248505997
The decomposition time is 0.2612241841852665.
Optimal value: 14.842872010153727
The best pair is: [[1, 2]]
------------------------
The decomposition time is 0.26126953959465027.
Optimal value: 14.842872010153727
10.600246930779065
13.5647992379211
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 840 rows, 483 columns and 2760 nonzeros
Model fingerprint: 0x9b611dc5
Model has 486 quadratic objective terms
Variable types: 123 continuous, 360 integer (360 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+03]
  Objective range  [8e-02, 7e+01]
  QObjective range [7e-02, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [8e-02, 1e+03]
Found heuristic solution: objective 51.4706718
Presolve time: 0.00s
Presolved: 840 rows, 483 columns, 2760 nonzeros
Presolved model has 486 quadratic objective terms
Variable types: 123 continuous, 360 integer (360 binary)

Root relaxation: objective 1.060023e+01, 1250 iterations, 0.02 seconds (0.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   10.60023    0  168   51.47067   10.60023  79.4%     -    0s
H    0     0                      28.0835203   10.60023  62.3%     -    0s
H    0     0                      27.5911582   10.60023  61.6%     -    0s
H    0     0                      26.5881125   10.60023  60.1%     -    0s
     0     0   10.60023    0  174   26.58811   10.60023  60.1%     -    0s
H    0     0                      26.5033166   10.60023  60.0%     -    0s
H    0     0                      26.4488641   10.60023  59.9%     -    0s
     0     2   11.63178    0  174   26.44886   11.63178  56.0%     -    0s
H   36    40                      26.3819886   13.59141  48.5%  23.0    0s
  7702  1960   22.80837   36  138   26.38199   19.13893  27.5%  24.2    5s
 20158  2297 infeasible   40        26.38199   23.34177  11.5%  23.2   10s

Cutting planes:
  Learned: 17
  Clique: 14

Explored 31225 nodes (661567 simplex iterations) in 14.87 seconds (23.69 work units)
Thread count was 8 (of 52 available processors)

Solution count 7: 26.382 26.4489 26.5033 ... 51.4707

Optimal solution found (tolerance 1.00e-04)
Best objective 2.638198858886e+01, best bound 2.638198858886e+01, gap 0.0000%

User-callback calls 68301, time in user-callback 0.08 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 26.381988588861432.
The root upper bound is: 26.448864082159403, lower bound is: 11.631776250852818. The root gap is: 56.0216%. Runtime: 14.87244701385498.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 841 rows, 484 columns and 3003 nonzeros
Model fingerprint: 0xc46661bc
Model has 486 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 124 continuous, 360 integer (360 binary)
Coefficient statistics:
  Matrix range     [4e-04, 1e+03]
  QMatrix range    [1e-08, 1e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [8e-02, 7e+01]
  QObjective range [7e-02, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [8e-02, 1e+03]
Warning: diagonal adjustment of 1.7e-08 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 841 rows, 484 columns, 3003 nonzeros
Presolved model has 486 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 124 continuous, 360 integer (360 binary)

Root relaxation: objective 1.356476e+01, 1361 iterations, 0.02 seconds (0.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   13.56476    0  170          -   13.56476      -     -    0s
     0     0   13.56481    0  173          -   13.56481      -     -    0s
     0     0   13.56481    0  174          -   13.56481      -     -    0s
     0     0   13.56481    0  174          -   13.56481      -     -    0s
H    0     0                    277460.99440   13.56483   100%     -    0s
     0     2   13.56483    0  174 277460.994   13.56483   100%     -    0s
H   33    40                    133013.57012   13.57180   100%   100    0s
H   64    79                    50822.473803   13.67376   100%  79.8    0s
H  119   139                    38584.622071   13.77296   100%  54.2    0s
H  170   197                    37861.378440   13.77296   100%  41.1    0s
H  404   426                    37793.648539   13.77296   100%  25.2    0s
H  422   426                    37785.520862   13.77296   100%  25.9    0s
H  939   765                      71.4575742   14.39232  79.9%  24.8    1s
H  973   759                      45.7584772   14.39232  68.5%  27.6    1s
H 1073   750                      45.7408328   14.39232  68.5%  28.9    2s
H 1075   714                      26.6670949   14.39232  46.0%  29.0    2s
H 1152   644                      26.6670873   14.39232  46.0%  31.0    2s
H 1862   665                      26.3819916   14.39232  45.4%  29.1    2s
H 2102   601                      26.3819888   14.42711  45.3%  28.7    3s
H 2106   571                      26.3819827   14.42711  45.3%  28.7    3s
H 2332   562                      26.3819797   14.49984  45.0%  28.3    3s
  4057  1023   25.97412   36  183   26.38198   15.03963  43.0%  27.1    5s
  9637  2424   17.41751   33  146   26.38198   16.19282  38.6%  26.6   10s
 16059  3265   18.43428   35  142   26.38198   17.82747  32.4%  26.3   15s
 23283  3462   19.98631   33   44   26.38198   19.42346  26.4%  26.2   20s
 32383  3175 infeasible   48        26.38198   21.14591  19.8%  24.9   25s
H32461  3175                      26.3819796   21.20763  19.6%  24.9   25s
H38168  2821                      26.3819792   22.30345  15.5%  23.9   29s
 38244  2724   24.14238   29  104   26.38198   22.33024  15.4%  23.9   30s
 46709  1145 infeasible   45        26.38198   24.36915  7.63%  22.5   35s

Cutting planes:
  Learned: 13
  Clique: 16
  MIR: 1

Explored 49025 nodes (1088480 simplex iterations) in 36.23 seconds (57.37 work units)
Thread count was 8 (of 52 available processors)

Solution count 10: 26.382 26.6671 45.7408 ... 277461

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (9.5844e-06) exceeds tolerance
Best objective 2.638197915267e+01, best bound 2.638123645268e+01, gap 0.0028%

User-callback calls 112725, time in user-callback 0.14 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job2.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
26.381979152672336
The root upper bound is: 277460.9943969716, lower bound is: 13.564831983932123. The root gap is: 99.9951%. Runtime: 36.23499608039856.
--------------------------------------------------
    m    n  dataset  ...       end_gap  node_count        time
0   3   50  autompg  ...  0.000000e+00       165.0    0.081412
1   3   50  autompg  ...  4.872711e-06        89.0    0.247979
2   3   50  autompg  ...  9.973625e-05       567.0    0.452822
3   3   60  autompg  ...  0.000000e+00      1760.0    0.389810
4   3   60  autompg  ...  0.000000e+00      1392.0    0.347356
5   3   60  autompg  ...  0.000000e+00      2880.0    0.579361
6   3   70  autompg  ...  0.000000e+00      4376.0    0.315652
7   3   70  autompg  ...  0.000000e+00      1823.0    0.450752
8   3   70  autompg  ...  9.946788e-06      1920.0    1.524639
9   3   80  autompg  ...  0.000000e+00     41269.0    1.899725
10  3   80  autompg  ...  0.000000e+00      8072.0    1.420858
11  3   80  autompg  ... -1.848775e-10      4829.0    3.155773
12  3   90  autompg  ...  0.000000e+00    116639.0    4.925281
13  3   90  autompg  ...  0.000000e+00     11994.0    4.632343
14  3   90  autompg  ... -1.810854e-11      7391.0    5.013493
15  3  100  autompg  ...  0.000000e+00    128209.0    5.740150
16  3  100  autompg  ...  0.000000e+00     12569.0    5.100597
17  3  100  autompg  ...  3.480691e-05      4453.0    5.723417
18  3  120  autompg  ...  1.536560e-05   4033743.0  182.138987
19  3  120  autompg  ...  0.000000e+00     31225.0   14.872447
20  3  120  autompg  ...  2.815179e-05     49025.0   36.234996

[21 rows x 12 columns]
[3, 150, 'autompg']
[0.00173866 0.00296005 0.00449461 1.         1.        ]
The relaxed obj is 0.11780138822503261.
The larges value of x is 2.368682823920138
Use new Big-M 4.737365647840276.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 300 rows, 303 columns and 600 nonzeros
Model fingerprint: 0xe9ab2dcc
Model has 606 quadratic objective terms
Variable types: 153 continuous, 150 integer (150 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [2e-02, 8e+01]
  QObjective range [7e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 75.0000000
Presolve time: 0.00s
Presolved: 300 rows, 303 columns, 600 nonzeros
Presolved model has 606 quadratic objective terms
Variable types: 153 continuous, 150 integer (150 binary)

Root relaxation: objective 1.587536e+01, 648 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   15.87536    0  109   75.00000   15.87536  78.8%     -    0s
H    0     0                      39.6762003   15.87536  60.0%     -    0s
H    0     0                      39.5886266   15.87536  59.9%     -    0s
H    0     0                      38.7425034   15.87536  59.0%     -    0s
H    0     0                      38.5543916   15.87536  58.8%     -    0s
H    0     0                      38.2604401   15.87536  58.5%     -    0s
     0     0   15.92968    0  109   38.26044   15.92968  58.4%     -    0s
H    0     0                      38.0538048   15.92968  58.1%     -    0s
     0     2   15.92968    0  109   38.05380   15.92968  58.1%     -    0s
 65166 52305   36.57405   51   79   38.05380   25.37387  33.3%   8.4    5s
 145403 116003   30.27456   32   91   38.05380   26.48900  30.4%   8.1   10s
 230743 183051   33.35189   37   84   38.05380   27.09648  28.8%   8.0   15s
 310841 244342   36.70559   46   85   38.05380   27.50593  27.7%   7.9   20s
 393425 307203   33.50617   37   95   38.05380   27.78464  27.0%   7.8   25s
 476908 370955   37.89150   40   90   38.05380   28.04095  26.3%   7.7   30s
 563526 438260   29.72645   30   97   38.05380   28.22837  25.8%   7.7   35s
 644849 499935   37.70219   51   78   38.05380   28.39154  25.4%   7.6   40s
 729833 565134   34.57331   40   94   38.05380   28.53739  25.0%   7.6   45s
 810085 626717   29.75541   31   89   38.05380   28.65491  24.7%   7.6   50s
 892814 689659   33.94413   39   85   38.05380   28.76771  24.4%   7.6   55s
 978294 753924   36.48919   48   75   38.05380   28.87185  24.1%   7.6   60s
 1059895 815100   31.05819   31   99   38.05380   28.96353  23.9%   7.5   65s
 1148802 881408   35.54429   45   87   38.05380   29.05151  23.7%   7.5   70s
 1231838 943211   37.66285   51   80   38.05380   29.13018  23.5%   7.5   75s
 1318661 1007912   36.22910   43   82   38.05380   29.20710  23.2%   7.5   80s
 1402806 1070815   33.60449   36   93   38.05380   29.27910  23.1%   7.5   85s
 1491591 1137034   34.41110   40   88   38.05380   29.34808  22.9%   7.4   90s
 1574149 1198502   34.93459   40   93   38.05380   29.40985  22.7%   7.4   95s
 1663478 1263586   36.66719   52   76   38.05380   29.47275  22.5%   7.4  100s
 1748689 1325441   36.84084   41   88   38.05380   29.53254  22.4%   7.4  105s
 1842080 1393451   32.17524   36   96   38.05380   29.59502  22.2%   7.4  110s
 1921028 1451899   37.83057   56   66   38.05380   29.64318  22.1%   7.4  115s
 2006196 1514771   32.24282   36   89   38.05380   29.69039  22.0%   7.4  120s
 2090582 1576734   30.62242   33   91   38.05380   29.73400  21.9%   7.4  125s
 2180544 1642106   31.51441   35   91   38.05380   29.78256  21.7%   7.4  130s
 2269792 1707237   36.58067   47   83   38.05380   29.82689  21.6%   7.3  135s
 2354109 1768235   37.45220   52   76   38.05380   29.86912  21.5%   7.3  140s
 2439101 1830433   37.99894   48   85   38.05380   29.90662  21.4%   7.3  145s
 2520009 1889250   37.69656   49   79   38.05380   29.94172  21.3%   7.3  150s
 2609436 1955174   33.36193   36   89   38.05380   29.97964  21.2%   7.3  155s
 2695006 2017582   31.12702   35   91   38.05380   30.01405  21.1%   7.3  160s
 2783853 2081596   30.98819   31  100   38.05380   30.05017  21.0%   7.3  165s
 2862398 2138623   32.88902   36   92   38.05380   30.08048  21.0%   7.3  170s
 2951937 2203606   36.81347   55   67   38.05380   30.11398  20.9%   7.3  175s
 3032548 2261718   34.68963   41   87   38.05380   30.14392  20.8%   7.3  180s
 3122215 2326590   37.54378   50   79   38.05380   30.17737  20.7%   7.3  185s
 3203152 2385264   37.00426   56   67   38.05380   30.20539  20.6%   7.3  190s
 3293721 2449452   36.02713   41   95   38.05380   30.23653  20.5%   7.3  195s
 3376533 2509317   32.79890   36   87   38.05380   30.26500  20.5%   7.3  200s
 3464087 2571530   35.53750   40   90   38.05380   30.29385  20.4%   7.3  205s
 3550948 2634016   32.39067   36   85   38.05380   30.32161  20.3%   7.3  210s
 3635843 2694888   32.92723   34   97   38.05380   30.34759  20.3%   7.3  215s
 3717765 2753344   37.54162   54   70   38.05380   30.37235  20.2%   7.2  220s
 3797565 2810292   36.86658   40   89   38.05380   30.39550  20.1%   7.2  225s
 3883190 2871570   35.11454   46   84   38.05380   30.41916  20.1%   7.2  230s
 3965463 2930355   35.16516   44   84   38.05380   30.44226  20.0%   7.2  235s
 4055389 2994468   35.59189   43   80   38.05380   30.46635  19.9%   7.2  240s
 4143095 3057245   32.63325   36   88   38.05380   30.49009  19.9%   7.2  245s
 4226312 3116514   35.58015   45   84   38.05380   30.51205  19.8%   7.2  250s
 4311356 3176994   34.65673   40   91   38.05380   30.53350  19.8%   7.2  255s
 4395764 3236899   33.41948   35   94   38.05380   30.55541  19.7%   7.2  260s
 4487231 3302332   34.09794   42   87   38.05380   30.57851  19.6%   7.2  265s
 4570198 3361769   32.72479   35   99   38.05380   30.59842  19.6%   7.2  270s
 4654249 3421427   31.14676   35   91   38.05380   30.61828  19.5%   7.2  275s
 4739087 3481057     cutoff   59        38.05380   30.63781  19.5%   7.2  280s
 4823274 3541433   36.78934   50   76   38.05380   30.65691  19.4%   7.2  285s
 4909077 3601914   33.86975   39   86   38.05380   30.67693  19.4%   7.2  290s
 4992568 3660386   35.79719   43   81   38.05380   30.69593  19.3%   7.2  295s
 5082336 3723060   35.07290   44   85   38.05380   30.71638  19.3%   7.2  300s

Explored 5082344 nodes (36530700 simplex iterations) in 300.00 seconds (691.44 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 38.0538 38.2604 39.5886 75 

Time limit reached
Best objective 3.805380479778e+01, best bound 3.071638420239e+01, gap 19.2817%

User-callback calls 10196532, time in user-callback 11.95 sec
--------------------------------
solve the problem in original formulation
The obj is 38.05380479777608.
The root upper bound is: 38.05380479777608, lower bound is: 15.92968179163551. The root gap is: 58.1391%. Runtime: 300.0293622016907.
[ 25  26  28  30  54  70  84 102 107 114 130 131 141 144 145 146]
Number of outliers: 16
--------------------------------
The decomposition time is 0.34343808330595493.
Optimal value: 0.9891789529039753
The decomposition time is 0.26247155480086803.
Optimal value: 25.931554449842636
The decomposition time is 0.37477103248238564.
Optimal value: 15.76524632728573
The best pair is: [[0, 2]]
------------------------
The decomposition time is 0.2595178745687008.
Optimal value: 25.931554449842636
[3, 200, 'autompg']
[0.00138762 0.00204665 0.00331983 1.         1.        ]
The relaxed obj is 0.15733341651267096.
The larges value of x is 2.3405596828329456
Use new Big-M 4.681119365665891.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 400 rows, 403 columns and 800 nonzeros
Model fingerprint: 0x5625a5d2
Model has 806 quadratic objective terms
Variable types: 203 continuous, 200 integer (200 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [4e-02, 9e+01]
  QObjective range [3e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 100.0000000
Presolve time: 0.00s
Presolved: 400 rows, 403 columns, 800 nonzeros
Presolved model has 806 quadratic objective terms
Variable types: 203 continuous, 200 integer (200 binary)

Root relaxation: objective 2.403982e+01, 909 iterations, 0.02 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   24.03982    0  162  100.00000   24.03982  76.0%     -    0s
H    0     0                      62.2761794   24.03982  61.4%     -    0s
H    0     0                      61.8680766   24.03982  61.1%     -    0s
H    0     0                      59.1556519   24.03982  59.4%     -    0s
     0     0   24.03982    0  162   59.15565   24.03982  59.4%     -    0s
H    0     0                      58.5455276   24.03982  58.9%     -    0s
H    0     0                      58.5279423   24.03982  58.9%     -    0s
H    0     2                      58.5204506   24.03982  58.9%     -    0s
     0     2   24.03982    0  162   58.52045   24.03982  58.9%     -    0s
 50966 45008   48.56917   48  128   58.52045   32.22667  44.9%   7.7    5s
 108809 96357   48.27350   45  124   58.52045   33.30306  43.1%   7.6   10s
 172546 153461   49.33420   51  121   58.52045   33.91783  42.0%   7.5   15s
 238047 211389   47.56782   45  129   58.52045   34.41446  41.2%   7.4   20s
 296914 263693   38.25258   27  153   58.52045   34.74145  40.6%   7.3   25s
 362697 321518   43.52137   36  138   58.52045   35.04512  40.1%   7.3   30s
 420806 373483   45.88419   38  134   58.52045   35.25301  39.8%   7.3   35s
 479907 426208   39.91881   32  143   58.52045   35.39015  39.5%   7.3   40s
 547268 485863   41.87858   32  143   58.52045   35.58452  39.2%   7.2   45s
 609770 540537   42.11482   33  137   58.52045   35.74356  38.9%   7.2   50s
 671913 596444   45.21188   38  133   58.52045   35.86233  38.7%   7.2   55s
 739633 655444   41.49785   32  136   58.52045   36.00137  38.5%   7.2   60s
 800521 709120   50.76127   49  123   58.52045   36.10481  38.3%   7.2   65s
 866002 766960   36.24104   25  147   58.52045   36.20572  38.1%   7.1   70s
 934408 826894   53.70296   60  112   58.52045   36.30794  38.0%   7.1   75s
 991985 877975   55.84722   64  102   58.52045   36.37897  37.8%   7.1   80s
 1059025 936472   38.71067   28  147   58.52045   36.46416  37.7%   7.1   85s
 1119231 989682   51.30245   52  127   58.52045   36.53421  37.6%   7.1   90s
 1183986 1047333   39.08073   28  149   58.52045   36.60483  37.4%   7.1   95s
 1254556 1109230   45.83073   38  135   58.52045   36.68736  37.3%   7.1  100s
 1316420 1163220   42.98948   33  140   58.52045   36.75534  37.2%   7.1  105s
 1383684 1222681   45.50880   42  129   58.52045   36.82106  37.1%   7.1  110s
 1454215 1284554   45.22068   37  136   58.52045   36.88973  37.0%   7.0  115s
 1518060 1340794   48.13220   45  129   58.52045   36.94633  36.9%   7.0  120s
 1585169 1399470   51.01785   55  117   58.52045   36.99744  36.8%   7.0  125s
 1650169 1457523   50.97496   51  123   58.52045   37.04423  36.7%   7.0  130s
 1708125 1508629   49.92639   48  124   58.52045   37.08765  36.6%   7.0  135s
 1774797 1567966   57.99468   66  105   58.52045   37.13444  36.5%   7.0  140s
 1840560 1625935   54.62559   58  109   58.52045   37.18082  36.5%   7.0  145s
 1903879 1681525   47.66367   42  136   58.52045   37.22501  36.4%   7.0  150s
 1971899 1741259   45.10263   39  128   58.52045   37.26541  36.3%   7.0  155s
 2032274 1794410   50.56186   52  120   58.52045   37.30551  36.3%   7.0  160s
 2094622 1849698   53.68450   61  115   58.52045   37.33890  36.2%   7.0  165s
 2161053 1907962   58.47846   74   97   58.52045   37.37685  36.1%   7.0  170s
 2221793 1961273   40.85587   30  140   58.52045   37.41133  36.1%   7.0  175s
 2286231 2018844   52.91577   53  116   58.52045   37.44493  36.0%   7.0  180s
 2354580 2077853   54.73529   63  110   58.52045   37.48308  35.9%   7.0  185s
 2417620 2133128   42.96279   32  139   58.52045   37.51646  35.9%   7.0  190s
 2481831 2189322   45.97468   38  134   58.52045   37.54970  35.8%   7.0  195s
 2547571 2247321   48.75392   46  128   58.52045   37.58238  35.8%   7.0  200s
 2607310 2299930   37.74610   28  143   58.52045   37.61034  35.7%   7.0  205s
 2673851 2358231   56.15151   65  100   58.52045   37.64165  35.7%   6.9  210s
 2739772 2416717   48.56710   44  124   58.52045   37.67091  35.6%   6.9  215s
 2802532 2471533   42.69695   35  138   58.52045   37.69880  35.6%   6.9  220s
 2869143 2529900   46.95477   44  128   58.52045   37.72780  35.5%   6.9  225s
 2925780 2579837   52.76338   46  124   58.52045   37.74917  35.5%   6.9  230s
 2993830 2638494   40.50803   33  140   58.52045   37.77816  35.4%   6.9  235s
 3059212 2696441   51.68938   46  126   58.52045   37.80426  35.4%   6.9  240s
 3117658 2747840   37.83545   29  138   58.52045   37.82669  35.4%   6.9  245s
 3183698 2806177   44.90280   39  139   58.52045   37.85103  35.3%   6.9  250s
 3250503 2865310   43.70339   37  136   58.52045   37.87612  35.3%   6.9  255s
 3310380 2917372   47.64058   48  124   58.52045   37.89860  35.2%   6.9  260s
 3377763 2976244   40.75004   31  138   58.52045   37.92464  35.2%   6.9  265s
 3442893 3033057   55.35343   57  116   58.52045   37.94860  35.2%   6.9  270s
 3506870 3089223   42.00582   35  139   58.52045   37.97116  35.1%   6.9  275s
 3571406 3146273   40.92492   32  143   58.52045   37.99261  35.1%   6.9  280s
 3631118 3199119   57.03988   71  102   58.52045   38.01219  35.0%   6.9  285s
 3697809 3257310   57.59749   57  110   58.52045   38.03508  35.0%   6.9  290s
 3763495 3315085   51.30975   48  124   58.52045   38.05542  35.0%   6.9  295s
 3820525 3365790   49.72208   42  129   58.52045   38.07060  34.9%   6.9  300s

Explored 3820941 nodes (26373772 simplex iterations) in 300.00 seconds (852.63 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 58.5205 58.5279 59.1557 ... 100

Time limit reached
Best objective 5.852045061447e+01, best bound 3.807059705241e+01, gap 34.9448%

User-callback calls 7672286, time in user-callback 9.00 sec
--------------------------------
solve the problem in original formulation
The obj is 58.5204506144671.
The root upper bound is: 58.52794227008117, lower bound is: 24.03981807332005. The root gap is: 58.9259%. Runtime: 300.00494289398193.
[ 28  30  54  70  84 102 107 114 116 127 131 139 140 144 145 151 167 181 182 185 186 197 198]
Number of outliers: 23
--------------------------------
The decomposition time is 0.6701923944056034.
Optimal value: 1.016464642868366
The decomposition time is 0.6684035081416368.
Optimal value: 29.257301952244084
The decomposition time is 0.7245340198278427.
Optimal value: 18.77578334784359
The best pair is: [[0, 2]]
------------------------
The decomposition time is 0.6630686204880476.
Optimal value: 29.257301952244084
24.039823852340703
29.678213427650306
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 1400 rows, 803 columns and 4600 nonzeros
Model fingerprint: 0xaa2b60ca
Model has 806 quadratic objective terms
Variable types: 203 continuous, 600 integer (600 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+03]
  Objective range  [4e-02, 9e+01]
  QObjective range [3e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [9e-03, 1e+03]
Found heuristic solution: objective 95.2979803
Presolve time: 0.01s
Presolved: 1400 rows, 803 columns, 4600 nonzeros
Presolved model has 806 quadratic objective terms
Variable types: 203 continuous, 600 integer (600 binary)

Root relaxation: objective 2.403982e+01, 2285 iterations, 0.06 seconds (0.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   24.03982    0  324   95.29798   24.03982  74.8%     -    0s
H    0     0                      58.5281250   24.03982  58.9%     -    0s
     0     0   24.42770    0  331   58.52812   24.42770  58.3%     -    0s
H    0     0                      58.5204506   24.42770  58.3%     -    0s
     0     2   25.33256    0  331   58.52045   25.33256  56.7%     -    0s
  2379  1010 infeasible   37        58.52045   29.80946  49.1%  29.0    5s
  5862  1720   51.66284   33  212   58.52045   31.21591  46.7%  35.4   10s
  9165  2873   35.85147   30  290   58.52045   32.70680  44.1%  37.6   15s
 14711  4402 infeasible   37        58.52045   34.55283  41.0%  38.4   20s
 20366  6053     cutoff   29        58.52045   36.30344  38.0%  39.0   25s
 27432  7381   40.55686   32  146   58.52045   37.85680  35.3%  38.1   30s
 29798  7595   52.19943   48   30   58.52045   38.25097  34.6%  37.9   35s
 31252  7500   45.37492   40  338   58.52045   38.25097  34.6%  38.5   40s
 35010  7119   38.25097   43  310   58.52045   38.25097  34.6%  39.0   45s
 42087  6535   51.96205   46  172   58.52045   39.46171  32.6%  38.7   50s
 52636  5118 infeasible   54        58.52045   43.77458  25.2%  35.9   55s
 60073  7766   50.10326   62  294   58.52045   45.80369  21.7%  34.4   60s
 73449  8157 infeasible   57        58.52045   48.09560  17.8%  31.8   65s
 83209  9011     cutoff   69        58.52045   49.15418  16.0%  30.5   70s
 95460  9595 infeasible   52        58.52045   50.69696  13.4%  29.1   75s
 104708  9622     cutoff   78        58.52045   52.07224  11.0%  28.2   80s
 114871  9149     cutoff   81        58.52045   53.30338  8.91%  27.3   85s
 122592  8157 infeasible   54        58.52045   54.10990  7.54%  26.6   90s
 131166  6773   55.12529   85  235   58.52045   55.01974  5.98%  26.0   95s
 140432  3990 infeasible   55        58.52045   56.08323  4.16%  25.3  100s

Cutting planes:
  Learned: 13
  Gomory: 1
  Clique: 2

Explored 148407 nodes (3665868 simplex iterations) in 105.00 seconds (177.06 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 58.5205 58.5281 95.298 

Optimal solution found (tolerance 1.00e-04)
Best objective 5.852045061447e+01, best bound 5.852045061447e+01, gap 0.0000%

User-callback calls 334119, time in user-callback 0.42 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 58.52045061446708.
The root upper bound is: 58.52045061446708, lower bound is: 25.332557688601014. The root gap is: 56.7116%. Runtime: 105.04194116592407.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 1401 rows, 804 columns and 5003 nonzeros
Model fingerprint: 0x1ac0ccdd
Model has 806 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 204 continuous, 600 integer (600 binary)
Coefficient statistics:
  Matrix range     [7e-04, 1e+03]
  QMatrix range    [1e-08, 1e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [4e-02, 9e+01]
  QObjective range [1e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [9e-03, 1e+03]
Warning: diagonal adjustment of 1.9e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.01s
Presolved: 1401 rows, 804 columns, 5003 nonzeros
Presolved model has 806 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 204 continuous, 600 integer (600 binary)

Root relaxation: objective 2.967820e+01, 3279 iterations, 0.09 seconds (0.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   29.67820    0  324          -   29.67820      -     -    0s
     0     0   29.67820    0  324          -   29.67820      -     -    0s
H    0     0                    246099.01664   29.67820   100%     -    0s
     0     2   29.67820    0  324 246099.017   29.67820   100%     -    0s
H   31    38                    218885.73133   29.67820   100%   163    1s
H   32    38                     800.1780863   29.67820  96.3%   158    1s
H  119   107                     772.7044621   29.67823  96.2%  70.3    2s
H  876   296                     101.9168221   29.67865  70.9%  29.3    2s
H  880   266                     100.3633144   29.67865  70.4%  29.2    3s
H  882   254                      98.2332265   29.68092  69.8%  29.1    3s
H  915   271                      98.2332263   29.68092  69.8%  34.5    3s
H  916   259                      94.6326643   29.68092  68.6%  34.5    3s
H  949   265                      78.0399957   29.68092  62.0%  34.5    3s
H  982   269                      70.9501167   29.68092  58.2%  34.9    4s
  1012   254     cutoff   24        70.95012   29.68092  58.2%  36.0    5s
H 1013   244                      66.4314553   29.68092  55.3%  36.0    5s
H 1016   233                      64.1873819   29.68092  53.8%  36.4    5s
H 1052   223                      64.1873809   29.68092  53.8%  40.9    5s
H 1053   213                      64.0971677   29.68092  53.7%  40.9    5s
H 1056   204                      60.7680526   29.68092  51.2%  40.8    5s
H 1094   197                      60.5802886   29.68092  51.0%  41.1    5s
H 1097   188                      60.3799082   29.68092  50.8%  41.2    5s
H 1103   179                      60.2970432   29.68092  50.8%  41.2    5s
H 1122   171                      60.2970347   29.68092  50.8%  41.9    6s
H 1123   164                      60.2935590   29.68092  50.8%  41.9    6s
H 1128   156                      60.2935506   29.68092  50.8%  42.1    6s
H 1400   175                      59.5746194   29.68092  50.2%  45.1    7s
H 1407   175                      58.7017599   29.68092  49.4%  45.9    7s
H 1590   222                      58.6997767   29.68092  49.4%  49.5    7s
H 1607   220                      58.5204611   29.68092  49.3%  49.9    8s
H 1698   263                      58.5204506   29.68144  49.3%  54.1    8s
  2107   481     cutoff   26        58.52045   30.05504  48.6%  51.6   10s
  4968   982     cutoff   28        58.52045   31.47575  46.2%  46.0   15s
H 6854  1377                      58.5204436   33.40871  42.9%  42.9   19s
  7148  1409   58.24806   42  254   58.52044   33.92506  42.0%  42.5   20s
H 8287  1620                      58.5204432   34.56497  40.9%  41.1   22s
  9638  1876 infeasible   33        58.52044   35.33518  39.6%  39.2   25s
 13065  2547 infeasible   48        58.52044   36.93215  36.9%  36.3   30s
 17535  3649   42.54603   48  285   58.52044   38.73202  33.8%  33.8   35s
 22103  4188   56.12297   41   50   58.52044   40.42458  30.9%  31.6   40s
 25921  4565   45.26525   62   76   58.52044   41.85264  28.5%  30.3   45s
 33132  5305     cutoff   60        58.52044   44.40906  24.1%  28.0   51s
 36925  6019     cutoff   49        58.52044   45.41040  22.4%  27.1   55s
 43756  6550   47.57847   27  316   58.52044   47.16124  19.4%  25.5   60s
 50617  6700   57.98452   41  327   58.52044   48.86756  16.5%  24.1   65s
 55569  6787   56.26144   44  106   58.52044   50.10346  14.4%  23.2   70s
 62302  6194     cutoff   24        58.52044   51.90047  11.3%  22.2   75s
 69431  4833   57.90648   55   10   58.52044   53.61046  8.39%  21.2   80s
 76020  3170     cutoff   63        58.52044   55.22252  5.64%  20.4   85s
 81430   563     cutoff   75        58.52044   56.93790  2.70%  19.8   90s

Cutting planes:
  Learned: 27
  Clique: 1

Explored 82905 nodes (1627904 simplex iterations) in 90.75 seconds (143.10 work units)
Thread count was 8 (of 52 available processors)

Solution count 10: 58.5204 58.6998 59.5746 ... 64.1874

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (7.4694e-06) exceeds tolerance
Best objective 5.852044316653e+01, best bound 5.852044316653e+01, gap 0.0000%

User-callback calls 192550, time in user-callback 0.25 sec
--------------------------------------------------
Solve the problem in the proposed formulation with cut
58.52044316653363
The root upper bound is: 246099.01664328898, lower bound is: 29.67820242135173. The root gap is: 99.9879%. Runtime: 90.74786305427551.
--------------------------------------------------
    m    n  dataset  ...       end_gap  node_count        time
0   3   50  autompg  ...  0.000000e+00       165.0    0.081412
1   3   50  autompg  ...  4.872711e-06        89.0    0.247979
2   3   50  autompg  ...  9.973625e-05       567.0    0.452822
3   3   60  autompg  ...  0.000000e+00      1760.0    0.389810
4   3   60  autompg  ...  0.000000e+00      1392.0    0.347356
5   3   60  autompg  ...  0.000000e+00      2880.0    0.579361
6   3   70  autompg  ...  0.000000e+00      4376.0    0.315652
7   3   70  autompg  ...  0.000000e+00      1823.0    0.450752
8   3   70  autompg  ...  9.946788e-06      1920.0    1.524639
9   3   80  autompg  ...  0.000000e+00     41269.0    1.899725
10  3   80  autompg  ...  0.000000e+00      8072.0    1.420858
11  3   80  autompg  ... -1.848775e-10      4829.0    3.155773
12  3   90  autompg  ...  0.000000e+00    116639.0    4.925281
13  3   90  autompg  ...  0.000000e+00     11994.0    4.632343
14  3   90  autompg  ... -1.810854e-11      7391.0    5.013493
15  3  100  autompg  ...  0.000000e+00    128209.0    5.740150
16  3  100  autompg  ...  0.000000e+00     12569.0    5.100597
17  3  100  autompg  ...  3.480691e-05      4453.0    5.723417
18  3  120  autompg  ...  1.536560e-05   4033743.0  182.138987
19  3  120  autompg  ...  0.000000e+00     31225.0   14.872447
20  3  120  autompg  ...  2.815179e-05     49025.0   36.234996
21  3  150  autompg  ...  1.928170e-01   5082344.0  300.029362
22  3  200  autompg  ...  3.494480e-01   3820941.0  300.004943
23  3  200  autompg  ...  0.000000e+00    148407.0  105.041941
24  3  200  autompg  ...  0.000000e+00     82905.0   90.747863

[25 rows x 12 columns]
