[3, 50, 'diabetes']
[0.00443629 0.01161517 0.01352846 1.         1.        ]
Set parameter TokenServer to value "questlicense2.quest.northwestern.edu"
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_job4.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
The relaxed obj is 0.03943368550742932.
The larges value of x is 2.560657482858907
Use new Big-M 5.121314965717814.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 100 rows, 103 columns and 200 nonzeros
Model fingerprint: 0x622d8e6f
Model has 206 quadratic objective terms
Variable types: 53 continuous, 50 integer (50 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [3e-03, 3e+01]
  QObjective range [4e-02, 5e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 25.0000000
Presolve time: 0.00s
Presolved: 100 rows, 103 columns, 200 nonzeros
Presolved model has 206 quadratic objective terms
Variable types: 53 continuous, 50 integer (50 binary)

Root relaxation: objective 5.744196e+00, 196 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    5.74420    0   43   25.00000    5.74420  77.0%     -    0s
H    0     0                      15.1368350    5.74420  62.1%     -    0s
H    0     0                      14.6627942    5.74420  60.8%     -    0s
H    0     0                      14.4205780    5.74420  60.2%     -    0s
H    0     0                      14.1358695    5.74420  59.4%     -    0s
     0     0    6.06649    0   43   14.13587    6.06649  57.1%     -    0s
H    0     0                      13.9389789    6.06649  56.5%     -    0s
     0     2    6.06649    0   43   13.93898    6.06649  56.5%     -    0s

Explored 23088 nodes (107104 simplex iterations) in 0.76 seconds (0.59 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 13.939 14.1359 14.4206 ... 25

Optimal solution found (tolerance 1.00e-04)
Best objective 1.393897892416e+01, best bound 1.393897892416e+01, gap 0.0000%

User-callback calls 46669, time in user-callback 0.06 sec
--------------------------------
solve the problem in original formulation
The obj is 13.938978924157016.
The root upper bound is: 13.938978924157016, lower bound is: 6.06648750728438. The root gap is: 56.4783%. Runtime: 0.7591531276702881.
[22 27 29 30]
Number of outliers: 4
--------------------------------
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 350 rows, 203 columns and 1150 nonzeros
Model fingerprint: 0x0c6a3a4e
Model has 206 quadratic objective terms
Variable types: 53 continuous, 150 integer (150 binary)
Coefficient statistics:
  Matrix range     [2e-02, 1e+03]
  Objective range  [3e-03, 3e+01]
  QObjective range [4e-02, 5e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-02, 1e+03]
Found heuristic solution: objective 20.1430775
Presolve time: 0.00s
Presolved: 350 rows, 203 columns, 1150 nonzeros
Presolved model has 206 quadratic objective terms
Variable types: 53 continuous, 150 integer (150 binary)

Root relaxation: objective 5.744196e+00, 360 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    5.74420    0   86   20.14308    5.74420  71.5%     -    0s
H    0     0                      14.4353819    5.74420  60.2%     -    0s
     0     0    5.74420    0   86   14.43538    5.74420  60.2%     -    0s
H    0     0                      14.1361762    5.74420  59.4%     -    0s
H    0     0                      13.9389789    5.74420  58.8%     -    0s
     0     2    5.74420    0   86   13.93898    5.74420  58.8%     -    0s

Explored 12315 nodes (117401 simplex iterations) in 1.70 seconds (2.05 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 13.939 14.1362 14.4354 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.393897892416e+01, best bound 1.393897892416e+01, gap 0.0000%

User-callback calls 25372, time in user-callback 0.03 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_job4.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 13.93897892415702.
The root upper bound is: 13.93897892415702, lower bound is: 5.744195773809704. The root gap is: 58.7904%. Runtime: 1.7031569480895996.
--------------------------------------------------
   m   n   dataset formulation  ...     end_lb  end_gap  node_count      time
0  3  50  diabetes    original  ...  13.938979      0.0     23088.0  0.759153
1  3  50  diabetes         opt  ...  13.938979      0.0     12315.0  1.703157

[2 rows x 12 columns]
[3, 60, 'diabetes']
[0.00379901 0.00889421 0.01179531 1.         1.        ]
The relaxed obj is 0.047410967046346286.
The larges value of x is 2.64186931584802
Use new Big-M 5.28373863169604.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 120 rows, 123 columns and 240 nonzeros
Model fingerprint: 0xc2fd064e
Model has 246 quadratic objective terms
Variable types: 63 continuous, 60 integer (60 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [2e-02, 3e+01]
  QObjective range [2e-02, 6e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 30.0000000
Presolve time: 0.00s
Presolved: 120 rows, 123 columns, 240 nonzeros
Presolved model has 246 quadratic objective terms
Variable types: 63 continuous, 60 integer (60 binary)

Root relaxation: objective 7.145115e+00, 218 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    7.14511    0   53   30.00000    7.14511  76.2%     -    0s
H    0     0                      20.8049308    7.14511  65.7%     -    0s
H    0     0                      19.0162907    7.14511  62.4%     -    0s
H    0     0                      18.8940836    7.14511  62.2%     -    0s
     0     0    7.75457    0   53   18.89408    7.75457  59.0%     -    0s
H    0     0                      18.7990072    7.75457  58.8%     -    0s
     0     2    7.75457    0   53   18.79901    7.75457  58.8%     -    0s
 193690 69212   18.65635   38   26   18.79901   16.98599  9.64%   4.6    5s
 396861 69697   17.86852   31   36   18.79901   17.86444  4.97%   4.4   10s

Explored 578529 nodes (2437663 simplex iterations) in 14.74 seconds (16.62 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 18.799 20.8049 30 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.879900717745e+01, best bound 1.879841414111e+01, gap 0.0032%

User-callback calls 1158887, time in user-callback 1.47 sec
--------------------------------
solve the problem in original formulation
The obj is 18.7990071774505.
The root upper bound is: 18.7990071774505, lower bound is: 7.754565541178833. The root gap is: 58.7501%. Runtime: 14.742751121520996.
[ 9 27 29 37 56]
Number of outliers: 5
--------------------------------
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 420 rows, 243 columns and 1380 nonzeros
Model fingerprint: 0xdf05ba64
Model has 246 quadratic objective terms
Variable types: 63 continuous, 180 integer (180 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+03]
  Objective range  [2e-02, 3e+01]
  QObjective range [2e-02, 6e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-02, 1e+03]
Found heuristic solution: objective 27.2177053
Presolve time: 0.00s
Presolved: 420 rows, 243 columns, 1380 nonzeros
Presolved model has 246 quadratic objective terms
Variable types: 63 continuous, 180 integer (180 binary)

Root relaxation: objective 7.145115e+00, 542 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    7.14511    0  106   27.21771    7.14511  73.7%     -    0s
H    0     0                      19.5295685    7.14511  63.4%     -    0s
     0     0    7.14511    0  106   19.52957    7.14511  63.4%     -    0s
H    0     0                      19.2069259    7.75285  59.6%     -    0s
     0     2    7.75285    0  106   19.20693    7.75285  59.6%     -    0s
H   39    40                      19.1786266    9.65326  49.7%  22.3    0s
H  263   245                      18.7990072    9.65326  48.7%  12.0    0s
 29589  8541   16.59194   30   78   18.79901   16.23157  13.7%  10.8    5s
 72925  7858   18.02230   32   70   18.79901   17.78512  5.39%   9.0   10s

Explored 92933 nodes (777485 simplex iterations) in 12.59 seconds (16.18 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 18.799 19.1786 19.2069 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.879900717745e+01, best bound 1.879900717745e+01, gap 0.0000%

User-callback calls 189646, time in user-callback 0.26 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_job4.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 18.799007177450505.
The root upper bound is: 19.20692587621429, lower bound is: 7.752854219953814. The root gap is: 59.6351%. Runtime: 12.593581914901733.
--------------------------------------------------
   m   n   dataset formulation  ...     end_lb   end_gap  node_count       time
0  3  50  diabetes    original  ...  13.938979  0.000000     23088.0   0.759153
1  3  50  diabetes         opt  ...  13.938979  0.000000     12315.0   1.703157
2  3  60  diabetes    original  ...  18.798414  0.000032    578529.0  14.742751
3  3  60  diabetes         opt  ...  18.799007  0.000000     92933.0  12.593582

[4 rows x 12 columns]
[3, 70, 'diabetes']
[0.00338116 0.00722555 0.00987218 1.         1.        ]
The relaxed obj is 0.054838541833994725.
The larges value of x is 2.7909224948530844
Use new Big-M 5.581844989706169.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 140 rows, 143 columns and 280 nonzeros
Model fingerprint: 0xdee2936f
Model has 286 quadratic objective terms
Variable types: 73 continuous, 70 integer (70 binary)
Coefficient statistics:
  Matrix range     [1e+00, 6e+00]
  Objective range  [1e-03, 3e+01]
  QObjective range [6e-03, 7e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 35.0000000
Presolve time: 0.00s
Presolved: 140 rows, 143 columns, 280 nonzeros
Presolved model has 286 quadratic objective terms
Variable types: 73 continuous, 70 integer (70 binary)

Root relaxation: objective 8.121048e+00, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    8.12105    0   60   35.00000    8.12105  76.8%     -    0s
H    0     0                      24.3246926    8.12105  66.6%     -    0s
H    0     0                      23.2172851    8.12105  65.0%     -    0s
H    0     0                      22.8880267    8.12105  64.5%     -    0s
H    0     0                      22.8123159    8.12105  64.4%     -    0s
     0     0    8.72571    0   60   22.81232    8.72571  61.8%     -    0s
     0     2    8.72571    0   60   22.81232    8.72571  61.8%     -    0s
 151120 100642   22.03111   42   34   22.81232   17.79048  22.0%   4.8    5s
 326901 206265     cutoff   45        22.81232   18.58854  18.5%   4.6   10s
 494671 299798   20.20850   32   44   22.81232   19.00883  16.7%   4.6   15s
 662902 388098   21.02030   36   42   22.81232   19.29855  15.4%   4.5   20s
 833515 473553   20.80434   36   40   22.81232   19.53084  14.4%   4.5   25s
 1010760 557463   19.72997   31   47   22.81232   19.72569  13.5%   4.4   30s
 1179891 632060     cutoff   33        22.81232   19.88192  12.8%   4.4   35s
 1347963 703607   21.90331   40   37   22.81232   20.01448  12.3%   4.4   40s
 1517524 772765   21.45957   32   47   22.81232   20.13210  11.7%   4.4   45s
 1681935 835576   22.74296   39   39   22.81232   20.23422  11.3%   4.4   50s
 1843898 894254   20.67921   32   43   22.81232   20.32614  10.9%   4.4   55s
 2011556 953457   21.60238   35   41   22.81232   20.41395  10.5%   4.3   60s
 2171804 1006647   22.36994   33   39   22.81232   20.49040  10.2%   4.3   65s
 2334380 1057442   22.36742   40   37   22.81232   20.56275  9.86%   4.3   70s
 2497745 1105546   21.56258   33   45   22.81232   20.62948  9.57%   4.3   75s
 2661470 1151785   21.38181   34   43   22.81232   20.69347  9.29%   4.3   80s
 2824467 1196139   21.45554   36   40   22.81232   20.75473  9.02%   4.3   85s
 2986828 1237810   20.81200   31   45   22.81232   20.81110  8.77%   4.3   90s
 3149233 1276787   22.73021   41   36   22.81232   20.86481  8.54%   4.3   95s
 3311769 1313164   22.25645   39   35   22.81232   20.91696  8.31%   4.3  100s
 3474750 1347208   21.93140   34   42   22.81232   20.96645  8.09%   4.3  105s
 3642669 1380225   21.01638   38   36   22.81232   21.01543  7.88%   4.3  110s
 3806937 1409915   21.98619   35   43   22.81232   21.06213  7.67%   4.3  115s
 3971073 1437606   22.16246   42   33   22.81232   21.10663  7.48%   4.2  120s
 4132922 1462736   22.28505   35   38   22.81232   21.14884  7.29%   4.2  125s
 4294006 1484718   21.19133   34   38   22.81232   21.19013  7.11%   4.2  130s
 4458639 1505606   21.97279   38   37   22.81232   21.23066  6.93%   4.2  135s
 4621714 1524017     cutoff   38        22.81232   21.26950  6.76%   4.2  140s
 4783904 1540263   22.69794   36   43   22.81232   21.30776  6.60%   4.2  145s
 4946608 1554435   22.68053   37   39   22.81232   21.34431  6.44%   4.2  150s
 5108749 1565555   22.14800   36   38   22.81232   21.37981  6.28%   4.2  155s
 5271169 1575488   22.31375   37   36   22.81232   21.41535  6.12%   4.2  160s
 5440206 1583415     cutoff   36        22.81232   21.45113  5.97%   4.2  165s
 5603110 1589106   22.62202   40   36   22.81232   21.48542  5.82%   4.2  170s
 5766838 1592034   22.30333   39   37   22.81232   21.51955  5.67%   4.2  175s
 5927863 1592561   22.68408   40   38   22.81232   21.55298  5.52%   4.2  180s
 6090027 1591085   21.58639   34   42   22.81232   21.58615  5.38%   4.2  185s
 6250775 1588212   21.88253   38   42   22.81232   21.61847  5.23%   4.2  190s
 6411618 1583047   22.43735   38   38   22.81232   21.65079  5.09%   4.2  195s
 6573704 1575793   22.12868   41   36   22.81232   21.68288  4.95%   4.2  200s
 6733791 1565839   22.10288   31   48   22.81232   21.71521  4.81%   4.2  205s
 6894929 1552378   21.74749   34   42   22.81232   21.74728  4.67%   4.2  210s
 7062152 1535005   22.73268   38   38   22.81232   21.78075  4.52%   4.2  215s
 7224645 1515537   22.66717   40   36   22.81232   21.81267  4.38%   4.1  220s
 7386353 1494434     cutoff   39        22.81232   21.84399  4.24%   4.1  225s
 7546253 1471539     cutoff   35        22.81232   21.87489  4.11%   4.1  230s
 7704942 1446754     cutoff   41        22.81232   21.90492  3.98%   4.1  235s
 7862746 1420020   22.43178   37   40   22.81232   21.93459  3.85%   4.1  240s
 8021586 1389641   22.26125   35   44   22.81232   21.96442  3.72%   4.1  245s
 8184367 1351444   22.57997   36   42   22.81232   21.99627  3.58%   4.1  250s
 8348311 1309736   22.67863   37   37   22.81232   22.02967  3.43%   4.1  255s
 8509518 1266825   22.47493   40   36   22.81232   22.06207  3.29%   4.1  260s
 8670525 1222609     cutoff   44        22.81232   22.09493  3.14%   4.1  265s
 8831737 1176562     cutoff   39        22.81232   22.12766  3.00%   4.1  270s
 8992270 1129066   22.16031   37   38   22.81232   22.16026  2.86%   4.1  275s
 9153705 1079208     cutoff   44        22.81232   22.19389  2.71%   4.1  280s
 9310905 1028879     cutoff   33        22.81232   22.22682  2.57%   4.1  285s
 9469935 976235   22.66659   40   35   22.81232   22.26047  2.42%   4.1  290s
 9634159 919747   22.29579   36   42   22.81232   22.29573  2.26%   4.1  295s
 9791357 863340   22.50531   42   34   22.81232   22.33010  2.11%   4.1  300s

Explored 9792363 nodes (39785110 simplex iterations) in 300.01 seconds (352.15 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 22.8123 22.888 24.3247 35 

Time limit reached
Best objective 2.281231592018e+01, best bound 2.233033936874e+01, gap 2.1128%

User-callback calls 19612156, time in user-callback 26.87 sec
--------------------------------
solve the problem in original formulation
The obj is 22.81231592018474.
The root upper bound is: 22.81231592018474, lower bound is: 8.725710494670878. The root gap is: 61.75%. Runtime: 300.00886607170105.
[ 9 27 29 37 56]
Number of outliers: 5
--------------------------------
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 490 rows, 283 columns and 1610 nonzeros
Model fingerprint: 0xfd646381
Model has 286 quadratic objective terms
Variable types: 73 continuous, 210 integer (210 binary)
Coefficient statistics:
  Matrix range     [3e-03, 1e+03]
  Objective range  [1e-03, 3e+01]
  QObjective range [6e-03, 7e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-02, 1e+03]
Found heuristic solution: objective 37.8123935
Presolve time: 0.00s
Presolved: 490 rows, 283 columns, 1610 nonzeros
Presolved model has 286 quadratic objective terms
Variable types: 73 continuous, 210 integer (210 binary)

Root relaxation: objective 8.121048e+00, 496 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    8.12105    0  120   37.81239    8.12105  78.5%     -    0s
H    0     0                      23.5921180    8.12105  65.6%     -    0s
H    0     0                      23.5892344    8.12105  65.6%     -    0s
     0     0    8.12105    0  120   23.58923    8.12105  65.6%     -    0s
H    0     0                      22.8123159    8.53195  62.6%     -    0s
     0     2    8.53195    0  120   22.81232    8.53195  62.6%     -    0s
 19564  4775   20.91736   38   36   22.81232   17.27974  24.3%  15.8    5s
 48254  6797     cutoff   33        22.81232   19.84858  13.0%  14.3   10s
 75720  3606 infeasible   45        22.81232   21.75363  4.64%  12.8   15s

Explored 83232 nodes (1025892 simplex iterations) in 16.74 seconds (21.57 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 22.8123 23.5892 23.5921 37.8124 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.281231592018e+01, best bound 2.281231592018e+01, gap 0.0000%

User-callback calls 172917, time in user-callback 0.25 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_job4.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 22.81231592018474.
The root upper bound is: 22.81231592018474, lower bound is: 8.53194693177824. The root gap is: 62.5994%. Runtime: 16.740877151489258.
--------------------------------------------------
   m   n   dataset formulation  ...     end_lb   end_gap  node_count        time
0  3  50  diabetes    original  ...  13.938979  0.000000     23088.0    0.759153
1  3  50  diabetes         opt  ...  13.938979  0.000000     12315.0    1.703157
2  3  60  diabetes    original  ...  18.798414  0.000032    578529.0   14.742751
3  3  60  diabetes         opt  ...  18.799007  0.000000     92933.0   12.593582
4  3  70  diabetes    original  ...  22.330339  0.021128   9792363.0  300.008866
5  3  70  diabetes         opt  ...  22.812316  0.000000     83232.0   16.740877

[6 rows x 12 columns]
[3, 80, 'diabetes']
[0.00294621 0.00633153 0.00884202 1.         1.        ]
The relaxed obj is 0.06373322038064799.
The larges value of x is 2.68594551115115
Use new Big-M 5.3718910223023.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 160 rows, 163 columns and 320 nonzeros
Model fingerprint: 0x5900c934
Model has 326 quadratic objective terms
Variable types: 83 continuous, 80 integer (80 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [9e-03, 4e+01]
  QObjective range [3e-02, 8e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 40.0000000
Presolve time: 0.00s
Presolved: 160 rows, 163 columns, 320 nonzeros
Presolved model has 326 quadratic objective terms
Variable types: 83 continuous, 80 integer (80 binary)

Root relaxation: objective 9.645263e+00, 281 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    9.64526    0   68   40.00000    9.64526  75.9%     -    0s
H    0     0                      28.4285863    9.64526  66.1%     -    0s
H    0     0                      26.4046738    9.64526  63.5%     -    0s
     0     0    9.64526    0   68   26.40467    9.64526  63.5%     -    0s
H    0     0                      26.0317820    9.64526  62.9%     -    0s
     0     2    9.64526    0   68   26.03178    9.64526  62.9%     -    0s
 105226 57260   21.82233   43   52   26.03178   18.59999  28.5%   5.1    5s
 264052 170363     cutoff   50        26.03178   19.79677  24.0%   4.8   10s
 424286 279680   22.77163   48   47   26.03178   20.32035  21.9%   4.7   15s
 571119 377212   25.31567   59   34   26.03178   20.63970  20.7%   4.7   20s
 717879 473400   22.06207   43   47   26.03178   20.88079  19.8%   4.6   25s
 863247 566713   24.82063   58   35   26.03178   21.06875  19.1%   4.6   30s
 1007629 658257   24.94801   44   50   26.03178   21.22559  18.5%   4.6   35s
 1159540 752870   22.74018   48   45   26.03178   21.36757  17.9%   4.6   40s
 1307719 843644   23.95972   53   39   26.03178   21.48692  17.5%   4.6   45s
 1452944 931527   24.78509   55   39   26.03178   21.59187  17.1%   4.5   50s
 1599092 1018321   24.03470   47   44   26.03178   21.68642  16.7%   4.5   55s
 1746175 1105411   24.94171   54   41   26.03178   21.77445  16.4%   4.5   60s
 1898861 1195371     cutoff   55        26.03178   21.85806  16.0%   4.5   65s
 2047228 1281476   24.33538   52   40   26.03178   21.93113  15.8%   4.5   70s
 2197590 1368001   23.64553   51   41   26.03178   22.00037  15.5%   4.5   75s
 2342293 1449703   25.96411   51   41   26.03178   22.06315  15.2%   4.5   80s
 2490955 1533586   24.58932   51   43   26.03178   22.12345  15.0%   4.5   85s
 2637981 1615744   22.48157   43   48   26.03178   22.17937  14.8%   4.5   90s
 2791377 1700845   26.01064   58   35   26.03178   22.23482  14.6%   4.4   95s
 2939492 1782120   23.42234   43   51   26.03178   22.28528  14.4%   4.4  100s
 3087929 1862592   25.78947   56   37   26.03178   22.33260  14.2%   4.4  105s
 3236715 1943166   25.10098   51   42   26.03178   22.37818  14.0%   4.4  110s
 3385596 2022755   23.67330   47   44   26.03178   22.42191  13.9%   4.4  115s
 3531482 2100178   23.39746   46   47   26.03178   22.46226  13.7%   4.4  120s
 3683582 2180375   22.50383   40   54   26.03178   22.50245  13.6%   4.4  125s
 3831314 2257291   23.67609   44   47   26.03178   22.54109  13.4%   4.4  130s
 3977763 2332464     cutoff   48        26.03178   22.57741  13.3%   4.4  135s
 4127333 2408666   26.00880   58   34   26.03178   22.61265  13.1%   4.4  140s
 4275312 2484353   25.03331   49   43   26.03178   22.64685  13.0%   4.4  145s
 4421822 2558398   25.25531   51   40   26.03178   22.67885  12.9%   4.4  150s
 4573798 2634827   25.39610   46   47   26.03178   22.71162  12.8%   4.4  155s
 4722211 2709473   24.37726   45   49   26.03178   22.74170  12.6%   4.4  160s
 4870169 2782969   25.67528   51   45   26.03178   22.77115  12.5%   4.4  165s
 5020720 2857117   25.05324   56   38   26.03178   22.80002  12.4%   4.4  170s
 5169712 2930133     cutoff   48        26.03178   22.82829  12.3%   4.4  175s
 5323173 3005373   23.40027   47   45   26.03178   22.85722  12.2%   4.4  180s
 5474900 3077419     cutoff   53        26.03178   22.88453  12.1%   4.4  185s
 5623888 3149156   24.93271   52   40   26.03178   22.91023  12.0%   4.4  190s
 5771068 3219293   23.42702   47   47   26.03178   22.93526  11.9%   4.4  195s
 5917088 3287642   24.92487   52   41   26.03178   22.95912  11.8%   4.4  200s
 6062199 3356144   25.98795   57   34   26.03178   22.98261  11.7%   4.4  205s
 6211611 3425325   25.23070   51   42   26.03178   23.00631  11.6%   4.3  210s
 6362228 3494152   25.22357   52   42   26.03178   23.02917  11.5%   4.3  215s
 6507750 3560360   23.98838   47   45   26.03178   23.05037  11.5%   4.3  220s
 6656734 3628273     cutoff   51        26.03178   23.07219  11.4%   4.3  225s
 6803375 3694695   25.62453   56   35   26.03178   23.09294  11.3%   4.3  230s
 6949908 3760295   25.48702   53   39   26.03178   23.11322  11.2%   4.3  235s
 7099857 3826374   25.84011   53   42   26.03178   23.13345  11.1%   4.3  240s
 7245985 3890842   23.15329   43   53   26.03178   23.15278  11.1%   4.3  245s
 7397684 3957294   23.68716   47   46   26.03178   23.17257  11.0%   4.3  250s
 7543406 4020844   25.35216   54   38   26.03178   23.19109  10.9%   4.3  255s
 7691075 4084322   23.46928   47   46   26.03178   23.20948  10.8%   4.3  260s
 7836667 4146992   24.48990   50   42   26.03178   23.22758  10.8%   4.3  265s
 7984184 4209454   25.08455   54   37   26.03178   23.24525  10.7%   4.3  270s
 8136148 4273725   24.69701   53   40   26.03178   23.26342  10.6%   4.3  275s
 8282060 4335236   24.36732   47   44   26.03178   23.28051  10.6%   4.3  280s
 8428578 4396192   25.29309   49   44   26.03178   23.29738  10.5%   4.3  285s
 8574644 4457030   24.69964   53   39   26.03178   23.31368  10.4%   4.3  290s
 8720593 4516587   25.45869   47   47   26.03178   23.32986  10.4%   4.3  295s
 8870184 4577291   26.02635   53   39   26.03178   23.34572  10.3%   4.3  300s

Explored 8870192 nodes (38191069 simplex iterations) in 300.00 seconds (390.04 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 26.0318 28.4286 40 

Time limit reached
Best objective 2.603178196916e+01, best bound 2.334572104819e+01, gap 10.3184%

User-callback calls 17769595, time in user-callback 24.27 sec
--------------------------------
solve the problem in original formulation
The obj is 26.031781969164435.
The root upper bound is: 26.031781969164435, lower bound is: 9.64526302489988. The root gap is: 62.9481%. Runtime: 300.0031168460846.
[ 9 27 29 37 56 78]
Number of outliers: 6
--------------------------------
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 560 rows, 323 columns and 1840 nonzeros
Model fingerprint: 0x73dd3982
Model has 326 quadratic objective terms
Variable types: 83 continuous, 240 integer (240 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+03]
  Objective range  [9e-03, 4e+01]
  QObjective range [3e-02, 8e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-02, 1e+03]
Found heuristic solution: objective 39.3100625
Presolve time: 0.00s
Presolved: 560 rows, 323 columns, 1840 nonzeros
Presolved model has 326 quadratic objective terms
Variable types: 83 continuous, 240 integer (240 binary)

Root relaxation: objective 9.645263e+00, 543 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    9.64526    0  136   39.31006    9.64526  75.5%     -    0s
H    0     0                      27.3023157    9.64526  64.7%     -    0s
H    0     0                      26.9237272    9.64526  64.2%     -    0s
H    0     0                      26.3293824    9.64526  63.4%     -    0s
     0     0    9.64526    0  136   26.32938    9.64526  63.4%     -    0s
H    0     0                      26.2823190    9.82117  62.6%     -    0s
     0     2    9.82117    0  136   26.28232    9.82117  62.6%     -    0s
H   66    77                      26.2328262   11.83119  54.9%  19.9    0s
H   68    77                      26.1806625   11.83119  54.8%  19.5    0s
H 1468   924                      26.0317820   13.39006  48.6%  14.4    0s
 14515  4433   20.15367   27  120   26.03178   17.13331  34.2%  17.1    5s
 37544 10929     cutoff   34        26.03178   19.54074  24.9%  16.6   10s
 66924 17195   25.72512   36  112   26.03178   20.73354  20.4%  16.5   15s
 87507 21018     cutoff   47        26.03178   21.36294  17.9%  16.4   20s
 112516 25014   25.20732   42  102   26.03178   21.90171  15.9%  16.2   25s
 127431 26920   24.43179   31   94   26.03178   22.13817  15.0%  16.0   30s
 147276 29474 infeasible   43        26.03178   22.43519  13.8%  15.8   35s
 167038 31820     cutoff   35        26.03178   22.74194  12.6%  15.6   40s
 186259 33334 infeasible   36        26.03178   22.96174  11.8%  15.4   45s
 205336 34435     cutoff   43        26.03178   23.14341  11.1%  15.2   50s
 223401 35615   23.33980   37  122   26.03178   23.31161  10.4%  15.0   55s
 246362 35939   25.82126   42  104   26.03178   23.45363  9.90%  14.6   60s
 262439 35832   24.10595   40   98   26.03178   23.58163  9.41%  14.5   65s
 280709 35488   25.06878   39  118   26.03178   23.71610  8.90%  14.3   70s
 297203 34353   23.86591   35  102   26.03178   23.84164  8.41%  14.1   75s
 319547 33370 infeasible   40        26.03178   23.98548  7.86%  13.8   80s
 337602 32101 infeasible   45        26.03178   24.12964  7.31%  13.7   85s
 355449 30806   25.76640   42   94   26.03178   24.27499  6.75%  13.5   90s
 374092 29513   24.45964   40  110   26.03178   24.43359  6.14%  13.3   95s
 395039 27261   25.77159   41   98   26.03178   24.62291  5.41%  13.1  100s
 413158 24491   25.22196   40  104   26.03178   24.79864  4.74%  12.9  105s
 432960 20657     cutoff   42        26.03178   25.00546  3.94%  12.7  110s
 452371 15383   25.64160   41  102   26.03178   25.23313  3.07%  12.5  115s
 470831  8413   25.73703   44   96   26.03178   25.53401  1.91%  12.3  120s

Explored 486040 nodes (5878791 simplex iterations) in 123.88 seconds (166.90 work units)
Thread count was 8 (of 52 available processors)

Solution count 7: 26.0318 26.1807 26.2328 ... 27.3023

Optimal solution found (tolerance 1.00e-04)
Best objective 2.603178196916e+01, best bound 2.603178196916e+01, gap 0.0000%

User-callback calls 1022390, time in user-callback 1.47 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_job4.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 26.03178196916445.
The root upper bound is: 26.282319049591145, lower bound is: 9.821166742746271. The root gap is: 62.632%. Runtime: 123.8837251663208.
--------------------------------------------------
   m   n   dataset formulation  ...     end_lb   end_gap  node_count        time
0  3  50  diabetes    original  ...  13.938979  0.000000     23088.0    0.759153
1  3  50  diabetes         opt  ...  13.938979  0.000000     12315.0    1.703157
2  3  60  diabetes    original  ...  18.798414  0.000032    578529.0   14.742751
3  3  60  diabetes         opt  ...  18.799007  0.000000     92933.0   12.593582
4  3  70  diabetes    original  ...  22.330339  0.021128   9792363.0  300.008866
5  3  70  diabetes         opt  ...  22.812316  0.000000     83232.0   16.740877
6  3  80  diabetes    original  ...  23.345721  0.103184   8870192.0  300.003117
7  3  80  diabetes         opt  ...  26.031782  0.000000    486040.0  123.883725

[8 rows x 12 columns]
[3, 90, 'diabetes']
[0.0027644  0.00574946 0.00667599 1.         1.        ]
The relaxed obj is 0.0712985851779635.
The larges value of x is 2.7437103879660043
Use new Big-M 5.487420775932009.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 180 rows, 183 columns and 360 nonzeros
Model fingerprint: 0x68a178d5
Model has 366 quadratic objective terms
Variable types: 93 continuous, 90 integer (90 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [5e-03, 4e+01]
  QObjective range [1e-02, 9e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 45.0000000
Presolve time: 0.00s
Presolved: 180 rows, 183 columns, 360 nonzeros
Presolved model has 366 quadratic objective terms
Variable types: 93 continuous, 90 integer (90 binary)

Root relaxation: objective 1.040131e+01, 340 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   10.40131    0   73   45.00000   10.40131  76.9%     -    0s
H    0     0                      30.1212008   10.40131  65.5%     -    1s
H    0     0                      28.9676445   10.40131  64.1%     -    1s
H    0     0                      28.8369101   10.40131  63.9%     -    1s
H    0     0                      28.7503125   10.40131  63.8%     -    1s
     0     0   10.53316    0   73   28.75031   10.53316  63.4%     -    1s
     0     2   10.53316    0   73   28.75031   10.53316  63.4%     -    1s
 72710 57252   25.19166   39   50   28.75031   19.37663  32.6%   5.5    5s
 203413 158521   21.23314   27   57   28.75031   20.45461  28.9%   5.3   10s
 330624 254322   24.63534   36   50   28.75031   20.97481  27.0%   5.2   15s
 459936 349751   24.28310   31   55   28.75031   21.32796  25.8%   5.2   20s
 588685 445055   27.47072   46   41   28.75031   21.57852  24.9%   5.1   25s
 724694 544109   25.10952   33   57   28.75031   21.79330  24.2%   5.1   30s
 854358 638155   26.29353   39   50   28.75031   21.95551  23.6%   5.1   35s
 982483 730761   22.80859   25   65   28.75031   22.09587  23.1%   5.0   40s
 1116803 826731   23.07027   31   56   28.75031   22.22680  22.7%   5.0   45s
 1246728 917874   25.74200   32   54   28.75031   22.33632  22.3%   5.0   50s
 1376416 1008971   26.81256   37   49   28.75031   22.43372  22.0%   5.0   55s
 1504012 1097688   25.68549   33   54   28.75031   22.52246  21.7%   5.0   60s
 1637894 1191511   24.88839   35   49   28.75031   22.60692  21.4%   5.0   65s
 1765727 1279489   24.13700   32   56   28.75031   22.67988  21.1%   4.9   70s
 1895621 1369313   25.33029   39   50   28.75031   22.74974  20.9%   4.9   75s
 2025576 1459204   26.03809   39   49   28.75031   22.81600  20.6%   4.9   80s
 2161093 1552934   28.60748   50   36   28.75031   22.88021  20.4%   4.9   85s
 2293735 1645024   26.67320   41   45   28.75031   22.93967  20.2%   4.9   90s
 2425356 1734796   26.48776   34   59   28.75031   22.99364  20.0%   4.9   95s
 2553115 1821106   27.34047   47   39   28.75031   23.04565  19.8%   4.9  100s
 2688600 1913220   27.93834   37   46   28.75031   23.09791  19.7%   4.9  105s
 2817435 2000864   23.44414   30   61   28.75031   23.14239  19.5%   4.9  110s
 2946535 2086987   27.85101   48   40   28.75031   23.18669  19.4%   4.9  115s
 3082675 2177496   27.20102   42   46   28.75031   23.23158  19.2%   4.9  120s
 3215142 2265854   24.39703   32   53   28.75031   23.27324  19.1%   4.9  125s
 3343227 2350839   28.45004   44   41   28.75031   23.31069  18.9%   4.9  130s
 3472436 2436730   26.11177   35   56   28.75031   23.34730  18.8%   4.9  135s
 3607063 2526243   25.17290   34   53   28.75031   23.38428  18.7%   4.9  140s
 3737395 2613900   23.76023   29   58   28.75031   23.41784  18.5%   4.9  145s
 3867550 2700259   27.56905   42   43   28.75031   23.44983  18.4%   4.9  150s
 3995676 2784594   25.36683   36   53   28.75031   23.48124  18.3%   4.9  155s
 4130834 2873540   25.20337   35   55   28.75031   23.51417  18.2%   4.8  160s
 4259504 2957206     cutoff   43        28.75031   23.54356  18.1%   4.8  165s
 4388874 3041728   25.01394   35   51   28.75031   23.57304  18.0%   4.8  170s
 4521551 3128663   25.49871   38   50   28.75031   23.60142  17.9%   4.8  175s
 4651508 3212584   24.82994   35   51   28.75031   23.62850  17.8%   4.8  180s
 4780415 3295718   25.46394   32   55   28.75031   23.65591  17.7%   4.8  185s
 4908839 3379438   28.12651   37   47   28.75031   23.68085  17.6%   4.8  190s
 5058032 3476570   24.06259   32   52   28.75031   23.70994  17.5%   4.8  195s
 5209089 3573684   25.71216   35   52   28.75031   23.73842  17.4%   4.8  200s
 5350542 3665469   24.77821   35   50   28.75031   23.76412  17.3%   4.8  205s
 5480629 3749452   28.49451   55   34   28.75031   23.78710  17.3%   4.8  210s
 5616692 3836574   25.90821   33   54   28.75031   23.81037  17.2%   4.8  215s
 5743996 3918358   25.44490   33   54   28.75031   23.83182  17.1%   4.8  220s
 5874972 4000568   24.79468   33   59   28.75031   23.85408  17.0%   4.8  225s
 6009611 4086492   26.50206   41   49   28.75031   23.87608  17.0%   4.8  230s
 6137597 4167599   27.93767   41   45   28.75031   23.89627  16.9%   4.8  235s
 6265934 4248591   27.36540   44   47   28.75031   23.91602  16.8%   4.8  240s
 6395440 4330754   25.54712   33   60   28.75031   23.93576  16.7%   4.8  245s
 6529708 4414974   27.62280   41   51   28.75031   23.95578  16.7%   4.8  250s
 6660066 4497403   24.37509   33   53   28.75031   23.97490  16.6%   4.8  255s
 6789575 4578312   28.46938   44   43   28.75031   23.99351  16.5%   4.8  260s
 6918459 4659198   28.60629   54   38   28.75031   24.01130  16.5%   4.8  265s
 7056046 4745736   27.12432   35   59   28.75031   24.02973  16.4%   4.8  270s
 7186498 4827570   24.04809   32   51   28.75031   24.04719  16.4%   4.8  275s
 7315570 4908018   26.93249   40   47   28.75031   24.06428  16.3%   4.8  280s
 7445377 4988515   27.70545   41   45   28.75031   24.08095  16.2%   4.8  285s
 7579935 5071974   25.80385   32   54   28.75031   24.09764  16.2%   4.8  290s
 7706251 5149843   27.02071   41   48   28.75031   24.11310  16.1%   4.8  295s
 7837248 5230149   26.20230   33   56   28.75031   24.12903  16.1%   4.8  300s

Explored 7837892 nodes (37420423 simplex iterations) in 300.01 seconds (417.17 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 28.7503 30.1212 45 

Time limit reached
Best objective 2.875031245609e+01, best bound 2.412909816907e+01, gap 16.0736%

User-callback calls 15705608, time in user-callback 21.94 sec
--------------------------------
solve the problem in original formulation
The obj is 28.750312456094065.
The root upper bound is: 28.750312456094065, lower bound is: 10.53315762249344. The root gap is: 63.3633%. Runtime: 300.00649905204773.
[ 9 27 29 37 56 78]
Number of outliers: 6
--------------------------------
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 630 rows, 363 columns and 2070 nonzeros
Model fingerprint: 0xb9830bef
Model has 366 quadratic objective terms
Variable types: 93 continuous, 270 integer (270 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+03]
  Objective range  [5e-03, 4e+01]
  QObjective range [1e-02, 9e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-02, 1e+03]
Found heuristic solution: objective 46.3951794
Presolve time: 0.00s
Presolved: 630 rows, 363 columns, 2070 nonzeros
Presolved model has 366 quadratic objective terms
Variable types: 93 continuous, 270 integer (270 binary)

Root relaxation: objective 1.040131e+01, 1302 iterations, 0.02 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   10.40131    0  146   46.39518   10.40131  77.6%     -    0s
H    0     0                      30.4401489   10.40131  65.8%     -    0s
H    0     0                      29.3773055   10.40131  64.6%     -    0s
     0     0   10.40131    0  146   29.37731   10.40131  64.6%     -    0s
H    0     0                      28.7503125   10.99449  61.8%     -    0s
     0     2   10.99449    0  146   28.75031   10.99449  61.8%     -    0s
 12926  4603   21.56097   34  114   28.75031   17.88979  37.8%  18.4    5s
 30215  9673   19.49020   37  138   28.75031   19.49020  32.2%  18.5   10s
 47229  8498 infeasible   51        28.75031   20.47329  28.8%  18.0   15s
 69873  8487     cutoff   55        28.75031   23.52600  18.2%  16.8   20s
 88422  9973   25.06777   57  114   28.75031   24.93243  13.3%  16.2   25s
 109703  9625 infeasible   71        28.75031   25.75782  10.4%  15.3   30s
 128060  7698   26.76141   70   78   28.75031   26.67115  7.23%  14.7   35s
 145000  3073     cutoff   53        28.75031   27.83754  3.17%  14.1   40s

Explored 150897 nodes (2090143 simplex iterations) in 41.52 seconds (53.32 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 28.7503 29.3773 30.4401 46.3952 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.875031245609e+01, best bound 2.875031245609e+01, gap 0.0000%

User-callback calls 317225, time in user-callback 0.48 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_job4.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 28.750312456094065.
The root upper bound is: 28.750312456094065, lower bound is: 10.994492273394819. The root gap is: 61.7587%. Runtime: 41.526219844818115.
--------------------------------------------------
   m   n   dataset formulation  ...     end_lb   end_gap  node_count        time
0  3  50  diabetes    original  ...  13.938979  0.000000     23088.0    0.759153
1  3  50  diabetes         opt  ...  13.938979  0.000000     12315.0    1.703157
2  3  60  diabetes    original  ...  18.798414  0.000032    578529.0   14.742751
3  3  60  diabetes         opt  ...  18.799007  0.000000     92933.0   12.593582
4  3  70  diabetes    original  ...  22.330339  0.021128   9792363.0  300.008866
5  3  70  diabetes         opt  ...  22.812316  0.000000     83232.0   16.740877
6  3  80  diabetes    original  ...  23.345721  0.103184   8870192.0  300.003117
7  3  80  diabetes         opt  ...  26.031782  0.000000    486040.0  123.883725
8  3  90  diabetes    original  ...  24.129098  0.160736   7837892.0  300.006499
9  3  90  diabetes         opt  ...  28.750312  0.000000    150897.0   41.526220

[10 rows x 12 columns]
[3, 100, 'diabetes']
[0.00249289 0.00506796 0.00617259 1.         1.        ]
The relaxed obj is 0.07895448366108582.
The larges value of x is 2.7547518257215935
Use new Big-M 5.509503651443187.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 200 rows, 203 columns and 400 nonzeros
Model fingerprint: 0xa5acf7a7
Model has 406 quadratic objective terms
Variable types: 103 continuous, 100 integer (100 binary)
Coefficient statistics:
  Matrix range     [1e+00, 6e+00]
  Objective range  [6e-03, 5e+01]
  QObjective range [1e-03, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 50.0000000
Presolve time: 0.00s
Presolved: 200 rows, 203 columns, 400 nonzeros
Presolved model has 406 quadratic objective terms
Variable types: 103 continuous, 100 integer (100 binary)

Root relaxation: objective 1.128377e+01, 369 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   11.28377    0   79   50.00000   11.28377  77.4%     -    0s
H    0     0                      33.0761603   11.28377  65.9%     -    0s
H    0     0                      31.5796078   11.28377  64.3%     -    0s
H    0     0                      31.4400586   11.28377  64.1%     -    0s
H    0     0                      31.3453093   11.28377  64.0%     -    0s
     0     0   11.38955    0   79   31.34531   11.38955  63.7%     -    0s
     0     2   11.38955    0   79   31.34531   11.38955  63.7%     -    0s
 81583 66695   29.35781   40   54   31.34531   20.41751  34.9%   6.1    5s
 192705 155251   27.42101   45   50   31.34531   21.40150  31.7%   5.9   10s
 308555 246702   25.35352   35   60   31.34531   21.91424  30.1%   5.8   15s
 420392 334300   29.34076   47   51   31.34531   22.24487  29.0%   5.7   20s
 531814 420213   24.82269   32   62   31.34531   22.49221  28.2%   5.7   25s
 650816 512130   25.02257   33   66   31.34531   22.70528  27.6%   5.6   30s
 761730 596472   29.20752   48   50   31.34531   22.86754  27.0%   5.6   35s
 875493 683802   30.23529   49   53   31.34531   23.00819  26.6%   5.6   40s
 995800 775373   27.76502   30   72   31.34531   23.13584  26.2%   5.6   45s
 1109296 860648   27.70211   38   59   31.34531   23.24922  25.8%   5.5   50s
 1222680 946616   27.76698   38   57   31.34531   23.35148  25.5%   5.5   55s
 1341775 1035773   24.06036   30   70   31.34531   23.44380  25.2%   5.5   60s
 1455731 1120893   28.25095   36   63   31.34531   23.52682  24.9%   5.5   65s
 1566953 1204228   25.73468   35   61   31.34531   23.59776  24.7%   5.5   70s
 1688701 1295637   25.43112   32   65   31.34531   23.67466  24.5%   5.5   75s
 1802487 1379827   25.78516   36   61   31.34531   23.74055  24.3%   5.5   80s
 1919307 1466605   25.47408   34   61   31.34531   23.80360  24.1%   5.5   85s
 2033869 1551103   30.20061   46   54   31.34531   23.86537  23.9%   5.5   90s
 2148746 1636473   28.96626   48   46   31.34531   23.92007  23.7%   5.4   95s
 2264551 1721234   26.41504   31   67   31.34531   23.97350  23.5%   5.4  100s
 2385914 1810370   27.73243   38   61   31.34531   24.02679  23.3%   5.4  105s
 2502497 1896006   29.87909   42   53   31.34531   24.07424  23.2%   5.4  110s
 2614417 1978377   26.11880   37   60   31.34531   24.11834  23.1%   5.4  115s
 2735876 2066616   29.07584   40   55   31.34531   24.16278  22.9%   5.4  120s
 2850017 2149743   29.63969   54   45   31.34531   24.20305  22.8%   5.4  125s
 2964550 2232567   26.06575   39   59   31.34531   24.24268  22.7%   5.4  130s
 3085812 2321141   30.62305   44   51   31.34531   24.28346  22.5%   5.4  135s
 3198813 2402921   26.84591   39   59   31.34531   24.31962  22.4%   5.4  140s
 3318269 2489552   30.80917   50   53   31.34531   24.35550  22.3%   5.4  145s
 3435407 2574210   28.57308   41   52   31.34531   24.38941  22.2%   5.4  150s
 3560159 2664359   25.44637   32   64   31.34531   24.42496  22.1%   5.4  155s
 3697857 2763411   27.15145   40   56   31.34531   24.46226  22.0%   5.4  160s
 3833844 2862086   25.26979   34   62   31.34531   24.49853  21.8%   5.4  165s
 3948226 2943865   28.57106   46   54   31.34531   24.52729  21.8%   5.4  170s
 4061819 3026019     cutoff   42        31.34531   24.55486  21.7%   5.4  175s
 4180785 3110942   25.65367   35   60   31.34531   24.58246  21.6%   5.4  180s
 4294197 3192527   27.80163   39   57   31.34531   24.60837  21.5%   5.4  185s
 4408305 3274355   26.81498   36   62   31.34531   24.63422  21.4%   5.3  190s
 4527128 3360431   31.30408   41   54   31.34531   24.66046  21.3%   5.3  195s
 4641744 3442868   24.68737   33   63   31.34531   24.68521  21.2%   5.3  200s
 4754665 3523860     cutoff   58        31.34531   24.70911  21.2%   5.3  205s
 4874094 3609517   28.86413   42   54   31.34531   24.73287  21.1%   5.3  210s
 4987517 3690554   28.73675   38   62   31.34531   24.75595  21.0%   5.3  215s
 5101223 3771268   28.69564   30   66   31.34531   24.77904  20.9%   5.3  220s
 5219885 3854971   26.48629   36   59   31.34531   24.80164  20.9%   5.3  225s
 5332738 3934971   29.33599   43   52   31.34531   24.82272  20.8%   5.3  230s
 5451415 4018240   26.82901   38   57   31.34531   24.84435  20.7%   5.3  235s
 5565142 4098932   26.41701   35   63   31.34531   24.86421  20.7%   5.3  240s
 5676904 4178191   31.27086   49   49   31.34531   24.88404  20.6%   5.3  245s
 5796268 4261477   28.11599   38   57   31.34531   24.90510  20.5%   5.3  250s
 5910380 4341649   30.18875   46   53   31.34531   24.92389  20.5%   5.3  255s
 6025398 4422396   27.32810   36   64   31.34531   24.94320  20.4%   5.3  260s
 6141907 4503112   29.38277   41   64   31.34531   24.96130  20.4%   5.3  265s
 6255242 4583734   26.23960   39   57   31.34531   24.97873  20.3%   5.3  270s
 6369182 4663926   30.43762   49   48   31.34531   24.99640  20.3%   5.3  275s
 6489327 4747574   27.45509   36   67   31.34531   25.01497  20.2%   5.3  280s
 6605105 4828325     cutoff   57        31.34531   25.03234  20.1%   5.3  285s
 6722465 4910990   29.22753   37   66   31.34531   25.05022  20.1%   5.3  290s
 6841888 4994854   26.66824   37   63   31.34531   25.06791  20.0%   5.3  295s
 6955527 5073749   30.82350   51   46   31.34531   25.08438  20.0%   5.3  300s

Explored 6956184 nodes (36789617 simplex iterations) in 300.01 seconds (447.90 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 31.3453 33.0762 50 

Time limit reached
Best objective 3.134530932995e+01, best bound 2.508445673832e+01, gap 19.9738%

User-callback calls 13942808, time in user-callback 19.49 sec
--------------------------------
solve the problem in original formulation
The obj is 31.345309329945195.
The root upper bound is: 31.345309329945195, lower bound is: 11.389549788181602. The root gap is: 63.6643%. Runtime: 300.00683403015137.
[ 9 27 29 37 56 78 92]
Number of outliers: 7
--------------------------------
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 700 rows, 403 columns and 2300 nonzeros
Model fingerprint: 0x8703435d
Model has 406 quadratic objective terms
Variable types: 103 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [5e-04, 1e+03]
  Objective range  [6e-03, 5e+01]
  QObjective range [1e-03, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-02, 1e+03]
Found heuristic solution: objective 51.0732742
Presolve time: 0.00s
Presolved: 700 rows, 403 columns, 2300 nonzeros
Presolved model has 406 quadratic objective terms
Variable types: 103 continuous, 300 integer (300 binary)

Root relaxation: objective 1.128377e+01, 1446 iterations, 0.03 seconds (0.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   11.28377    0  158   51.07327   11.28377  77.9%     -    0s
H    0     0                      32.5904211   11.28377  65.4%     -    0s
H    0     0                      31.3453093   11.43780  63.5%     -    0s
     0     0   11.43780    0  158   31.34531   11.43780  63.5%     -    0s
     0     2   11.87125    0  158   31.34531   11.87125  62.1%     -    0s
  9503  3221   20.16327   26  152   31.34531   18.49806  41.0%  17.8    5s
 26129  8022   30.17716   26   66   31.34531   21.24203  32.2%  18.2   10s
 42348 12154 infeasible   37        31.34531   22.48218  28.3%  18.2   15s
 59561 15487 infeasible   38        31.34531   23.38930  25.4%  18.1   20s
 75245 20472   28.71498   42   24   31.34531   23.97907  23.5%  17.8   25s
 90432 24055   24.84961   37  130   31.34531   24.41978  22.1%  17.5   30s
 112858 26945   25.22520   42  120   31.34531   24.82656  20.8%  17.1   35s
 126187 29398   25.22520   30  158   31.34531   25.15425  19.8%  17.1   40s
 143104 32200 infeasible   41        31.34531   25.39396  19.0%  16.9   45s
 158577 34737 infeasible   42        31.34531   25.61371  18.3%  16.7   50s
 173545 37317   26.15122   35  146   31.34531   25.85234  17.5%  16.6   55s
 190463 39818     cutoff   50        31.34531   26.04279  16.9%  16.6   60s
 205698 42033 infeasible   45        31.34531   26.20618  16.4%  16.5   65s
 221642 44307     cutoff   47        31.34531   26.37077  15.9%  16.4   70s
 237160 46447 infeasible   42        31.34531   26.50732  15.4%  16.3   75s
 253580 48471 infeasible   45        31.34531   26.64424  15.0%  16.3   80s
 268163 50185     cutoff   51        31.34531   26.74919  14.7%  16.2   85s
 283489 52200   27.24536   35  136   31.34531   26.86875  14.3%  16.1   90s
 299016 54929   27.16719   44  124   31.34531   26.98230  13.9%  16.1   95s
 315821 55632 infeasible   38        31.34531   27.09210  13.6%  16.0  100s
 328535 57865     cutoff   43        31.34531   27.19614  13.2%  15.9  105s
 343627 58258 infeasible   43        31.34531   27.28431  13.0%  15.9  110s
 357008 59355 infeasible   41        31.34531   27.36213  12.7%  15.8  115s
 372055 60234 infeasible   42        31.34531   27.44961  12.4%  15.8  120s
 387896 61350   30.56677   51  116   31.34531   27.53311  12.2%  15.7  125s
 402694 62915   28.02583   43  138   31.34531   27.61154  11.9%  15.7  131s
 417538 62931 infeasible   47        31.34531   27.68348  11.7%  15.6  135s
 432228 63509     cutoff   53        31.34531   27.75432  11.5%  15.6  140s
 446312 64231 infeasible   35        31.34531   27.81679  11.3%  15.5  145s
 461500 64752     cutoff   46        31.34531   27.89783  11.0%  15.5  150s
 476751 64947 infeasible   42        31.34531   27.96846  10.8%  15.5  155s
 491036 65161 infeasible   38        31.34531   28.02794  10.6%  15.4  160s
 507774 65380 infeasible   51        31.34531   28.10523  10.3%  15.4  165s
 523621 65643   31.04575   48  124   31.34531   28.17087  10.1%  15.3  170s
 539001 65760   28.26370   48  144   31.34531   28.24994  9.88%  15.3  175s
 554272 65619   28.90362   39  154   31.34531   28.30893  9.69%  15.3  180s
 569212 65507   30.80422   34  158   31.34531   28.36689  9.50%  15.2  185s
 584049 65353     cutoff   48        31.34531   28.41920  9.34%  15.2  190s
 598608 64781 infeasible   39        31.34531   28.47862  9.15%  15.1  195s
 613523 63991     cutoff   41        31.34531   28.53739  8.96%  15.1  200s
 629648 63435     cutoff   46        31.34531   28.59546  8.77%  15.0  206s
 644604 62875     cutoff   48        31.34531   28.64947  8.60%  15.0  210s
 659738 61618   28.77187   46  148   31.34531   28.70367  8.43%  14.9  216s
 673382 61102     cutoff   44        31.34531   28.75163  8.27%  14.9  220s
 688633 60562   31.12216   45  138   31.34531   28.81182  8.08%  14.8  225s
 704100 59453   29.18878   37   50   31.34531   28.86919  7.90%  14.8  230s
 718307 58581 infeasible   45        31.34531   28.93368  7.69%  14.7  235s
 733361 57691     cutoff   42        31.34531   28.99900  7.49%  14.7  240s
 747312 56462 infeasible   49        31.34531   29.05397  7.31%  14.7  245s
 761768 55410 infeasible   47        31.34531   29.11363  7.12%  14.6  250s
 777580 54064     cutoff   47        31.34531   29.18295  6.90%  14.6  255s
 789585 52800 infeasible   46        31.34531   29.24232  6.71%  14.6  260s
 805147 51319   31.14605   46  116   31.34531   29.31138  6.49%  14.5  265s
 819407 49823     cutoff   48        31.34531   29.37606  6.28%  14.5  270s
 834382 48064 infeasible   39        31.34531   29.44682  6.06%  14.4  275s
 849163 46165   29.53012   46  122   31.34531   29.51973  5.82%  14.4  280s
 863949 44202 infeasible   49        31.34531   29.59026  5.60%  14.3  285s
 878825 42017     cutoff   51        31.34531   29.66386  5.36%  14.3  290s
 893765 39708 infeasible   35        31.34531   29.74091  5.12%  14.2  295s
 908296 37089     cutoff   46        31.34531   29.82135  4.86%  14.2  300s

Explored 908650 nodes (12875190 simplex iterations) in 300.00 seconds (415.01 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 31.3453 32.5904 51.0733 

Time limit reached
Best objective 3.134530932995e+01, best bound 2.982345035196e+01, gap 4.8551%

User-callback calls 1940361, time in user-callback 2.89 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_job4.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 31.345309329945188.
The root upper bound is: 31.345309329945188, lower bound is: 11.871252484389926. The root gap is: 62.1275%. Runtime: 300.0054278373718.
--------------------------------------------------
    m    n   dataset formulation  ...     end_lb   end_gap  node_count        time
0   3   50  diabetes    original  ...  13.938979  0.000000     23088.0    0.759153
1   3   50  diabetes         opt  ...  13.938979  0.000000     12315.0    1.703157
2   3   60  diabetes    original  ...  18.798414  0.000032    578529.0   14.742751
3   3   60  diabetes         opt  ...  18.799007  0.000000     92933.0   12.593582
4   3   70  diabetes    original  ...  22.330339  0.021128   9792363.0  300.008866
5   3   70  diabetes         opt  ...  22.812316  0.000000     83232.0   16.740877
6   3   80  diabetes    original  ...  23.345721  0.103184   8870192.0  300.003117
7   3   80  diabetes         opt  ...  26.031782  0.000000    486040.0  123.883725
8   3   90  diabetes    original  ...  24.129098  0.160736   7837892.0  300.006499
9   3   90  diabetes         opt  ...  28.750312  0.000000    150897.0   41.526220
10  3  100  diabetes    original  ...  25.084457  0.199738   6956184.0  300.006834
11  3  100  diabetes         opt  ...  29.823450  0.048551    908650.0  300.005428

[12 rows x 12 columns]
[3, 120, 'diabetes']
[0.00213879 0.00395312 0.0052645  1.         1.        ]
The relaxed obj is 0.09585303403143541.
The larges value of x is 2.486359615639587
Use new Big-M 4.972719231279174.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 240 rows, 243 columns and 480 nonzeros
Model fingerprint: 0xe1590ff9
Model has 486 quadratic objective terms
Variable types: 123 continuous, 120 integer (120 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [4e-03, 6e+01]
  QObjective range [1e-03, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 60.0000000
Presolve time: 0.00s
Presolved: 240 rows, 243 columns, 480 nonzeros
Presolved model has 486 quadratic objective terms
Variable types: 123 continuous, 120 integer (120 binary)

Root relaxation: objective 1.491937e+01, 442 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   14.91937    0   99   60.00000   14.91937  75.1%     -    0s
H    0     0                      40.7069586   14.91937  63.3%     -    0s
H    0     0                      38.5451102   14.91937  61.3%     -    0s
H    0     0                      38.2635883   14.91937  61.0%     -    0s
H    0     0                      38.1155339   14.91937  60.9%     -    0s
     0     0   15.17507    0   99   38.11553   15.17507  60.2%     -    0s
     0     2   15.17507    0   99   38.11553   15.17507  60.2%     -    1s
 55355 45425   28.00832   31   82   38.11553   23.82347  37.5%   6.2    5s
 151496 125367   29.58896   34   76   38.11553   25.01075  34.4%   6.0   10s
 243973 202146   33.35812   39   77   38.11553   25.53557  33.0%   5.9   15s
 338550 280458   30.53779   37   73   38.11553   25.89496  32.1%   5.9   20s
 429483 355610   27.02988   27   85   38.11553   26.14841  31.4%   5.9   25s
 518727 429908   37.56707   64   49   38.11553   26.34154  30.9%   5.8   30s
 612595 506852   33.07347   41   68   38.11553   26.52402  30.4%   5.8   35s
 709626 585580   33.39565   42   67   38.11553   26.68669  30.0%   5.8   40s
 800241 659719   31.96825   39   72   38.11553   26.80863  29.7%   5.8   45s
 891896 734630   31.63323   34   79   38.11553   26.92759  29.4%   5.8   50s
 988356 812972   37.90742   45   66   38.11553   27.03086  29.1%   5.8   55s
 1081680 888739   31.81678   36   76   38.11553   27.12471  28.8%   5.8   60s
 1180019 968148   30.61695   31   79   38.11553   27.21420  28.6%   5.7   65s
 1273369 1043455   37.62988   60   52   38.11553   27.29773  28.4%   5.7   70s
 1370298 1121387   29.42928   34   77   38.11553   27.37205  28.2%   5.7   75s
 1464098 1197202   37.91199   51   59   38.11553   27.43965  28.0%   5.7   80s
 1561314 1274622   28.24358   29   80   38.11553   27.50749  27.8%   5.7   85s
 1662095 1355498   34.62222   43   72   38.11553   27.57065  27.7%   5.7   90s
 1755857 1429519   29.46607   27   90   38.11553   27.62769  27.5%   5.7   95s
 1855895 1509532   36.61020   49   66   38.11553   27.68420  27.4%   5.7  100s
 1949796 1584733   35.17424   46   65   38.11553   27.73739  27.2%   5.7  105s
 2042821 1659360   30.37560   31   86   38.11553   27.78617  27.1%   5.7  110s
 2144373 1740358   31.14278   35   77   38.11553   27.83656  27.0%   5.7  115s
 2236054 1814133   31.57856   37   77   38.11553   27.87833  26.9%   5.6  120s
 2334212 1891176   34.45397   37   74   38.11553   27.92034  26.7%   5.6  125s
 2428324 1966627   29.80650   34   75   38.11553   27.96159  26.6%   5.6  130s
 2521165 2040744   31.11432   32   79   38.11553   27.99888  26.5%   5.6  135s
 2618429 2118502   34.32003   38   75   38.11553   28.03755  26.4%   5.6  140s
 2713299 2193339   33.22246   41   68   38.11553   28.07367  26.3%   5.6  145s
 2812629 2272897   31.85813   38   73   38.11553   28.11005  26.3%   5.6  150s
 2904941 2346199   37.98866   60   52   38.11553   28.14201  26.2%   5.6  155s
 3005575 2425876   29.52209   28   91   38.11553   28.17681  26.1%   5.6  160s
 3098764 2499818   34.83445   49   60   38.11553   28.20835  26.0%   5.6  165s
 3201625 2581992   34.89571   43   71   38.11553   28.24114  25.9%   5.6  170s
 3308870 2667055   32.37681   42   67   38.11553   28.27359  25.8%   5.6  175s
 3420258 2756140   28.66912   29   82   38.11553   28.30564  25.7%   5.6  180s
 3522262 2836751   35.43036   42   72   38.11553   28.33501  25.7%   5.6  185s
 3614562 2909771   35.95506   53   59   38.11553   28.36063  25.6%   5.6  190s
 3708261 2983916   37.30120   68   42   38.11553   28.38707  25.5%   5.6  195s
 3806473 3061535   30.08374   32   76   38.11553   28.41295  25.5%   5.6  200s
 3901034 3135854   29.19424   32   78   38.11553   28.43771  25.4%   5.6  205s
 4002295 3215657   30.66142   35   75   38.11553   28.46397  25.3%   5.6  210s
 4096721 3290252   31.16655   33   76   38.11553   28.48771  25.3%   5.6  215s
 4195864 3368776   33.92927   40   75   38.11553   28.51152  25.2%   5.6  220s
 4288233 3441378   32.46027   39   72   38.11553   28.53194  25.1%   5.6  225s
 4387830 3519791   34.19692   42   69   38.11553   28.55458  25.1%   5.6  230s
 4483022 3593904   28.93503   31   80   38.11553   28.57533  25.0%   5.6  235s
 4577590 3667805   35.67103   49   61   38.11553   28.59627  25.0%   5.6  240s
 4678421 3746337   29.53316   31   78   38.11553   28.61808  24.9%   5.6  245s
 4772225 3819871   36.44623   58   53   38.11553   28.63827  24.9%   5.6  250s
 4872587 3899174   34.19440   40   77   38.11553   28.65817  24.8%   5.6  255s
 4966284 3972798   31.05124   32   79   38.11553   28.67727  24.8%   5.6  260s
 5065551 4050935   34.86585   45   64   38.11553   28.69686  24.7%   5.6  265s
 5157337 4122444   32.39197   37   77   38.11553   28.71403  24.7%   5.5  270s
 5257370 4200834   29.65791   32   79   38.11553   28.73284  24.6%   5.5  275s
 5352830 4275640   37.65394   45   65   38.11553   28.75113  24.6%   5.5  280s
 5452255 4353927   36.84017   51   61   38.11553   28.76896  24.5%   5.5  285s
 5545087 4427193   32.20029   35   74   38.11553   28.78580  24.5%   5.5  290s
 5643232 4504416   29.88937   30   84   38.11553   28.80279  24.4%   5.5  295s
 5738143 4578163   35.19057   50   59   38.11553   28.81864  24.4%   5.5  300s

Explored 5738491 nodes (31775202 simplex iterations) in 300.00 seconds (505.69 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 38.1155 40.707 60 

Time limit reached
Best objective 3.811553393083e+01, best bound 2.881872797805e+01, gap 24.3911%

User-callback calls 11507671, time in user-callback 15.70 sec
--------------------------------
solve the problem in original formulation
The obj is 38.115533930827965.
The root upper bound is: 38.115533930827965, lower bound is: 15.17507029590971. The root gap is: 60.1867%. Runtime: 300.00502586364746.
[  9  27  29  37  56  78  92 102 104 113 117]
Number of outliers: 11
--------------------------------
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 840 rows, 483 columns and 2760 nonzeros
Model fingerprint: 0xfb97dba8
Model has 486 quadratic objective terms
Variable types: 123 continuous, 360 integer (360 binary)
Coefficient statistics:
  Matrix range     [6e-04, 1e+03]
  Objective range  [4e-03, 6e+01]
  QObjective range [1e-03, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-03, 1e+03]
Found heuristic solution: objective 55.7849085
Presolve time: 0.00s
Presolved: 840 rows, 483 columns, 2760 nonzeros
Presolved model has 486 quadratic objective terms
Variable types: 123 continuous, 360 integer (360 binary)

Root relaxation: objective 1.491937e+01, 1480 iterations, 0.03 seconds (0.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   14.91937    0  198   55.78491   14.91937  73.3%     -    0s
H    0     0                      38.1703745   14.91937  60.9%     -    0s
     0     0   14.91937    0  198   38.17037   14.91937  60.9%     -    0s
     0     2   15.48374    0  198   38.17037   15.48374  59.4%     -    0s
H   53    54                      38.1155339   17.20731  54.9%  22.7    0s
  5598  1651   24.67727   30  180   38.11553   20.89700  45.2%  21.3    5s
 14506  4709   36.52503   34   94   38.11553   24.32212  36.2%  21.8   10s
 29294  7987     cutoff   45        38.11553   26.70137  29.9%  22.4   15s
 43972 11245 infeasible   41        38.11553   27.68207  27.4%  22.7   20s
 55610 13249   31.40646   42  194   38.11553   28.53846  25.1%  22.8   25s
 68667 15963   29.41097   42  160   38.11553   29.14471  23.5%  22.6   30s
 81160 18009     cutoff   58        38.11553   29.64280  22.2%  22.4   35s
 95844 21204 infeasible   32        38.11553   30.03710  21.2%  22.1   40s
 110766 23839     cutoff   38        38.11553   30.37221  20.3%  21.9   45s
 125112 26643 infeasible   55        38.11553   30.69364  19.5%  21.7   50s
 134194 28174     cutoff   49        38.11553   30.95326  18.8%  21.6   55s
 147164 30404 infeasible   46        38.11553   31.24335  18.0%  21.4   60s
 159192 32766   31.50856   46  158   38.11553   31.43393  17.5%  21.3   65s
 171788 34814     cutoff   42        38.11553   31.64931  17.0%  21.1   70s
 185368 37160   36.80755   43   68   38.11553   31.80847  16.5%  21.0   75s
 197511 39346   32.07230   41  164   38.11553   32.01692  16.0%  21.0   80s
 207069 42040   32.21703   45  158   38.11553   32.15869  15.6%  20.9   85s
 222704 43705     cutoff   45        38.11553   32.33072  15.2%  20.8   90s
 236843 45085 infeasible   47        38.11553   32.49934  14.7%  20.7   95s
 248318 46835   34.08315   50  152   38.11553   32.63105  14.4%  20.6  100s
 262237 48653   37.45609   50  178   38.11553   32.74234  14.1%  20.5  105s
 275954 50565 infeasible   41        38.11553   32.84968  13.8%  20.5  110s
 287581 51975 infeasible   56        38.11553   32.95506  13.5%  20.4  115s
 297954 53673   35.18310   49  160   38.11553   33.05891  13.3%  20.4  120s
 309415 54882   34.67253   41  178   38.11553   33.14926  13.0%  20.3  125s
 322190 56347 infeasible   57        38.11553   33.22534  12.8%  20.3  130s
 334954 57715 infeasible   43        38.11553   33.30418  12.6%  20.3  135s
 342072 59529   33.38792   42  188   38.11553   33.36621  12.5%  20.2  140s
 357112 60034     cutoff   53        38.11553   33.45520  12.2%  20.2  145s
 369327 61206 infeasible   52        38.11553   33.52331  12.0%  20.2  150s
 380264 62415 infeasible   60        38.11553   33.60290  11.8%  20.1  155s
 391678 63575   37.94208   48   60   38.11553   33.68151  11.6%  20.1  160s
 401156 65450     cutoff   40        38.11553   33.74755  11.5%  20.0  165s
 415677 65821 infeasible   43        38.11553   33.82056  11.3%  20.0  170s
 426232 66646 infeasible   56        38.11553   33.88672  11.1%  20.0  175s
 439198 67769   33.96524   50  152   38.11553   33.94399  10.9%  20.0  180s
 453458 68975 infeasible   40        38.11553   34.01096  10.8%  19.9  185s
 463685 69771   34.12089   47  144   38.11553   34.07844  10.6%  19.9  190s
 475303 71339   34.60983   51  168   38.11553   34.13896  10.4%  19.9  195s
 490236 72394   34.78321   38  184   38.11553   34.20489  10.3%  19.8  200s
 504570 72475     cutoff   58        38.11553   34.26575  10.1%  19.8  205s
 518428 73418   34.81489   55  134   38.11553   34.32129  10.0%  19.8  210s
 531664 74136   38.07726   58  158   38.11553   34.37497  9.81%  19.7  215s
 545900 74880   37.20145   53  176   38.11553   34.43105  9.67%  19.7  220s
 559044 75610   34.58116   43  184   38.11553   34.48252  9.53%  19.7  225s
 574338 76291   34.77537   50  162   38.11553   34.54237  9.37%  19.6  230s
 587487 76617 infeasible   61        38.11553   34.59196  9.24%  19.6  235s
 601158 77177   37.80448   54  150   38.11553   34.65186  9.09%  19.6  240s
 617052 77711     cutoff   61        38.11553   34.71027  8.93%  19.5  245s
 632603 78298 infeasible   54        38.11553   34.76312  8.80%  19.5  250s
 647449 78770 infeasible   50        38.11553   34.81049  8.67%  19.5  255s
 662526 79066 infeasible   51        38.11553   34.86160  8.54%  19.4  260s
 669334 79346   35.00864   52  162   38.11553   34.89887  8.44%  19.4  265s
 683903 79538   34.95826   43  162   38.11553   34.94668  8.31%  19.4  270s
 697490 79446   35.30444   55  140   38.11553   34.98678  8.21%  19.3  275s
 711945 79476 infeasible   55        38.11553   35.03256  8.09%  19.3  280s
 725539 79514   35.14854   48  160   38.11553   35.07701  7.97%  19.3  285s
 739473 79265     cutoff   50        38.11553   35.12242  7.85%  19.2  290s
 753907 79239   35.60804   55  144   38.11553   35.16644  7.74%  19.2  295s
 767621 79186   35.21976   43  170   38.11553   35.20840  7.63%  19.1  300s

Explored 768805 nodes (14706472 simplex iterations) in 300.01 seconds (454.95 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 38.1155 38.1704 55.7849 

Time limit reached
Best objective 3.811553393083e+01, best bound 3.521185341913e+01, gap 7.6181%

User-callback calls 1653328, time in user-callback 2.24 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_job4.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 38.115533930827965.
The root upper bound is: 38.170374529622165, lower bound is: 15.483739405263188. The root gap is: 59.4352%. Runtime: 300.00977301597595.
--------------------------------------------------
    m    n   dataset formulation  ...     end_lb   end_gap  node_count        time
0   3   50  diabetes    original  ...  13.938979  0.000000     23088.0    0.759153
1   3   50  diabetes         opt  ...  13.938979  0.000000     12315.0    1.703157
2   3   60  diabetes    original  ...  18.798414  0.000032    578529.0   14.742751
3   3   60  diabetes         opt  ...  18.799007  0.000000     92933.0   12.593582
4   3   70  diabetes    original  ...  22.330339  0.021128   9792363.0  300.008866
5   3   70  diabetes         opt  ...  22.812316  0.000000     83232.0   16.740877
6   3   80  diabetes    original  ...  23.345721  0.103184   8870192.0  300.003117
7   3   80  diabetes         opt  ...  26.031782  0.000000    486040.0  123.883725
8   3   90  diabetes    original  ...  24.129098  0.160736   7837892.0  300.006499
9   3   90  diabetes         opt  ...  28.750312  0.000000    150897.0   41.526220
10  3  100  diabetes    original  ...  25.084457  0.199738   6956184.0  300.006834
11  3  100  diabetes         opt  ...  29.823450  0.048551    908650.0  300.005428
12  3  120  diabetes    original  ...  28.818728  0.243911   5738491.0  300.005026
13  3  120  diabetes         opt  ...  35.211853  0.076181    768805.0  300.009773

[14 rows x 12 columns]
[3, 150, 'diabetes']
[0.00173966 0.00309787 0.00420431 1.         1.        ]
The relaxed obj is 0.11972594150405769.
The larges value of x is 2.2493752891563212
Use new Big-M 4.4987505783126425.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 300 rows, 303 columns and 600 nonzeros
Model fingerprint: 0x4375c079
Model has 606 quadratic objective terms
Variable types: 153 continuous, 150 integer (150 binary)
Coefficient statistics:
  Matrix range     [1e+00, 4e+00]
  Objective range  [3e-02, 8e+01]
  QObjective range [2e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 75.0000000
Presolve time: 0.00s
Presolved: 300 rows, 303 columns, 600 nonzeros
Presolved model has 606 quadratic objective terms
Variable types: 153 continuous, 150 integer (150 binary)

Root relaxation: objective 1.952005e+01, 649 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   19.52005    0  116   75.00000   19.52005  74.0%     -    0s
H    0     0                      47.5482997   19.52005  58.9%     -    0s
H    0     0                      46.7786748   19.52005  58.3%     -    0s
H    0     0                      46.5527388   19.52005  58.1%     -    0s
H    0     0                      46.2628985   19.52005  57.8%     -    0s
     0     0   19.88134    0  116   46.26290   19.88134  57.0%     -    0s
H    0     0                      46.0503567   19.88134  56.8%     -    1s
     0     2   19.88134    0  116   46.05036   19.88134  56.8%     -    1s
 55451 47592   43.01480   56   78   46.05036   27.39798  40.5%   7.1    5s
 140824 121664   42.23090   56   77   46.05036   28.63174  37.8%   7.0   10s
 232547 200971   40.97928   52   80   46.05036   29.25921  36.5%   6.9   15s
 319485 276068   43.79090   57   74   46.05036   29.65067  35.6%   6.9   20s
 405452 350432   33.56905   32  111   46.05036   29.92410  35.0%   6.8   25s
 496850 429178   40.00697   45   93   46.05036   30.16722  34.5%   6.8   30s
 587072 506451   44.59570   66   69   46.05036   30.36878  34.1%   6.8   35s
 682063 587284   44.88696   67   67   46.05036   30.54685  33.7%   6.7   40s
 771932 663870   35.07655   32  103   46.05036   30.69478  33.3%   6.7   45s
 866423 744803   34.68608   36   98   46.05036   30.81766  33.1%   6.7   50s
 954963 820026   32.67151   30  101   46.05036   30.93057  32.8%   6.7   55s
 1048584 899777   44.68095   68   66   46.05036   31.03324  32.6%   6.6   60s
 1135634 973640   38.67053   43   90   46.05036   31.11764  32.4%   6.6   65s
 1227853 1052895   44.26466   70   64   46.05036   31.20105  32.2%   6.6   70s
 1307036 1120893   39.41222   49   81   46.05036   31.26722  32.1%   6.6   75s
 1381894 1184148     cutoff   69        46.05036   31.32637  32.0%   6.6   80s
 1457477 1248337   34.35289   34   98   46.05036   31.38534  31.8%   6.6   85s
 1525798 1306429   33.42678   34   98   46.05036   31.43684  31.7%   6.6   90s
 1597595 1367766   36.81389   40   92   46.05036   31.48571  31.6%   6.6   95s
 1669596 1428963   42.20834   61   73   46.05036   31.53286  31.5%   6.6  100s
 1737572 1486797   37.70537   43   88   46.05036   31.57485  31.4%   6.6  105s
 1811622 1549859   37.08960   39   94   46.05036   31.61920  31.3%   6.6  110s
 1877593 1605753   41.75907   55   77   46.05036   31.65552  31.3%   6.5  115s
 1952397 1668933   38.30398   38   91   46.05036   31.69618  31.2%   6.5  120s
 2025483 1730303   35.07985   37   95   46.05036   31.73517  31.1%   6.5  125s
 2092530 1788312   35.06740   34  101   46.05036   31.76784  31.0%   6.5  130s
 2164073 1848574   38.74054   42   91   46.05036   31.79986  30.9%   6.5  135s
 2239650 1912113   37.73912   39   96   46.05036   31.83688  30.9%   6.5  140s
 2304836 1967647   44.16388   64   69   46.05036   31.86306  30.8%   6.5  145s
 2377519 2029596   42.19056   59   73   46.05036   31.89445  30.7%   6.5  150s
 2450520 2091547   39.72636   45   89   46.05036   31.92522  30.7%   6.5  155s
 2518880 2149306   34.85666   31  100   46.05036   31.95221  30.6%   6.5  160s
 2589673 2208918   35.77949   35   97   46.05036   31.97910  30.6%   6.5  165s
 2659986 2267653   34.47025   36   96   46.05036   32.00392  30.5%   6.5  170s
 2732004 2329168   32.70240   31  105   46.05036   32.03055  30.4%   6.5  175s
 2806436 2391590   40.19539   54   80   46.05036   32.05804  30.4%   6.5  180s
 2871796 2447410   39.91197   48   87   46.05036   32.08041  30.3%   6.5  185s
 2945430 2509469   36.88662   40   99   46.05036   32.10663  30.3%   6.5  190s
 3017233 2570051   38.08405   37   96   46.05036   32.13058  30.2%   6.5  195s
 3084867 2627856   33.86272   32  103   46.05036   32.15318  30.2%   6.5  200s
 3158067 2690083   40.81670   52   85   46.05036   32.17667  30.1%   6.5  205s
 3234109 2754041   35.75869   36   94   46.05036   32.20142  30.1%   6.5  210s
 3297978 2808390   41.19951   48   83   46.05036   32.22071  30.0%   6.5  215s
 3371829 2871088   45.91661   84   47   46.05036   32.24282  30.0%   6.5  220s
 3444747 2933328   32.81572   32  104   46.05036   32.26338  29.9%   6.4  225s
 3515926 2992281   36.02352   37   96   46.05036   32.28475  29.9%   6.4  230s
 3585957 3052273   43.13466   57   76   46.05036   32.30377  29.9%   6.4  235s
 3658927 3114518   42.21931   51   79   46.05036   32.32362  29.8%   6.4  240s
 3726642 3171592   37.17766   39   98   46.05036   32.34155  29.8%   6.4  245s
 3801570 3234280   41.73163   57   75   46.05036   32.36103  29.7%   6.4  250s
 3869771 3291524   45.45950   66   67   46.05036   32.37796  29.7%   6.4  255s
 3940567 3352717   42.75029   56   78   46.05036   32.39503  29.7%   6.4  260s
 4015173 3415528   34.27418   33   98   46.05036   32.41423  29.6%   6.4  265s
 4081867 3471963   34.84451   37   94   46.05036   32.43026  29.6%   6.4  270s
 4155412 3534060   41.79154   50   84   46.05036   32.44646  29.5%   6.4  275s
 4227543 3595152   45.16630   64   70   46.05036   32.46278  29.5%   6.4  280s
 4296031 3653461   36.48532   40   95   46.05036   32.47820  29.5%   6.4  285s
 4371031 3717076   36.60870   37   95   46.05036   32.49570  29.4%   6.4  290s
 4437065 3772923   45.84785   66   65   46.05036   32.50988  29.4%   6.4  295s
 4510490 3833990   44.27392   62   74   46.05036   32.52627  29.4%   6.4  300s

Explored 4510660 nodes (28923574 simplex iterations) in 300.00 seconds (559.07 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 46.0504 46.2629 46.5527 ... 75

Time limit reached
Best objective 4.605035671449e+01, best bound 3.252628153377e+01, gap 29.3680%

User-callback calls 9052401, time in user-callback 12.01 sec
--------------------------------
solve the problem in original formulation
The obj is 46.050356714487606.
The root upper bound is: 46.050356714487606, lower bound is: 19.881341481516582. The root gap is: 56.827%. Runtime: 300.0048999786377.
[ 27  29  56  78  92 104 113 117 134 143 147]
Number of outliers: 11
--------------------------------
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 1050 rows, 603 columns and 3450 nonzeros
Model fingerprint: 0x366ebfa0
Model has 606 quadratic objective terms
Variable types: 153 continuous, 450 integer (450 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+03]
  Objective range  [3e-02, 8e+01]
  QObjective range [2e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-02, 1e+03]
Found heuristic solution: objective 69.6241184
Presolve time: 0.00s
Presolved: 1050 rows, 603 columns, 3450 nonzeros
Presolved model has 606 quadratic objective terms
Variable types: 153 continuous, 450 integer (450 binary)

Root relaxation: objective 1.952005e+01, 1615 iterations, 0.04 seconds (0.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   19.52005    0  232   69.62412   19.52005  72.0%     -    0s
H    0     0                      46.4024946   19.52005  57.9%     -    0s
H    0     0                      46.3315373   19.52005  57.9%     -    0s
H    0     0                      46.2123745   19.52005  57.8%     -    0s
     0     0   19.52005    0  232   46.21237   19.52005  57.8%     -    0s
H    0     0                      46.0503567   19.52005  57.6%     -    0s
     0     2   19.52005    0  232   46.05036   19.52005  57.6%     -    0s
  4072  1338     cutoff   52        46.05036   24.76393  46.2%  24.6    5s
  9605  3562   27.90387   22  242   46.05036   26.38187  42.7%  25.2   10s
 17828  6393 infeasible   31        46.05036   27.52353  40.2%  25.9   15s
 24901  8819     cutoff   21        46.05036   28.30728  38.5%  26.9   20s
 37393 12510 infeasible   36        46.05036   29.05639  36.9%  27.4   25s
 44359 16097 infeasible   26        46.05036   29.56511  35.8%  27.7   30s
 54950 17406 infeasible   30        46.05036   30.05414  34.7%  28.1   35s
 67465 20509   32.13546   36  212   46.05036   30.44182  33.9%  28.3   40s
 74189 22422     cutoff   33        46.05036   30.67272  33.4%  28.3   45s
 84831 24647     cutoff   36        46.05036   31.01020  32.7%  28.3   50s
 96551 27493 infeasible   39        46.05036   31.31819  32.0%  28.0   55s
 106718 30032     cutoff   42        46.05036   31.57744  31.4%  27.8   60s
 116850 32800     cutoff   46        46.05036   31.81349  30.9%  27.6   65s
 127299 35192 infeasible   43        46.05036   32.04142  30.4%  27.5   70s
 137027 38037   33.48415   32  212   46.05036   32.23009  30.0%  27.3   75s
 144829 40006   33.71591   40  236   46.05036   32.36446  29.7%  27.1   80s
 148621 43046   34.16993   37  212   46.05036   32.42448  29.6%  27.1   85s
 161729 44282 infeasible   42        46.05036   32.60675  29.2%  26.8   90s
 170496 46796     cutoff   60        46.05036   32.75001  28.9%  26.6   95s
 177809 48712   33.54369   40  220   46.05036   32.85972  28.6%  26.5  100s
 186909 50722     cutoff   47        46.05036   32.96004  28.4%  26.4  105s
 193564 54626   35.10671   31  232   46.05036   33.06041  28.2%  26.4  110s
 204816 55595   34.94609   32  244   46.05036   33.17809  28.0%  26.2  115s
 216856 58515   33.37111   31  236   46.05036   33.31401  27.7%  26.0  120s
 223489 60217     cutoff   60        46.05036   33.40073  27.5%  26.0  125s
 232705 62625   38.55223   51  220   46.05036   33.50027  27.3%  25.8  130s
 238689 66081   34.72886   36  234   46.05036   33.58184  27.1%  25.8  136s
 248475 66321     cutoff   47        46.05036   33.67108  26.9%  25.7  140s
 253819 69909   39.85531   42  232   46.05036   33.74847  26.7%  25.7  145s
 265714 70931 infeasible   47        46.05036   33.86491  26.5%  25.5  150s
 277114 74119 infeasible   47        46.05036   33.96813  26.2%  25.3  155s
 282664 75736   36.34243   43  154   46.05036   34.03201  26.1%  25.3  160s
 292471 78167     cutoff   40        46.05036   34.11239  25.9%  25.2  165s
 300304 80361     cutoff   37        46.05036   34.19478  25.7%  25.1  170s
 308460 82356   37.16010   46  230   46.05036   34.26761  25.6%  25.0  175s
 313112 85688   34.35568   38  166   46.05036   34.31267  25.5%  25.0  180s
 325017 86471 infeasible   57        46.05036   34.39491  25.3%  24.9  185s
 336057 89420 infeasible   45        46.05036   34.47724  25.1%  24.7  190s
 341551 90746 infeasible   44        46.05036   34.52223  25.0%  24.7  195s
 350761 93434   36.65088   45  210   46.05036   34.59546  24.9%  24.6  200s
 357532 97355   35.10590   35  238   46.05036   34.64730  24.8%  24.6  206s
 368897 98150 infeasible   47        46.05036   34.71070  24.6%  24.5  210s
 377187 100501     cutoff   42        46.05036   34.76611  24.5%  24.4  215s
 384534 102495 infeasible   52        46.05036   34.81653  24.4%  24.3  220s
 395637 105591   34.92142   39  240   46.05036   34.88103  24.3%  24.2  225s
 404616 108149     cutoff   39        46.05036   34.93461  24.1%  24.1  230s
 412091 110160   35.17971   43  196   46.05036   34.97956  24.0%  24.1  235s
 425439 113502   45.61937   52  202   46.05036   35.04271  23.9%  24.0  240s
 429957 115028   35.16220   39  234   46.05036   35.06750  23.8%  24.0  245s
 440399 117699 infeasible   44        46.05036   35.11764  23.7%  23.9  250s
 447074 121850   36.29875   48  222   46.05036   35.16010  23.6%  23.9  256s
 456479 122381 infeasible   37        46.05036   35.20081  23.6%  23.8  260s
 469843 126016     cutoff   38        46.05036   35.25980  23.4%  23.7  265s
 474726 127554   37.73338   45  212   46.05036   35.28314  23.4%  23.7  270s
 485246 130253 infeasible   46        46.05036   35.32637  23.3%  23.6  275s
 492273 134461   35.98356   37  236   46.05036   35.36137  23.2%  23.6  280s
 504682 135638     cutoff   44        46.05036   35.40644  23.1%  23.5  285s
 513306 137914     cutoff   45        46.05036   35.44591  23.0%  23.5  290s
 521301 140011 infeasible   44        46.05036   35.48044  23.0%  23.4  295s
 530516 142435     cutoff   51        46.05036   35.51251  22.9%  23.4  300s

Explored 530527 nodes (12406283 simplex iterations) in 300.00 seconds (414.29 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 46.0504 46.2124 46.3315 ... 69.6241

Time limit reached
Best objective 4.605035671449e+01, best bound 3.551251008547e+01, gap 22.8833%

User-callback calls 1173199, time in user-callback 1.75 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_job4.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 46.05035671448759.
The root upper bound is: 46.05035671448759, lower bound is: 19.520052991577167. The root gap is: 57.6115%. Runtime: 300.00438499450684.
--------------------------------------------------
    m    n   dataset formulation  ...     end_lb   end_gap  node_count        time
0   3   50  diabetes    original  ...  13.938979  0.000000     23088.0    0.759153
1   3   50  diabetes         opt  ...  13.938979  0.000000     12315.0    1.703157
2   3   60  diabetes    original  ...  18.798414  0.000032    578529.0   14.742751
3   3   60  diabetes         opt  ...  18.799007  0.000000     92933.0   12.593582
4   3   70  diabetes    original  ...  22.330339  0.021128   9792363.0  300.008866
5   3   70  diabetes         opt  ...  22.812316  0.000000     83232.0   16.740877
6   3   80  diabetes    original  ...  23.345721  0.103184   8870192.0  300.003117
7   3   80  diabetes         opt  ...  26.031782  0.000000    486040.0  123.883725
8   3   90  diabetes    original  ...  24.129098  0.160736   7837892.0  300.006499
9   3   90  diabetes         opt  ...  28.750312  0.000000    150897.0   41.526220
10  3  100  diabetes    original  ...  25.084457  0.199738   6956184.0  300.006834
11  3  100  diabetes         opt  ...  29.823450  0.048551    908650.0  300.005428
12  3  120  diabetes    original  ...  28.818728  0.243911   5738491.0  300.005026
13  3  120  diabetes         opt  ...  35.211853  0.076181    768805.0  300.009773
14  3  150  diabetes    original  ...  32.526282  0.293680   4510660.0  300.004900
15  3  150  diabetes         opt  ...  35.512510  0.228833    530527.0  300.004385

[16 rows x 12 columns]
[3, 200, 'diabetes']
[0.00136383 0.00237325 0.00280986 1.         1.        ]
The relaxed obj is 0.1576748103414758.
The larges value of x is 2.126499078140531
Use new Big-M 4.252998156281062.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 400 rows, 403 columns and 800 nonzeros
Model fingerprint: 0x2b7ba15d
Model has 806 quadratic objective terms
Variable types: 203 continuous, 200 integer (200 binary)
Coefficient statistics:
  Matrix range     [1e+00, 4e+00]
  Objective range  [4e-02, 1e+02]
  QObjective range [2e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 100.0000000
Presolve time: 0.00s
Presolved: 400 rows, 403 columns, 800 nonzeros
Presolved model has 806 quadratic objective terms
Variable types: 203 continuous, 200 integer (200 binary)

Root relaxation: objective 2.638911e+01, 795 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   26.38911    0  152  100.00000   26.38911  73.6%     -    0s
H    0     0                      60.7478050   26.38911  56.6%     -    0s
H    0     0                      59.5065696   26.38911  55.7%     -    0s
H    0     0                      59.3035353   26.38911  55.5%     -    0s
H    0     0                      58.9898661   26.38911  55.3%     -    0s
     0     0   26.69543    0  152   58.98987   26.69543  54.7%     -    0s
H    0     0                      58.9855099   26.69543  54.7%     -    0s
     0     2   26.69543    0  152   58.98551   26.69543  54.7%     -    0s
H 1484  1306                      58.8823608   28.98793  50.8%   6.7    0s
 35783 31583   52.55682   63  102   58.88236   33.57205  43.0%   7.4    5s
 83207 74504   57.64131   88   75   58.88236   34.82139  40.9%   7.3   10s
 134704 120407   55.31610   63  106   58.88236   35.48645  39.7%   7.1   15s
 189783 169544   36.66049   25  144   58.88236   35.97976  38.9%   7.0   20s
 239205 213009   49.19880   46  123   58.88236   36.28958  38.4%   7.0   25s
 291344 260131   53.38377   63  108   58.88236   36.55537  37.9%   7.0   30s
 346224 309606   57.43514   71   97   58.88236   36.77388  37.5%   7.0   35s
 403145 359983   49.43981   48  126   58.88236   36.96544  37.2%   6.9   40s
 451226 402587   58.68926   85   86   58.88236   37.10606  37.0%   6.9   45s
 504642 450204   48.00173   48  120   58.88236   37.24603  36.7%   6.9   50s
 559580 498767   52.08868   60  105   58.88236   37.36270  36.5%   6.9   55s
 612181 545546   46.59096   45  120   58.88236   37.46685  36.4%   6.9   60s
 657596 585742   43.92603   37  129   58.88236   37.54098  36.2%   6.9   65s
 714354 636165   58.61146   76   89   58.88236   37.64378  36.1%   6.9   70s
 767313 683116   52.26483   63  101   58.88236   37.72340  35.9%   6.8   75s
 820885 731220   52.38051   58  107   58.88236   37.80084  35.8%   6.8   80s
 868587 772779   39.90701   29  135   58.88236   37.86691  35.7%   6.8   85s
 923626 821577   56.99279   70   94   58.88236   37.93817  35.6%   6.8   90s
 978621 870788   49.06084   44  123   58.88236   38.00168  35.5%   6.8   95s
 1027642 914239   50.07391   52  113   58.88236   38.06059  35.4%   6.8  100s
 1079675 960241   40.38174   24  149   58.88236   38.11435  35.3%   6.8  105s
 1134077 1008410   58.73526   78   89   58.88236   38.17291  35.2%   6.8  110s
 1184451 1052972   56.02865   82   82   58.88236   38.22158  35.1%   6.8  115s
 1240154 1102078   44.96157   35  139   58.88236   38.27377  35.0%   6.8  120s
 1293219 1149374   43.26204   34  130   58.88236   38.31985  34.9%   6.8  125s
 1347691 1197469   46.06463   40  127   58.88236   38.36297  34.8%   6.8  130s
 1398538 1242326   45.92710   42  124   58.88236   38.40656  34.8%   6.8  135s
 1453851 1291227   42.25899   30  148   58.88236   38.44751  34.7%   6.8  140s
 1507885 1339301   54.78024   60  105   58.88236   38.48806  34.6%   6.8  145s
 1559209 1385015   43.27633   40  122   58.88236   38.52211  34.6%   6.8  150s
 1606744 1427177   43.70413   38  126   58.88236   38.55502  34.5%   6.8  155s
 1663821 1477827   42.38757   33  129   58.88236   38.59727  34.5%   6.8  160s
 1717927 1525657   52.54911   61  107   58.88236   38.63275  34.4%   6.8  165s
 1766728 1568644   58.31588   82   81   58.88236   38.66559  34.3%   6.8  170s
 1820220 1616310   54.70199   65  100   58.88236   38.69508  34.3%   6.8  175s
 1878074 1666716   42.07536   30  137   58.88236   38.73076  34.2%   6.8  180s
 1931498 1714220   50.59141   50  114   58.88236   38.76124  34.2%   6.8  185s
 1979404 1756276   43.23750   37  126   58.88236   38.78673  34.1%   6.8  190s
 2034446 1805209   45.77744   42  130   58.88236   38.81464  34.1%   6.8  195s
 2091176 1854939   42.77834   33  137   58.88236   38.84197  34.0%   6.8  200s
 2139869 1898301   55.52070   65   98   58.88236   38.86752  34.0%   6.8  205s
 2194327 1946847   57.72456   77   92   58.88236   38.89572  33.9%   6.8  210s
 2248323 1994751   39.94768   27  139   58.88236   38.92251  33.9%   6.8  215s
 2303720 2043405   44.86221   37  134   58.88236   38.94844  33.9%   6.8  220s
 2354925 2088917   40.77135   29  145   58.88236   38.97311  33.8%   6.7  225s
 2410795 2138344   49.04854   43  120   58.88236   38.99885  33.8%   6.7  230s
 2465832 2187054   50.79362   54  111   58.88236   39.02404  33.7%   6.7  235s
 2515350 2230743   49.82283   51  112   58.88236   39.04578  33.7%   6.7  240s
 2570097 2278998   51.85074   65  100   58.88236   39.06937  33.6%   6.7  245s
 2626786 2329103   40.35994   30  133   58.88236   39.09446  33.6%   6.7  250s
 2680125 2376638   45.49850   42  119   58.88236   39.11525  33.6%   6.7  255s
 2734207 2423258   48.77434   50  113   58.88236   39.13806  33.5%   6.7  260s
 2788410 2472179   39.16983   30  135   58.88236   39.15881  33.5%   6.7  265s
 2844703 2521690   41.80634   36  129   58.88236   39.17968  33.5%   6.7  270s
 2899476 2570098   46.79522   42  131   58.88236   39.19883  33.4%   6.7  275s
 2948112 2613622   49.26849   55  111   58.88236   39.21639  33.4%   6.7  280s
 3005424 2663948   43.54122   31  138   58.88236   39.23803  33.4%   6.7  285s
 3062785 2714524   39.37394   29  136   58.88236   39.25983  33.3%   6.7  290s
 3113525 2759038   58.41868   89   82   58.88236   39.27726  33.3%   6.7  295s
 3168288 2807034   43.79608   39  123   58.88236   39.29589  33.3%   6.7  300s

Explored 3168525 nodes (21321100 simplex iterations) in 300.00 seconds (599.09 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 58.8824 58.9855 58.9899 ... 100

Time limit reached
Best objective 5.888236077548e+01, best bound 3.929589056037e+01, gap 33.2637%

User-callback calls 6367143, time in user-callback 9.11 sec
--------------------------------
solve the problem in original formulation
The obj is 58.88236077547572.
The root upper bound is: 58.98550987252799, lower bound is: 26.695434794685365. The root gap is: 54.7424%. Runtime: 300.0050880908966.
[  9  27  29  37  56  78  92 102 104 113 117 141 147 152 156 190]
Number of outliers: 16
--------------------------------
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 1400 rows, 803 columns and 4600 nonzeros
Model fingerprint: 0x1960232b
Model has 806 quadratic objective terms
Variable types: 203 continuous, 600 integer (600 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+03]
  Objective range  [4e-02, 1e+02]
  QObjective range [2e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-03, 1e+03]
Found heuristic solution: objective 88.2752568
Presolve time: 0.01s
Presolved: 1400 rows, 803 columns, 4600 nonzeros
Presolved model has 806 quadratic objective terms
Variable types: 203 continuous, 600 integer (600 binary)

Root relaxation: objective 2.638911e+01, 2343 iterations, 0.06 seconds (0.12 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   26.38911    0  304   88.27526   26.38911  70.1%     -    0s
H    0     0                      68.4087441   26.38911  61.4%     -    0s
H    0     0                      59.0075223   26.38911  55.3%     -    0s
     0     0   26.38911    0  304   59.00752   26.38911  55.3%     -    0s
H    0     0                      58.8823608   26.38911  55.2%     -    0s
     0     2   26.38911    0  304   58.88236   26.38911  55.2%     -    0s
  2134  1208   32.91659   23  306   58.88236   30.47927  48.2%  22.5    5s
  4386  1752   39.04068   19  336   58.88236   31.79720  46.0%  24.2   10s
  8713  3911   46.36750   37  314   58.88236   33.30351  43.4%  24.5   15s
 13005  5880   37.12715   31  328   58.88236   34.05437  42.2%  26.3   20s
 18688  8645   36.03292   32  280   58.88236   34.82023  40.9%  26.4   25s
 24382 11495   50.06442   29  322   58.88236   35.50394  39.7%  26.6   30s
 29256 13217 infeasible   49        58.88236   35.97811  38.9%  28.0   35s
 33452 15259   37.35774   34  286   58.88236   36.39240  38.2%  28.3   40s
 38323 16805 infeasible   49        58.88236   36.76210  37.6%  29.0   46s
 41899 18125 infeasible   41        58.88236   37.03209  37.1%  30.0   50s
 47086 20047 infeasible   36        58.88236   37.41081  36.5%  30.6   55s
 51508 21698     cutoff   31        58.88236   37.66172  36.0%  31.1   60s
 56861 23587 infeasible   34        58.88236   37.98206  35.5%  31.6   65s
 60407 25189   38.65932   36  278   58.88236   38.19356  35.1%  32.0   70s
 65807 26690 infeasible   35        58.88236   38.43227  34.7%  32.2   75s
 69688 27890     cutoff   47        58.88236   38.62052  34.4%  32.6   80s
 73663 32136   39.04169   38  282   58.88236   38.80457  34.1%  33.0   88s
 81713 32087 infeasible   39        58.88236   39.05881  33.7%  33.4   90s
 84103 32752 infeasible   49        58.88236   39.12646  33.6%  33.7   95s
 88626 34152 infeasible   39        58.88236   39.28996  33.3%  33.9  101s
 96788 36781 infeasible   38        58.88236   39.48145  32.9%  34.4  105s
 97920 37427     cutoff   34        58.88236   39.53235  32.9%  34.5  110s
 101762 38638   40.26548   29  296   58.88236   39.63408  32.7%  34.7  115s
 105701 39558     cutoff   63        58.88236   39.73021  32.5%  34.9  120s
 109424 41221   43.24804   37  280   58.88236   39.83910  32.3%  35.1  125s
 114112 42712   44.05677   43  290   58.88236   39.93706  32.2%  35.1  130s
 117199 43624   40.49616   40  280   58.88236   40.01713  32.0%  35.3  135s
 118360 46037     cutoff   40        58.88236   40.04186  32.0%  35.3  143s
 126431 45942 infeasible   40        58.88236   40.17647  31.8%  35.6  145s
 128214 46688   40.34308   40  276   58.88236   40.23439  31.7%  35.7  150s
 131552 47805     cutoff   42        58.88236   40.30663  31.5%  35.8  155s
 132843 50390     cutoff   35        58.88236   40.33346  31.5%  35.9  163s
 140901 50311     cutoff   41        58.88236   40.46264  31.3%  36.0  165s
 143590 50971 infeasible   47        58.88236   40.52594  31.2%  36.2  170s
 146898 51930 infeasible   44        58.88236   40.59612  31.1%  36.3  175s
 148369 55039     cutoff   41        58.88236   40.64141  31.0%  36.4  181s
 156507 54954   52.52862   37  244   58.88236   40.75092  30.8%  36.4  185s
 158673 55528   58.69888   39  308   58.88236   40.81084  30.7%  36.4  190s
 163231 56955     cutoff   46        58.88236   40.87902  30.6%  36.4  195s
 171358 59553     cutoff   38        58.88236   40.97651  30.4%  36.4  200s
 172502 59828   46.66470   49  280   58.88236   41.00854  30.4%  36.5  205s
 175039 60796   41.58849   41  280   58.88236   41.05507  30.3%  36.6  210s
 178201 63302   41.18506   26  318   58.88236   41.11154  30.2%  36.6  221s
 185755 63217 infeasible   41        58.88236   41.20186  30.0%  36.9  225s
 190551 64559 infeasible   37        58.88236   41.27774  29.9%  36.9  230s
 193143 67482   54.76263   30  196   58.88236   41.32654  29.8%  37.0  241s
 201189 67352 infeasible   42        58.88236   41.40638  29.7%  37.2  245s
 205354 68577 infeasible   48        58.88236   41.46260  29.6%  37.2  250s
 207867 71195   41.56837   41  286   58.88236   41.51098  29.5%  37.3  262s
 215460 71090   52.22148   33  266   58.88236   41.58293  29.4%  37.4  266s
 218684 71945 infeasible   41        58.88236   41.62072  29.3%  37.4  270s
 223920 73496 infeasible   36        58.88236   41.68256  29.2%  37.5  275s
 226439 74359   42.36854   41  272   58.88236   41.71619  29.2%  37.5  280s
 229713 75244   42.22001   41  282   58.88236   41.74901  29.1%  37.6  285s
 233837 76015     cutoff   48        58.88236   41.79648  29.0%  37.7  290s
 237334 79312   42.23503   38  290   58.88236   41.84349  28.9%  37.8  297s
 245437 79215 infeasible   42        58.88236   41.90741  28.8%  37.9  300s

Explored 245452 nodes (9307599 simplex iterations) in 300.00 seconds (412.02 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 58.8824 59.0075 68.4087 88.2753 

Time limit reached
Best objective 5.888236077548e+01, best bound 4.190778414048e+01, gap 28.8279%

User-callback calls 597502, time in user-callback 1.06 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 58.88236077547569.
The root upper bound is: 58.88236077547569, lower bound is: 26.38911322198942. The root gap is: 55.1833%. Runtime: 300.0054450035095.
--------------------------------------------------
    m    n   dataset formulation  ...     end_lb   end_gap  node_count        time
0   3   50  diabetes    original  ...  13.938979  0.000000     23088.0    0.759153
1   3   50  diabetes         opt  ...  13.938979  0.000000     12315.0    1.703157
2   3   60  diabetes    original  ...  18.798414  0.000032    578529.0   14.742751
3   3   60  diabetes         opt  ...  18.799007  0.000000     92933.0   12.593582
4   3   70  diabetes    original  ...  22.330339  0.021128   9792363.0  300.008866
5   3   70  diabetes         opt  ...  22.812316  0.000000     83232.0   16.740877
6   3   80  diabetes    original  ...  23.345721  0.103184   8870192.0  300.003117
7   3   80  diabetes         opt  ...  26.031782  0.000000    486040.0  123.883725
8   3   90  diabetes    original  ...  24.129098  0.160736   7837892.0  300.006499
9   3   90  diabetes         opt  ...  28.750312  0.000000    150897.0   41.526220
10  3  100  diabetes    original  ...  25.084457  0.199738   6956184.0  300.006834
11  3  100  diabetes         opt  ...  29.823450  0.048551    908650.0  300.005428
12  3  120  diabetes    original  ...  28.818728  0.243911   5738491.0  300.005026
13  3  120  diabetes         opt  ...  35.211853  0.076181    768805.0  300.009773
14  3  150  diabetes    original  ...  32.526282  0.293680   4510660.0  300.004900
15  3  150  diabetes         opt  ...  35.512510  0.228833    530527.0  300.004385
16  3  200  diabetes    original  ...  39.295891  0.332637   3168525.0  300.005088
17  3  200  diabetes         opt  ...  41.907784  0.288279    245452.0  300.005445

[18 rows x 12 columns]
