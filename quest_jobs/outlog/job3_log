[3, 50, 'autompg']
[0.00590211 0.00739742 0.01237278 1.         1.        ]
Set parameter TokenServer to value "questlicense2.quest.northwestern.edu"
/gpfs/projects/p32811/QP_indicator/experiments/Run_test_job3.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
The relaxed obj is 0.04027515330811937.
The larges value of x is 1.9470711486023513
Use new Big-M 3.8941422972047026.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 100 rows, 103 columns and 200 nonzeros
Model fingerprint: 0x9cf75adb
Model has 206 quadratic objective terms
Variable types: 53 continuous, 50 integer (50 binary)
Coefficient statistics:
  Matrix range     [1e+00, 4e+00]
  Objective range  [4e-03, 3e+01]
  QObjective range [7e-02, 5e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 25.0000000
Presolve time: 0.00s
Presolved: 100 rows, 103 columns, 200 nonzeros
Presolved model has 206 quadratic objective terms
Variable types: 53 continuous, 50 integer (50 binary)

Root relaxation: objective 4.837058e+00, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    4.83706    0   29   25.00000    4.83706  80.7%     -    0s
H    0     0                       9.0978612    4.83706  46.8%     -    0s
H    0     0                       9.0515609    4.83706  46.6%     -    0s
     0     0    4.83706    0   29    9.05156    4.83706  46.6%     -    0s
H    0     0                       9.0480644    4.83706  46.5%     -    0s
     0     2    4.83706    0   29    9.04806    4.83706  46.5%     -    0s

Explored 165 nodes (1479 simplex iterations) in 0.10 seconds (0.03 work units)
Thread count was 8 (of 52 available processors)

Solution count 2: 9.04806 25 

Optimal solution found (tolerance 1.00e-04)
Best objective 9.048064400493e+00, best bound 9.048064400493e+00, gap 0.0000%

User-callback calls 573, time in user-callback 0.00 sec
--------------------------------
solve the problem in original formulation
The obj is 9.048064400492706.
The root upper bound is: 9.048064400492706, lower bound is: 4.837057685480424. The root gap is: 46.5404%. Runtime: 0.0962519645690918.
[25 26 28 30 32]
Number of outliers: 5
--------------------------------
The decomposition time is 0.05512598715722561.
Optimal value: 1.7635583737926879
The decomposition time is 0.038082160986959934.
Optimal value: 0.5420560750576873
The decomposition time is 0.04603109695017338.
Optimal value: 6.6638878417868135
The best pair is: [[1, 2]]
------------------------
The decomposition time is 0.04353011306375265.
Optimal value: 6.6638878417868135
4.837065405820798
6.22265394565704
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 100 rows, 104 columns and 200 nonzeros
Model fingerprint: 0xe0e9e0a2
Model has 206 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 54 continuous, 50 integer (50 binary)
Coefficient statistics:
  Matrix range     [1e+00, 4e+00]
  QMatrix range    [1e-08, 4e+00]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [4e-03, 3e+01]
  QObjective range [7e-02, 5e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 25.0000000
Warning: diagonal adjustment of 1.7e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 100 rows, 104 columns, 200 nonzeros
Presolved model has 206 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 54 continuous, 50 integer (50 binary)

Root relaxation: objective -6.302483e+00, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   -6.30248    0   22   25.00000   -6.30248   125%     -    0s
H    0     0                      12.8950949   -6.30248   149%     -    0s
H    0     0                      12.8950741   -6.30248   149%     -    0s
     0     0    2.83116    0   27   12.89507    2.83116  78.0%     -    0s
H    0     0                      11.0510308    2.83116  74.4%     -    0s
H    0     0                       9.8331245    2.83116  71.2%     -    0s
     0     0    3.87945    0   28    9.83312    3.87945  60.5%     -    0s
H    0     0                       9.8331222    3.87945  60.5%     -    0s
     0     0    3.95702    0   29    9.83312    3.95702  59.8%     -    0s
     0     0    4.40816    0   28    9.83312    4.40816  55.2%     -    0s
     0     0    4.56067    0   28    9.83312    4.56067  53.6%     -    0s
     0     0    4.59598    0   27    9.83312    4.59598  53.3%     -    0s
     0     0    4.66294    0   28    9.83312    4.66294  52.6%     -    0s
     0     0    4.70788    0   29    9.83312    4.70788  52.1%     -    0s
     0     0    4.73203    0   29    9.83312    4.73203  51.9%     -    0s
     0     0    4.79966    0   28    9.83312    4.79966  51.2%     -    0s
     0     0    4.81124    0   29    9.83312    4.81124  51.1%     -    0s
     0     0    4.82453    0   29    9.83312    4.82453  50.9%     -    0s
H    0     0                       9.0480698    4.82453  46.7%     -    0s
     0     2    5.01240    0   29    9.04807    5.01240  44.6%     -    0s
H   31    33                       9.0480645    6.60520  27.0%   7.8    0s

Explored 680 nodes (3351 simplex iterations) in 0.18 seconds (0.10 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 9.04806 9.83312 11.051 ... 25

Optimal solution found (tolerance 1.00e-04)
Best objective 9.048064546434e+00, best bound 9.047725748777e+00, gap 0.0037%

User-callback calls 1720, time in user-callback 0.00 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation without cut
The obj is 9.04806454643395.
The root upper bound is: 9.048069810131908, lower bound is: 5.012402614098043. The root gap is: 44.6025%. Runtime: 0.17971086502075195.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 101 rows, 104 columns and 303 nonzeros
Model fingerprint: 0x18d9e9cf
Model has 206 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 54 continuous, 50 integer (50 binary)
Coefficient statistics:
  Matrix range     [1e-02, 5e+00]
  QMatrix range    [1e-08, 4e+00]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [4e-03, 3e+01]
  QObjective range [7e-02, 5e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e+00, 2e+00]
Found heuristic solution: objective 25.0000000
Warning: diagonal adjustment of 1.7e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 101 rows, 104 columns, 303 nonzeros
Presolved model has 206 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 54 continuous, 50 integer (50 binary)

Root relaxation: objective 6.222652e+00, 284 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    6.22265    0   28   25.00000    6.22265  75.1%     -    0s
H    0     0                      11.0510315    6.22265  43.7%     -    0s
     0     0    6.22265    0   28   11.05103    6.22265  43.7%     -    0s
H    0     0                       9.2182685    6.22265  32.5%     -    0s
H    0     0                       9.0480660    6.22265  31.2%     -    0s
H    0     0                       9.0480650    6.22265  31.2%     -    0s
H    0     2                       9.0480650    6.22265  31.2%     -    0s
     0     2    6.22265    0   28    9.04807    6.22265  31.2%     -    0s
H   66    44                       9.0480650    6.64111  26.6%  13.0    0s
H   79    50                       9.0480634    6.64111  26.6%  12.6    0s
H   85    50                       9.0480628    6.64111  26.6%  12.1    0s

Explored 766 nodes (4753 simplex iterations) in 0.14 seconds (0.06 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 9.04806 9.21827 11.051 25 

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (1.9723e-06) exceeds tolerance
Best objective 9.048062826452e+00, best bound 9.047966442773e+00, gap 0.0011%

User-callback calls 1818, time in user-callback 0.00 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_test_job3.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
9.048062826451911
The root upper bound is: 9.048065030229553, lower bound is: 6.222652416099038. The root gap is: 31.2267%. Runtime: 0.14255094528198242.
--------------------------------------------------
   m   n  dataset formulation  ...    end_lb   end_gap  node_count      time
0  3  50  autompg    original  ...  9.048064  0.000000       165.0  0.096252
1  3  50  autompg      no_cut  ...  9.047726  0.000037       680.0  0.179711
2  3  50  autompg         cut  ...  9.047966  0.000011       766.0  0.142551

[3 rows x 12 columns]
[3, 60, 'autompg']
[0.00392601 0.00767025 0.01327101 1.         1.        ]
The relaxed obj is 0.048373710565872585.
The larges value of x is 2.285081900100683
Use new Big-M 4.570163800201366.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 120 rows, 123 columns and 240 nonzeros
Model fingerprint: 0x8a38515f
Model has 246 quadratic objective terms
Variable types: 63 continuous, 60 integer (60 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [1e-01, 4e+01]
  QObjective range [1e-01, 6e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 30.0000000
Presolve time: 0.00s
Presolved: 120 rows, 123 columns, 240 nonzeros
Presolved model has 246 quadratic objective terms
Variable types: 63 continuous, 60 integer (60 binary)

Root relaxation: objective 4.614281e+00, 276 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    4.61428    0   35   30.00000    4.61428  84.6%     -    0s
H    0     0                      10.8845295    4.61428  57.6%     -    0s
H    0     0                      10.7488678    4.61428  57.1%     -    0s
H    0     0                      10.6750775    4.61428  56.8%     -    0s
H    0     0                      10.5510912    4.61428  56.3%     -    0s
H    0     0                      10.5026218    4.61428  56.1%     -    0s
     0     0    4.83798    0   35   10.50262    4.83798  53.9%     -    0s
     0     2    4.83798    0   35   10.50262    4.83798  53.9%     -    0s

Explored 1760 nodes (9416 simplex iterations) in 0.18 seconds (0.09 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 10.5026 10.7489 10.8845 30 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.050262184474e+01, best bound 1.050262184474e+01, gap 0.0000%

User-callback calls 3807, time in user-callback 0.01 sec
--------------------------------
solve the problem in original formulation
The obj is 10.50262184474414.
The root upper bound is: 10.50262184474414, lower bound is: 4.837978606205795. The root gap is: 53.9355%. Runtime: 0.17731904983520508.
[28 30 54]
Number of outliers: 3
--------------------------------
The decomposition time is 0.060372503474354744.
Optimal value: 1.1516408927422321
The decomposition time is 0.054613844491541386.
Optimal value: 0.8402135871690515
The decomposition time is 0.06249802093952894.
Optimal value: 9.77962911713393
The best pair is: [[1, 2]]
------------------------
The decomposition time is 0.06021458748728037.
Optimal value: 9.77962911713393
4.614291882815998
5.660331741394316
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 120 rows, 124 columns and 240 nonzeros
Model fingerprint: 0x741b52d2
Model has 246 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 64 continuous, 60 integer (60 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  QMatrix range    [8e-09, 9e+00]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [1e-01, 4e+01]
  QObjective range [1e-01, 6e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 30.0000000
Warning: diagonal adjustment of 4.5e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 120 rows, 124 columns, 240 nonzeros
Presolved model has 246 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 64 continuous, 60 integer (60 binary)

Root relaxation: objective -9.921151e+00, 279 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   -9.92115    0   39   30.00000   -9.92115   133%     -    0s
H    0     0                      13.7803766   -9.92115   172%     -    0s
H    0     0                      13.7803762   -9.92115   172%     -    0s
     0     0    3.27830    0   35   13.78038    3.27830  76.2%     -    0s
H    0     0                      11.4630329    3.27830  71.4%     -    0s
H    0     0                      10.5026236    3.27830  68.8%     -    0s
     0     0    3.75248    0   34   10.50262    3.75248  64.3%     -    0s
     0     0    4.26050    0   34   10.50262    4.26050  59.4%     -    0s
H    0     0                      10.5026174    4.26050  59.4%     -    0s
     0     0    4.46553    0   34   10.50262    4.46553  57.5%     -    0s
     0     0    4.51144    0   34   10.50262    4.51144  57.0%     -    0s
     0     0    4.56392    0   34   10.50262    4.56392  56.5%     -    0s
     0     0    4.58479    0   35   10.50262    4.58479  56.3%     -    0s
     0     2    4.58479    0   35   10.50262    4.58479  56.3%     -    0s
H  468   278                      10.5026173    7.71982  26.5%   4.1    0s
H 2406   597                      10.5026166    9.01505  14.2%   6.1    0s

Explored 4511 nodes (28616 simplex iterations) in 0.50 seconds (0.39 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 10.5026 11.463 13.7804 

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (6.1195e-06) exceeds tolerance
Best objective 1.050261659433e+01, best bound 1.050252086992e+01, gap 0.0009%

User-callback calls 9571, time in user-callback 0.01 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation without cut
The obj is 10.502616594331638.
The root upper bound is: 10.502617449193963, lower bound is: 4.58478707640122. The root gap is: 56.3462%. Runtime: 0.5038590431213379.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 121 rows, 124 columns and 363 nonzeros
Model fingerprint: 0x56687178
Model has 246 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 64 continuous, 60 integer (60 binary)
Coefficient statistics:
  Matrix range     [2e-03, 1e+01]
  QMatrix range    [8e-09, 9e+00]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [1e-01, 4e+01]
  QObjective range [1e-01, 6e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e+00, 3e+00]
Found heuristic solution: objective 30.0000000
Warning: diagonal adjustment of 4.5e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 121 rows, 124 columns, 363 nonzeros
Presolved model has 246 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 64 continuous, 60 integer (60 binary)

Root relaxation: objective 5.660292e+00, 358 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    5.66029    0   29   30.00000    5.66029  81.1%     -    0s
H    0     0                      11.6566773    5.66029  51.4%     -    0s
H    0     0                      11.6566453    5.66029  51.4%     -    0s
     0     0    5.66031    0   34   11.65665    5.66031  51.4%     -    0s
H    0     0                      11.4630332    5.66031  50.6%     -    0s
H    0     0                      10.6433872    5.66031  46.8%     -    0s
     0     0    5.66031    0   34   10.64339    5.66031  46.8%     -    0s
H    0     0                      10.5624572    5.66031  46.4%     -    0s
     0     2    5.66031    0   34   10.56246    5.66031  46.4%     -    0s
H   31    40                      10.5624572    5.82069  44.9%  16.5    0s
H   68    80                      10.5624566    5.82069  44.9%  11.1    0s
H  119   144                      10.5624566    5.82069  44.9%   7.7    0s
H  134   144                      10.5624561    5.82069  44.9%   7.8    0s
H  319   316                      10.5624558    5.82069  44.9%   6.8    0s
H  359   317                      10.5624507    5.84297  44.7%   7.2    0s
H  367   317                      10.5026292    5.84297  44.4%   7.1    0s
H  383   340                      10.5026226    5.84297  44.4%   7.1    0s
H  403   340                      10.5026169    5.84297  44.4%   7.3    0s
H 1339   399                      10.5026155    8.66779  17.5%   7.2    0s

Explored 3732 nodes (23811 simplex iterations) in 0.46 seconds (0.36 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 10.5026 10.5625 10.6434 ... 11.6566

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (7.9083e-06) exceeds tolerance
Best objective 1.050261549114e+01, best bound 1.050248163135e+01, gap 0.0013%

User-callback calls 7921, time in user-callback 0.01 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_test_job3.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
10.50261549113663
The root upper bound is: 10.56245721902221, lower bound is: 5.6603140955231375. The root gap is: 46.411%. Runtime: 0.45888590812683105.
--------------------------------------------------
   m   n  dataset formulation  ...     end_lb   end_gap  node_count      time
0  3  50  autompg    original  ...   9.048064  0.000000       165.0  0.096252
1  3  50  autompg      no_cut  ...   9.047726  0.000037       680.0  0.179711
2  3  50  autompg         cut  ...   9.047966  0.000011       766.0  0.142551
3  3  60  autompg    original  ...  10.502622  0.000000      1760.0  0.177319
4  3  60  autompg      no_cut  ...  10.502521  0.000009      4511.0  0.503859
5  3  60  autompg         cut  ...  10.502482  0.000013      3732.0  0.458886

[6 rows x 12 columns]
[3, 70, 'autompg']
[0.00390478 0.00548318 0.01031156 1.         1.        ]
The relaxed obj is 0.05541761627829089.
The larges value of x is 2.4101746628439895
Use new Big-M 4.820349325687979.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 140 rows, 143 columns and 280 nonzeros
Model fingerprint: 0x40f1e940
Model has 286 quadratic objective terms
Variable types: 73 continuous, 70 integer (70 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [2e-01, 5e+01]
  QObjective range [4e-02, 7e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 35.0000000
Presolve time: 0.00s
Presolved: 140 rows, 143 columns, 280 nonzeros
Presolved model has 286 quadratic objective terms
Variable types: 73 continuous, 70 integer (70 binary)

Root relaxation: objective 5.264429e+00, 341 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    5.26443    0   44   35.00000    5.26443  85.0%     -    0s
H    0     0                      12.5292814    5.26443  58.0%     -    0s
H    0     0                      12.4469971    5.26443  57.7%     -    0s
H    0     0                      12.3570002    5.26443  57.4%     -    0s
     0     0    5.26443    0   44   12.35700    5.26443  57.4%     -    0s
H    0     0                      12.2950454    5.26443  57.2%     -    0s
     0     2    5.26443    0   44   12.29505    5.26443  57.2%     -    0s

Explored 4376 nodes (27980 simplex iterations) in 0.26 seconds (0.23 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 12.295 12.5293 35 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.229504536594e+01, best bound 1.229504536594e+01, gap 0.0000%

User-callback calls 9050, time in user-callback 0.01 sec
--------------------------------
solve the problem in original formulation
The obj is 12.295045365937767.
The root upper bound is: 12.295045365937767, lower bound is: 5.264428541245806. The root gap is: 57.1825%. Runtime: 0.26242899894714355.
[26 28 30 32 54]
Number of outliers: 5
--------------------------------
The decomposition time is 0.07089241407811642.
Optimal value: 1.4087546612744515
The decomposition time is 0.07039355952292681.
Optimal value: 4.183892142047109
The decomposition time is 0.0758032463490963.
Optimal value: 10.20061300815213
The best pair is: [[1, 2]]
------------------------
The decomposition time is 0.07219715137034655.
Optimal value: 10.20061300815213
5.264430837807733
5.264451180527541
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 140 rows, 144 columns and 280 nonzeros
Model fingerprint: 0x51561c6e
Model has 286 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 74 continuous, 70 integer (70 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  QMatrix range    [1e-08, 9e+00]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [2e-01, 5e+01]
  QObjective range [4e-02, 7e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 35.0000000
Warning: diagonal adjustment of 1.4e-07 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 140 rows, 144 columns, 280 nonzeros
Presolved model has 286 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 74 continuous, 70 integer (70 binary)

Root relaxation: objective -1.180488e+01, 270 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  -11.80488    0   45   35.00000  -11.80488   134%     -    0s
H    0     0                      15.1962353  -11.80488   178%     -    0s
     0     0    0.79252    0   43   15.19624    0.79252  94.8%     -    0s
H    0     0                      12.8103887    0.79252  93.8%     -    0s
H    0     0                      12.4919833    0.79252  93.7%     -    0s
     0     0    2.17910    0   44   12.49198    2.17910  82.6%     -    0s
     0     0    3.26065    0   44   12.49198    3.26065  73.9%     -    0s
H    0     0                      12.3241270    3.26065  73.5%     -    0s
     0     0    4.11473    0   41   12.32413    4.11473  66.6%     -    0s
     0     0    4.69304    0   40   12.32413    4.69304  61.9%     -    0s
     0     0    4.98033    0   44   12.32413    4.98033  59.6%     -    0s
H    0     0                      12.3241270    4.98033  59.6%     -    0s
     0     0    5.16662    0   41   12.32413    5.16662  58.1%     -    0s
H    0     0                      12.3241208    5.16662  58.1%     -    0s
     0     0    5.22220    0   43   12.32412    5.22220  57.6%     -    0s
     0     0    5.24447    0   44   12.32412    5.24447  57.4%     -    0s
     0     0    5.24447    0   44   12.32412    5.24447  57.4%     -    0s
H    0     0                      12.2950488    5.24447  57.3%     -    0s
     0     2    5.24447    0   44   12.29505    5.24447  57.3%     -    0s
H   31    40                      12.2950487    7.33625  40.3%   5.9    0s
H   38    40                      12.2950478    7.33625  40.3%   5.8    0s
H   67    80                      12.2950413    7.33625  40.3%   5.7    0s

Explored 9286 nodes (58045 simplex iterations) in 0.84 seconds (0.84 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 12.295 12.3241 12.492 ... 35

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (5.2053e-06) exceeds tolerance
Best objective 1.229504125254e+01, best bound 1.229432401497e+01, gap 0.0058%

User-callback calls 19206, time in user-callback 0.03 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation without cut
The obj is 12.295041252542351.
The root upper bound is: 12.29504884110818, lower bound is: 5.244470855435626. The root gap is: 57.3449%. Runtime: 0.8447680473327637.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 141 rows, 144 columns and 423 nonzeros
Model fingerprint: 0x6b7022c8
Model has 286 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 74 continuous, 70 integer (70 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+01]
  QMatrix range    [1e-08, 9e+00]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [2e-01, 5e+01]
  QObjective range [4e-02, 7e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e+00, 5e+00]
Found heuristic solution: objective 35.0000000
Warning: diagonal adjustment of 1.4e-07 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 141 rows, 144 columns, 423 nonzeros
Presolved model has 286 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 74 continuous, 70 integer (70 binary)

Root relaxation: objective 4.448176e+00, 402 iterations, 0.01 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    4.44818    0   40   35.00000    4.44818  87.3%     -    0s
H    0     0                      13.8447673    4.44818  67.9%     -    0s
     0     0    5.26435    0   44   13.84477    5.26435  62.0%     -    0s
H    0     0                      12.8103867    5.26435  58.9%     -    0s
H    0     0                      12.2950492    5.26435  57.2%     -    0s
     0     0    5.26437    0   44   12.29505    5.26437  57.2%     -    0s
H    0     0                      12.2950470    5.26437  57.2%     -    0s
     0     0    5.26440    0   44   12.29505    5.26440  57.2%     -    0s
H    0     0                      12.2950469    5.30386  56.9%     -    0s
     0     2    5.30386    0   44   12.29505    5.30386  56.9%     -    0s
H   31    40                      12.2950468    7.46743  39.3%  13.1    0s
H   78    80                      12.2950399    7.46743  39.3%  10.5    0s

Explored 10161 nodes (70904 simplex iterations) in 0.87 seconds (0.90 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 12.295 12.8104 13.8448 35 

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (8.8527e-06) exceeds tolerance
Best objective 1.229503992770e+01, best bound 1.229387960464e+01, gap 0.0094%

User-callback calls 20922, time in user-callback 0.03 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_test_job3.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
12.295039927701886
The root upper bound is: 12.295046854222619, lower bound is: 5.303864582090544. The root gap is: 56.8618%. Runtime: 0.8727169036865234.
--------------------------------------------------
   m   n  dataset formulation  ...     end_lb   end_gap  node_count      time
0  3  50  autompg    original  ...   9.048064  0.000000       165.0  0.096252
1  3  50  autompg      no_cut  ...   9.047726  0.000037       680.0  0.179711
2  3  50  autompg         cut  ...   9.047966  0.000011       766.0  0.142551
3  3  60  autompg    original  ...  10.502622  0.000000      1760.0  0.177319
4  3  60  autompg      no_cut  ...  10.502521  0.000009      4511.0  0.503859
5  3  60  autompg         cut  ...  10.502482  0.000013      3732.0  0.458886
6  3  70  autompg    original  ...  12.295045  0.000000      4376.0  0.262429
7  3  70  autompg      no_cut  ...  12.294324  0.000058      9286.0  0.844768
8  3  70  autompg         cut  ...  12.293880  0.000094     10161.0  0.872717

[9 rows x 12 columns]
[3, 80, 'autompg']
[0.00330536 0.00512383 0.00886908 1.         1.        ]
The relaxed obj is 0.06355273694434516.
The larges value of x is 2.5305865257328835
Use new Big-M 5.061173051465767.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 160 rows, 163 columns and 320 nonzeros
Model fingerprint: 0x1eaba93a
Model has 326 quadratic objective terms
Variable types: 83 continuous, 80 integer (80 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [3e-02, 5e+01]
  QObjective range [2e-01, 8e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 40.0000000
Presolve time: 0.00s
Presolved: 160 rows, 163 columns, 320 nonzeros
Presolved model has 326 quadratic objective terms
Variable types: 83 continuous, 80 integer (80 binary)

Root relaxation: objective 6.673184e+00, 391 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    6.67318    0   52   40.00000    6.67318  83.3%     -    0s
H    0     0                      17.4169926    6.67318  61.7%     -    0s
H    0     0                      17.2209245    6.67318  61.2%     -    0s
H    0     0                      16.8351569    6.67318  60.4%     -    0s
H    0     0                      16.7849627    6.67318  60.2%     -    0s
H    0     0                      16.6157010    6.67318  59.8%     -    0s
     0     0    6.89999    0   52   16.61570    6.89999  58.5%     -    0s
     0     2    6.89999    0   52   16.61570    6.89999  58.5%     -    0s

Explored 41269 nodes (291695 simplex iterations) in 1.84 seconds (2.29 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 16.6157 17.2209 17.417 40 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.661570096948e+01, best bound 1.661570096948e+01, gap 0.0000%

User-callback calls 83240, time in user-callback 0.10 sec
--------------------------------
solve the problem in original formulation
The obj is 16.615700969475675.
The root upper bound is: 16.615700969475675, lower bound is: 6.899985539725415. The root gap is: 58.4731%. Runtime: 1.8362538814544678.
[25 26 28 30 32 51 54 70 79]
Number of outliers: 9
--------------------------------
The decomposition time is 0.09018107503652573.
Optimal value: 1.2097839263659236
The decomposition time is 0.09245974477380514.
Optimal value: 19.28081355106644
The decomposition time is 0.10482625756412745.
Optimal value: 11.302941056416842
The best pair is: [[0, 2]]
------------------------
The decomposition time is 0.09363631252199411.
Optimal value: 19.28081355106644
6.673186889775799
8.881761502716778
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 160 rows, 164 columns and 320 nonzeros
Model fingerprint: 0x554476e9
Model has 326 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 84 continuous, 80 integer (80 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  QMatrix range    [1e-08, 1e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [3e-02, 5e+01]
  QObjective range [2e-02, 8e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 40.0000000
Warning: diagonal adjustment of 2.4e-08 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 160 rows, 164 columns, 320 nonzeros
Presolved model has 326 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 84 continuous, 80 integer (80 binary)

Root relaxation: objective -2.867987e+01, 381 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  -28.67987    0   54   40.00000  -28.67987   172%     -    0s
H    0     0                      22.1936267  -28.67987   229%     -    0s
H    0     0                      22.1936034  -28.67987   229%     -    0s
     0     0    4.15827    0   54   22.19360    4.15827  81.3%     -    0s
H    0     0                      20.0422989    4.15827  79.3%     -    0s
H    0     0                      17.9952810    4.15827  76.9%     -    0s
H    0     0                      17.7377711    4.15827  76.6%     -    0s
     0     0    4.65801    0   56   17.73777    4.65801  73.7%     -    0s
     0     0    5.88378    0   53   17.73777    5.88378  66.8%     -    0s
H    0     0                      16.8620660    5.88378  65.1%     -    0s
H    0     0                      16.8620559    5.88378  65.1%     -    0s
     0     0    6.40596    0   53   16.86206    6.40596  62.0%     -    0s
     0     0    6.50910    0   52   16.86206    6.50910  61.4%     -    0s
     0     0    6.60761    0   52   16.86206    6.60761  60.8%     -    0s
     0     0    6.62969    0   52   16.86206    6.62969  60.7%     -    0s
     0     0    6.62969    0   52   16.86206    6.62969  60.7%     -    0s
H    0     0                      16.6928915    6.62969  60.3%     -    0s
     0     2    6.62969    0   52   16.69289    6.62969  60.3%     -    0s
H   31    40                      16.6928915    8.67062  48.1%  10.1    0s
H  415   383                      16.6928891    8.82770  47.1%   5.5    0s
H 1463   855                      16.6157013   10.57670  36.3%   6.6    0s
H 1900   972                      16.6157011   10.79289  35.0%   6.3    0s
H 1903   972                      16.6156959   10.79289  35.0%   6.3    0s
H 1905   972                      16.6156952   10.79289  35.0%   6.3    0s
 63110 16161   16.52556   29   35   16.61570   15.37557  7.46%   6.2    5s
*101440     0              65      16.6156948   16.57800  0.23%   6.1    7s

Explored 101969 nodes (620436 simplex iterations) in 7.17 seconds (13.90 work units)
Thread count was 8 (of 52 available processors)

Solution count 7: 16.6157 16.6929 16.8621 ... 22.1936
No other solutions better than 16.6157

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (8.1673e-06) exceeds tolerance
Best objective 1.661569483080e+01, best bound 1.661569483387e+01, gap 0.0000%

User-callback calls 205409, time in user-callback 0.25 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation without cut
The obj is 16.615694830802177.
The root upper bound is: 16.6928915200426, lower bound is: 6.629691353131278. The root gap is: 60.2843%. Runtime: 7.174597978591919.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 161 rows, 164 columns and 483 nonzeros
Model fingerprint: 0xe45c165c
Model has 326 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 84 continuous, 80 integer (80 binary)
Coefficient statistics:
  Matrix range     [2e-02, 2e+01]
  QMatrix range    [1e-08, 1e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [3e-02, 5e+01]
  QObjective range [2e-02, 8e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [9e+00, 9e+00]
Found heuristic solution: objective 40.0000000
Warning: diagonal adjustment of 2.4e-08 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 161 rows, 164 columns, 483 nonzeros
Presolved model has 326 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 84 continuous, 80 integer (80 binary)

Root relaxation: objective 8.881725e+00, 431 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    8.88172    0   39   40.00000    8.88172  77.8%     -    0s
H    0     0                      23.9596205    8.88172  62.9%     -    0s
H    0     0                      22.9460990    8.88172  61.3%     -    0s
H    0     0                      20.9438661    8.88172  57.6%     -    0s
     0     0    8.88175    0   50   20.94387    8.88175  57.6%     -    0s
H    0     0                      18.7810374    8.88175  52.7%     -    0s
H    0     0                      17.5550453    8.88175  49.4%     -    0s
H    0     0                      17.5550430    8.88175  49.4%     -    0s
     0     0    8.88175    0   50   17.55504    8.88175  49.4%     -    0s
H    0     0                      17.0164670    8.88175  47.8%     -    0s
     0     2    8.88175    0   50   17.01647    8.88175  47.8%     -    0s
H   31    40                      17.0164643    8.95427  47.4%  32.5    0s
H   76    80                      17.0164642    9.00512  47.1%  20.3    0s
H  811   686                      17.0164638    9.05477  46.8%   6.1    0s
H  876   711                      17.0164631    9.42735  44.6%   7.8    0s
H  888   674                      17.0164594    9.42735  44.6%   7.8    0s
H 1977  1108                      16.6157021    9.51516  42.7%   7.0    0s
H 1978  1079                      16.6157004    9.51516  42.7%   7.0    0s
H 3085  1578                      16.6156967   10.38332  37.5%   7.5    0s
H 3104  1578                      16.6156917   10.40558  37.4%   7.5    0s
 82116 18699   14.90007   61    7   16.61569   14.84839  10.6%   6.2    5s
 180836 11801   16.61108   31   38   16.61569   16.13826  2.87%   5.6   10s

Explored 203387 nodes (1101093 simplex iterations) in 11.12 seconds (18.76 work units)
Thread count was 8 (of 52 available processors)

Solution count 7: 16.6157 17.0165 17.555 ... 40
No other solutions better than 16.6157

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (9.5299e-06) exceeds tolerance
Best objective 1.661569171071e+01, best bound 1.661569171379e+01, gap 0.0000%

User-callback calls 408350, time in user-callback 0.54 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_test_job3.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
16.615691710713417
The root upper bound is: 17.016467005641257, lower bound is: 8.881746647236731. The root gap is: 47.805%. Runtime: 11.126155853271484.
--------------------------------------------------
    m   n  dataset formulation  ...     end_lb       end_gap  node_count       time
0   3  50  autompg    original  ...   9.048064  0.000000e+00       165.0   0.096252
1   3  50  autompg      no_cut  ...   9.047726  3.744421e-05       680.0   0.179711
2   3  50  autompg         cut  ...   9.047966  1.065241e-05       766.0   0.142551
3   3  60  autompg    original  ...  10.502622  0.000000e+00      1760.0   0.177319
4   3  60  autompg      no_cut  ...  10.502521  9.114340e-06      4511.0   0.503859
5   3  60  autompg         cut  ...  10.502482  1.274538e-05      3732.0   0.458886
6   3  70  autompg    original  ...  12.295045  0.000000e+00      4376.0   0.262429
7   3  70  autompg      no_cut  ...  12.294324  5.833552e-05      9286.0   0.844768
8   3  70  autompg         cut  ...  12.293880  9.437327e-05     10161.0   0.872717
9   3  80  autompg    original  ...  16.615701  0.000000e+00     41269.0   1.836254
10  3  80  autompg      no_cut  ...  16.615695 -1.848882e-10    101969.0   7.174598
11  3  80  autompg         cut  ...  16.615692 -1.848765e-10    203387.0  11.126156

[12 rows x 12 columns]
[3, 90, 'autompg']
[0.00304563 0.00446297 0.00751559 1.         1.        ]
The relaxed obj is 0.0717736461939893.
The larges value of x is 2.4535683145326233
Use new Big-M 4.9071366290652465.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 180 rows, 183 columns and 360 nonzeros
Model fingerprint: 0x81417937
Model has 366 quadratic objective terms
Variable types: 93 continuous, 90 integer (90 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [2e-02, 5e+01]
  QObjective range [1e-01, 9e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 45.0000000
Presolve time: 0.00s
Presolved: 180 rows, 183 columns, 360 nonzeros
Presolved model has 366 quadratic objective terms
Variable types: 93 continuous, 90 integer (90 binary)

Root relaxation: objective 7.836440e+00, 410 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    7.83644    0   63   45.00000    7.83644  82.6%     -    0s
H    0     0                      19.7451032    7.83644  60.3%     -    0s
H    0     0                      19.7108125    7.83644  60.2%     -    0s
H    0     0                      19.0299782    7.83644  58.8%     -    0s
H    0     0                      18.9917243    7.83644  58.7%     -    0s
H    0     0                      18.8553921    7.83644  58.4%     -    0s
     0     0    7.92145    0   63   18.85539    7.92145  58.0%     -    0s
H    0     0                      18.8491461    7.92145  58.0%     -    0s
     0     2    7.92145    0   63   18.84915    7.92145  58.0%     -    0s

Explored 116639 nodes (739962 simplex iterations) in 4.95 seconds (6.86 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 18.8491 18.8554 19.7108 ... 45

Optimal solution found (tolerance 1.00e-04)
Best objective 1.884914608780e+01, best bound 1.884914608780e+01, gap 0.0000%

User-callback calls 234414, time in user-callback 0.31 sec
--------------------------------
solve the problem in original formulation
The obj is 18.84914608780193.
The root upper bound is: 18.84914608780193, lower bound is: 7.921447466293139. The root gap is: 57.9745%. Runtime: 4.953527927398682.
[25 26 28 30 32 54 70 79 84]
Number of outliers: 9
--------------------------------
The decomposition time is 0.10992314387112856.
Optimal value: 1.1889578950465514
The decomposition time is 0.12820578273385763.
Optimal value: 12.62106743769386
The decomposition time is 0.12539104465395212.
Optimal value: 12.055716817999759
The best pair is: [[0, 2]]
------------------------
The decomposition time is 0.12884256523102522.
Optimal value: 12.62106743769386
7.836448902589048
9.639966765945879
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 180 rows, 184 columns and 360 nonzeros
Model fingerprint: 0x9b9b0bb9
Model has 366 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 94 continuous, 90 integer (90 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  QMatrix range    [1e-08, 7e+00]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [2e-02, 5e+01]
  QObjective range [5e-02, 9e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 45.0000000
Warning: diagonal adjustment of 2.9e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 180 rows, 184 columns, 360 nonzeros
Presolved model has 366 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 94 continuous, 90 integer (90 binary)

Root relaxation: objective -4.368817e+00, 394 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   -4.36882    0   61   45.00000   -4.36882   110%     -    0s
H    0     0                      22.0107867   -4.36882   120%     -    0s
     0     0    2.23338    0   60   22.01079    2.23338  89.9%     -    0s
H    0     0                      20.4557884    2.23338  89.1%     -    0s
H    0     0                      19.2814258    2.23338  88.4%     -    0s
     0     0    7.71658    0   62   19.28143    7.71658  60.0%     -    0s
     0     0    7.78061    0   62   19.28143    7.78061  59.6%     -    0s
     0     0    7.83600    0   63   19.28143    7.83600  59.4%     -    0s
     0     0    7.83623    0   63   19.28143    7.83623  59.4%     -    0s
     0     0    7.83644    0   63   19.28143    7.83644  59.4%     -    0s
H    0     0                      19.2814242    7.83644  59.4%     -    0s
H    0     0                      18.8811689    7.83644  58.5%     -    0s
H    0     2                      18.8811689    7.83644  58.5%     -    0s
     0     2    7.83644    0   63   18.88117    7.83644  58.5%     -    0s
H   33    40                      18.8811369   10.20757  45.9%  12.2    0s
H   35    40                      18.8599130   10.20757  45.9%  12.0    0s
H  671   551                      18.8599130   10.99684  41.7%   6.4    0s
H  755   596                      18.8491459   10.99684  41.7%   7.3    0s
H 1876   807                      18.8491395   10.99684  41.7%   7.0    0s
 78991 27258   18.37897   25   46   18.84914   17.16584  8.93%   6.3    5s
 176636 21192   18.20620   22   56   18.84914   18.19877  3.45%   6.1   10s

Explored 220871 nodes (1288358 simplex iterations) in 12.32 seconds (19.73 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 18.8491 18.8599 19.2814 ... 45

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (6.6408e-06) exceeds tolerance
Best objective 1.884913951134e+01, best bound 1.884832254713e+01, gap 0.0043%

User-callback calls 443569, time in user-callback 0.60 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation without cut
The obj is 18.849139511343264.
The root upper bound is: 18.881168876331472, lower bound is: 7.836437972075679. The root gap is: 58.496%. Runtime: 12.318489074707031.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 181 rows, 184 columns and 543 nonzeros
Model fingerprint: 0xb6a11dbe
Model has 366 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 94 continuous, 90 integer (90 binary)
Coefficient statistics:
  Matrix range     [5e-04, 1e+01]
  QMatrix range    [1e-08, 7e+00]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [2e-02, 5e+01]
  QObjective range [5e-02, 9e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e+00, 5e+00]
Found heuristic solution: objective 45.0000000
Warning: diagonal adjustment of 2.9e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 181 rows, 184 columns, 543 nonzeros
Presolved model has 366 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 94 continuous, 90 integer (90 binary)

Root relaxation: objective 9.639789e+00, 471 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    9.63979    0   54   45.00000    9.63979  78.6%     -    0s
H    0     0                      21.1448589    9.63979  54.4%     -    0s
H    0     0                      21.1419648    9.63979  54.4%     -    0s
     0     0    9.63995    0   62   21.14196    9.63995  54.4%     -    0s
H    0     0                      19.7430773    9.63995  51.2%     -    0s
     0     0    9.63995    0   62   19.74308    9.63995  51.2%     -    0s
H    0     0                      18.8553996    9.63995  48.9%     -    0s
     0     2    9.63995    0   62   18.85540    9.63995  48.9%     -    0s
H   32    40                      18.8553986    9.84002  47.8%  25.8    0s
H   37    40                      18.8553922    9.84002  47.8%  25.5    0s
H   72    80                      18.8553921    9.84002  47.8%  18.3    0s
H  812   705                      18.8491481    9.97886  47.1%   8.1    0s
H  819   681                      18.8491455    9.97886  47.1%   8.3    0s
H  848   663                      18.8491449   10.07731  46.5%   8.9    0s
H 1619  1060                      18.8491421   12.04430  36.1%   8.0    0s
H 2786  1224                      18.8491407   12.70268  32.6%   6.8    0s
 82839 30665     cutoff   31        18.84914   17.09409  9.31%   5.8    5s
 178388 32874   18.15923   27   45   18.84914   17.96041  4.71%   5.6   10s

Explored 262312 nodes (1396124 simplex iterations) in 14.34 seconds (23.07 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 18.8491 18.8554 19.7431 ... 45

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (5.4746e-06) exceeds tolerance
Best objective 1.884914066251e+01, best bound 1.884908907609e+01, gap 0.0003%

User-callback calls 526426, time in user-callback 0.71 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_test_job3.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
18.849140662508674
The root upper bound is: 18.855399628089856, lower bound is: 9.639953839081748. The root gap is: 48.8743%. Runtime: 14.337853193283081.
--------------------------------------------------
    m   n  dataset formulation  ...     end_lb       end_gap  node_count       time
0   3  50  autompg    original  ...   9.048064  0.000000e+00       165.0   0.096252
1   3  50  autompg      no_cut  ...   9.047726  3.744421e-05       680.0   0.179711
2   3  50  autompg         cut  ...   9.047966  1.065241e-05       766.0   0.142551
3   3  60  autompg    original  ...  10.502622  0.000000e+00      1760.0   0.177319
4   3  60  autompg      no_cut  ...  10.502521  9.114340e-06      4511.0   0.503859
5   3  60  autompg         cut  ...  10.502482  1.274538e-05      3732.0   0.458886
6   3  70  autompg    original  ...  12.295045  0.000000e+00      4376.0   0.262429
7   3  70  autompg      no_cut  ...  12.294324  5.833552e-05      9286.0   0.844768
8   3  70  autompg         cut  ...  12.293880  9.437327e-05     10161.0   0.872717
9   3  80  autompg    original  ...  16.615701  0.000000e+00     41269.0   1.836254
10  3  80  autompg      no_cut  ...  16.615695 -1.848882e-10    101969.0   7.174598
11  3  80  autompg         cut  ...  16.615692 -1.848765e-10    203387.0  11.126156
12  3  90  autompg    original  ...  18.849146  0.000000e+00    116639.0   4.953528
13  3  90  autompg      no_cut  ...  18.848323  4.334226e-05    220871.0  12.318489
14  3  90  autompg         cut  ...  18.849089  2.736805e-06    262312.0  14.337853

[15 rows x 12 columns]
[3, 100, 'autompg']
[0.00285807 0.00378796 0.00682196 1.         1.        ]
The relaxed obj is 0.07853228658468225.
The larges value of x is 2.5386144951952163
Use new Big-M 5.077228990390433.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 200 rows, 203 columns and 400 nonzeros
Model fingerprint: 0x9611f19b
Model has 406 quadratic objective terms
Variable types: 103 continuous, 100 integer (100 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [7e-02, 6e+01]
  QObjective range [1e-01, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 50.0000000
Presolve time: 0.00s
Presolved: 200 rows, 203 columns, 400 nonzeros
Presolved model has 406 quadratic objective terms
Variable types: 103 continuous, 100 integer (100 binary)

Root relaxation: objective 8.012716e+00, 463 iterations, 0.00 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    8.01272    0   70   50.00000    8.01272  84.0%     -    0s
H    0     0                      21.1306967    8.01272  62.1%     -    0s
H    0     0                      20.7945262    8.01272  61.5%     -    0s
H    0     0                      19.6858154    8.01272  59.3%     -    0s
H    0     0                      19.6724868    8.01272  59.3%     -    0s
H    0     0                      19.5227040    8.01272  59.0%     -    0s
     0     0    8.41158    0   70   19.52270    8.41158  56.9%     -    0s
H    0     0                      19.4834687    8.41158  56.8%     -    0s
H    0     0                      19.4627952    8.41158  56.8%     -    0s
     0     2    8.41158    0   70   19.46280    8.41158  56.8%     -    0s
 105684 10796   19.14678   27   54   19.46280   18.79159  3.45%   7.0    5s

Explored 128209 nodes (866996 simplex iterations) in 5.86 seconds (8.84 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 19.4628 19.4835 19.5227 ... 50

Optimal solution found (tolerance 1.00e-04)
Best objective 1.946279521766e+01, best bound 1.946279521766e+01, gap 0.0000%

User-callback calls 257637, time in user-callback 0.35 sec
--------------------------------
solve the problem in original formulation
The obj is 19.462795217658595.
The root upper bound is: 19.462795217658595, lower bound is: 8.411584517800467. The root gap is: 56.7812%. Runtime: 5.863274097442627.
[25 26 28 30 32 51 54 70 79 84]
Number of outliers: 10
--------------------------------
The decomposition time is 0.14123987685889006.
Optimal value: 1.3648264307590754
The decomposition time is 0.13950947858393192.
Optimal value: 3.956937935054878
The decomposition time is 0.15788624249398708.
Optimal value: 12.363219227556675
The best pair is: [[1, 2]]
------------------------
The decomposition time is 0.1583639234304428.
Optimal value: 12.363219227556675
8.01272062599643
10.053758498044395
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 200 rows, 204 columns and 400 nonzeros
Model fingerprint: 0x9960d34b
Model has 406 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 104 continuous, 100 integer (100 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  QMatrix range    [1e-08, 1e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [7e-02, 6e+01]
  QObjective range [1e-01, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 50.0000000
Warning: diagonal adjustment of 6.8e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 200 rows, 204 columns, 400 nonzeros
Presolved model has 406 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 104 continuous, 100 integer (100 binary)

Root relaxation: objective -8.698778e+00, 469 iterations, 0.00 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   -8.69878    0   69   50.00000   -8.69878   117%     -    0s
H    0     0                      24.5122824   -8.69878   135%     -    0s
H    0     0                      24.5122767   -8.69878   135%     -    0s
     0     0   -3.18687    0   73   24.51228   -3.18687   113%     -    0s
H    0     0                      22.1016473   -3.18687   114%     -    0s
H    0     0                      19.8913254   -3.18687   116%     -    0s
     0     0    4.42677    0   68   19.89133    4.42677  77.7%     -    0s
     0     0    7.01197    0   68   19.89133    7.01197  64.7%     -    0s
     0     0    7.35549    0   69   19.89133    7.35549  63.0%     -    0s
H    0     0                      19.8913241    7.35549  63.0%     -    0s
     0     0    7.65700    0   65   19.89132    7.65700  61.5%     -    0s
     0     0    7.83159    0   69   19.89132    7.83159  60.6%     -    0s
     0     0    7.88305    0   69   19.89132    7.88305  60.4%     -    0s
H    0     0                      19.6340952    7.88305  59.9%     -    0s
     0     0    7.97049    0   70   19.63410    7.97049  59.4%     -    0s
     0     0    7.98594    0   70   19.63410    7.98594  59.3%     -    0s
     0     0    7.99529    0   69   19.63410    7.99529  59.3%     -    0s
H    0     0                      19.5227034    7.99529  59.0%     -    0s
     0     2    7.99529    0   69   19.52270    7.99529  59.0%     -    0s
H   32    40                      19.5227034   10.08980  48.3%   7.4    0s
H  463   420                      19.4834689   10.90238  44.0%   4.7    0s
H  671   510                      19.4834689   11.22679  42.4%   4.8    0s
H  714   520                      19.4834683   11.22679  42.4%   6.0    0s
H  714   496                      19.4834640   11.22679  42.4%   6.0    0s
H  715   472                      19.4628012   11.22679  42.3%   6.0    0s
H  720   448                      19.4627878   11.22679  42.3%   6.0    0s
 55467 23676   18.98063   35   51   19.46279   17.16184  11.8%   8.0    5s
 118060 32026   18.81267   31   45   19.46279   18.03492  7.34%   8.0   10s
 180817 22289   19.06274   34   43   19.46279   18.74660  3.68%   7.9   15s

Explored 221118 nodes (1666721 simplex iterations) in 18.22 seconds (35.38 work units)
Thread count was 8 (of 52 available processors)

Solution count 8: 19.4628 19.4835 19.5227 ... 50

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (8.6654e-06) exceeds tolerance
Best objective 1.946278776441e+01, best bound 1.946278776441e+01, gap 0.0000%

User-callback calls 444697, time in user-callback 0.60 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation without cut
The obj is 19.46278776440874.
The root upper bound is: 19.522703428689972, lower bound is: 7.995287878816221. The root gap is: 59.0462%. Runtime: 18.217805862426758.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 201 rows, 204 columns and 603 nonzeros
Model fingerprint: 0x3547018e
Model has 406 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 104 continuous, 100 integer (100 binary)
Coefficient statistics:
  Matrix range     [5e-04, 1e+01]
  QMatrix range    [1e-08, 1e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [7e-02, 6e+01]
  QObjective range [1e-01, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e+00, 4e+00]
Found heuristic solution: objective 50.0000000
Warning: diagonal adjustment of 6.8e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 201 rows, 204 columns, 603 nonzeros
Presolved model has 406 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 104 continuous, 100 integer (100 binary)

Root relaxation: objective 1.005373e+01, 568 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   10.05373    0   62   50.00000   10.05373  79.9%     -    0s
H    0     0                      24.4056745   10.05373  58.8%     -    0s
H    0     0                      24.2228931   10.05373  58.5%     -    0s
     0     0   10.05375    0   68   24.22289   10.05375  58.5%     -    0s
H    0     0                      23.5053442   10.05375  57.2%     -    0s
H    0     0                      19.8913317   10.05375  49.5%     -    0s
     0     0   10.05375    0   68   19.89133   10.05375  49.5%     -    0s
H    0     0                      19.4627958   10.05375  48.3%     -    0s
     0     2   10.05375    0   68   19.46280   10.05375  48.3%     -    0s
H   35    40                      19.4627950   10.29505  47.1%  32.4    0s
H   64    80                      19.4627950   10.31100  47.0%  25.7    0s
H  865   834                      19.4627886   10.40192  46.6%   7.5    0s
H  907   834                      19.4627863   10.40192  46.6%   7.3    0s
 64171 25850   17.95068   35   47   19.46279   15.56055  20.0%   6.9    5s
 136359 45160   19.35518   40   33   19.46279   16.63998  14.5%   6.5   10s
 208757 59382     cutoff   35        19.46279   17.22800  11.5%   6.3   15s
 286013 69889   19.04000   39   41   19.46279   17.61931  9.47%   6.2   20s
 363049 74816     cutoff   39        19.46279   17.91885  7.93%   6.1   25s
 436414 74192   19.28794   37   37   19.46279   18.16525  6.67%   6.1   30s
 513855 67509   18.98793   32   44   19.46279   18.41867  5.36%   6.0   35s
 585454 54778     cutoff   26        19.46279   18.66736  4.09%   5.9   40s
 664247 30379     cutoff   34        19.46279   19.00870  2.33%   5.8   45s

Explored 718481 nodes (4128220 simplex iterations) in 48.89 seconds (86.31 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 19.4628 19.8913 23.5053 ... 50

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (9.3756e-06) exceeds tolerance
Best objective 1.946278625239e+01, best bound 1.946178466192e+01, gap 0.0051%

User-callback calls 1441133, time in user-callback 1.94 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_test_job3.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
19.462786252393535
The root upper bound is: 19.462795806216185, lower bound is: 10.053748632536454. The root gap is: 48.3438%. Runtime: 48.89344501495361.
--------------------------------------------------
    m    n  dataset formulation  ...     end_lb       end_gap  node_count       time
0   3   50  autompg    original  ...   9.048064  0.000000e+00       165.0   0.096252
1   3   50  autompg      no_cut  ...   9.047726  3.744421e-05       680.0   0.179711
2   3   50  autompg         cut  ...   9.047966  1.065241e-05       766.0   0.142551
3   3   60  autompg    original  ...  10.502622  0.000000e+00      1760.0   0.177319
4   3   60  autompg      no_cut  ...  10.502521  9.114340e-06      4511.0   0.503859
5   3   60  autompg         cut  ...  10.502482  1.274538e-05      3732.0   0.458886
6   3   70  autompg    original  ...  12.295045  0.000000e+00      4376.0   0.262429
7   3   70  autompg      no_cut  ...  12.294324  5.833552e-05      9286.0   0.844768
8   3   70  autompg         cut  ...  12.293880  9.437327e-05     10161.0   0.872717
9   3   80  autompg    original  ...  16.615701  0.000000e+00     41269.0   1.836254
10  3   80  autompg      no_cut  ...  16.615695 -1.848882e-10    101969.0   7.174598
11  3   80  autompg         cut  ...  16.615692 -1.848765e-10    203387.0  11.126156
12  3   90  autompg    original  ...  18.849146  0.000000e+00    116639.0   4.953528
13  3   90  autompg      no_cut  ...  18.848323  4.334226e-05    220871.0  12.318489
14  3   90  autompg         cut  ...  18.849089  2.736805e-06    262312.0  14.337853
15  3  100  autompg    original  ...  19.462795  0.000000e+00    128209.0   5.863274
16  3  100  autompg      no_cut  ...  19.462788  0.000000e+00    221118.0  18.217806
17  3  100  autompg         cut  ...  19.461785  5.146182e-05    718481.0  48.893445

[18 rows x 12 columns]
[3, 120, 'autompg']
[0.00230949 0.00333672 0.00562492 1.         1.        ]
The relaxed obj is 0.09396600087610096.
The larges value of x is 2.5710226645332637
Use new Big-M 5.142045329066527.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 240 rows, 243 columns and 480 nonzeros
Model fingerprint: 0xdce4c869
Model has 486 quadratic objective terms
Variable types: 123 continuous, 120 integer (120 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [8e-02, 7e+01]
  QObjective range [7e-02, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 60.0000000
Presolve time: 0.00s
Presolved: 240 rows, 243 columns, 480 nonzeros
Presolved model has 486 quadratic objective terms
Variable types: 123 continuous, 120 integer (120 binary)

Root relaxation: objective 1.060023e+01, 535 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   10.60023    0   84   60.00000   10.60023  82.3%     -    0s
H    0     0                      31.7564281   10.60023  66.6%     -    0s
H    0     0                      29.3785431   10.60023  63.9%     -    0s
H    0     0                      26.7098999   10.60023  60.3%     -    0s
H    0     0                      26.6519534   10.60023  60.2%     -    0s
H    0     0                      26.3819886   10.60023  59.8%     -    0s
     0     0   10.61880    0   84   26.38199   10.61880  59.7%     -    0s
     0     2   10.61880    0   84   26.38199   10.61880  59.7%     -    0s
 77700 47107   26.21275   29   76   26.38199   21.20488  19.6%   7.9    5s
 177639 98801   23.55999   27   74   26.38199   22.30849  15.4%   7.3   10s
 278019 145570   26.18792   32   75   26.38199   22.85262  13.4%   7.0   15s
 382734 190637   24.40443   27   72   26.38199   23.21536  12.0%   6.9   20s
 481800 230351   26.01840   31   73   26.38199   23.46962  11.0%   6.8   25s
 583421 267181   24.13899   27   77   26.38199   23.67631  10.3%   6.7   30s
 692113 304559   25.42501   39   56   26.38199   23.85662  9.57%   6.6   35s
 793065 336653   26.17099   35   61   26.38199   24.00522  9.01%   6.6   40s
 897449 367018     cutoff   38        26.38199   24.13604  8.51%   6.5   45s
 996030 393051     cutoff   37        26.38199   24.24456  8.10%   6.5   50s
 1097178 417396   25.18551   32   67   26.38199   24.34505  7.72%   6.5   55s
 1199321 439357   25.43317   31   71   26.38199   24.44045  7.36%   6.4   60s
 1299047 458490   24.75631   30   70   26.38199   24.52446  7.04%   6.4   65s
 1404957 476458     cutoff   35        26.38199   24.60781  6.72%   6.4   70s
 1501990 490389   25.89979   33   63   26.38199   24.67914  6.45%   6.4   75s
 1602554 502491   24.75035   27   68   26.38199   24.74885  6.19%   6.3   80s
 1700531 511816   25.74022   35   60   26.38199   24.81253  5.95%   6.3   85s
 1800992 519692   25.29262   29   68   26.38199   24.87589  5.71%   6.3   90s
 1895233 525136   26.24354   32   68   26.38199   24.93369  5.49%   6.3   95s
 1998230 528513   26.14658   34   62   26.38199   24.99412  5.26%   6.2  100s
 2102992 529855   25.85237   33   66   26.38199   25.05464  5.03%   6.2  105s
 2198293 528658   25.78118   31   72   26.38199   25.10780  4.83%   6.2  110s
 2295557 525752   26.24898   33   65   26.38199   25.16155  4.63%   6.2  115s
 2395319 520451   25.48194   31   67   26.38199   25.21674  4.42%   6.2  120s
 2488599 513246   26.17951   37   59   26.38199   25.26791  4.22%   6.1  125s
 2594419 502694   26.23518   33   69   26.38199   25.32573  4.00%   6.1  130s
 2706105 487885   26.22288   41   52   26.38199   25.38628  3.77%   6.1  135s
 2818042 470134   26.20991   40   60   26.38199   25.44707  3.54%   6.1  140s
 2934857 448446   26.34548   33   68   26.38199   25.51142  3.30%   6.1  145s
 3045446 423036     cutoff   33        26.38199   25.57357  3.06%   6.0  150s
 3153737 394022   25.88598   29   70   26.38199   25.63758  2.82%   6.0  155s
 3268168 360174     cutoff   36        26.38199   25.70665  2.56%   6.0  160s
 3373777 326040   26.35669   35   56   26.38199   25.77228  2.31%   6.0  165s
 3480397 288640   25.84090   33   63   26.38199   25.84069  2.05%   5.9  170s
 3580984 250614   26.19684   32   66   26.38199   25.90972  1.79%   5.9  175s
 3682524 208498   26.21387   33   67   26.38199   25.98429  1.51%   5.9  180s
 3779655 164298     cutoff   36        26.38199   26.06387  1.21%   5.9  185s
 3875012 114517   26.30050   33   60   26.38199   26.15463  0.86%   5.8  190s
 3964905 56512   26.29432   33   68   26.38199   26.26392  0.45%   5.8  195s

Explored 4033743 nodes (23148760 simplex iterations) in 198.54 seconds (344.30 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 26.382 29.3785 31.7564 60 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.638198858886e+01, best bound 2.638158321376e+01, gap 0.0015%

User-callback calls 8086947, time in user-callback 10.75 sec
--------------------------------
solve the problem in original formulation
The obj is 26.381988588861418.
The root upper bound is: 26.381988588861418, lower bound is: 10.61879705089547. The root gap is: 59.7498%. Runtime: 198.54590106010437.
[ 25  26  28  30  32  51  54  70  79  84 102 107 114 117]
Number of outliers: 14
--------------------------------
The decomposition time is 0.20672454871237278.
Optimal value: 1.167272039427183
The decomposition time is 0.18338550999760628.
Optimal value: 2.854474248505997
The decomposition time is 0.26272687409073114.
Optimal value: 14.842872010153727
The best pair is: [[1, 2]]
------------------------
The decomposition time is 0.2664282051846385.
Optimal value: 14.842872010153727
10.600246930779065
13.5647992379211
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 240 rows, 244 columns and 480 nonzeros
Model fingerprint: 0xb799d018
Model has 486 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 124 continuous, 120 integer (120 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  QMatrix range    [1e-08, 1e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [8e-02, 7e+01]
  QObjective range [7e-02, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 60.0000000
Warning: diagonal adjustment of 1.7e-08 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 240 rows, 244 columns, 480 nonzeros
Presolved model has 486 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 124 continuous, 120 integer (120 binary)

Root relaxation: objective -2.559412e+01, 575 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  -25.59412    0   84   60.00000  -25.59412   143%     -    0s
H    0     0                      33.9797631  -25.59412   175%     -    0s
H    0     0                      33.1196740  -25.59412   177%     -    0s
     0     0    4.74802    0   85   33.11967    4.74802  85.7%     -    0s
H    0     0                      30.5327219    4.74802  84.4%     -    0s
H    0     0                      27.7465477    4.74802  82.9%     -    0s
     0     0    7.55376    0   79   27.74655    7.55376  72.8%     -    0s
     0     0    8.44672    0   83   27.74655    8.44672  69.6%     -    0s
H    0     0                      27.7465429    8.44672  69.6%     -    0s
     0     0    8.85410    0   87   27.74654    8.85410  68.1%     -    0s
     0     0    9.54989    0   88   27.74654    9.54989  65.6%     -    0s
H    0     0                      27.7465390    9.54989  65.6%     -    0s
     0     0    9.81071    0   84   27.74654    9.81071  64.6%     -    0s
     0     0   10.15147    0   84   27.74654   10.15147  63.4%     -    0s
     0     0   10.15404    0   84   27.74654   10.15404  63.4%     -    0s
     0     0   10.24241    0   84   27.74654   10.24241  63.1%     -    0s
     0     0   10.44346    0   82   27.74654   10.44346  62.4%     -    0s
     0     0   10.47569    0   82   27.74654   10.47569  62.2%     -    0s
     0     0   10.49698    0   84   27.74654   10.49698  62.2%     -    0s
     0     0   10.54720    0   84   27.74654   10.54720  62.0%     -    0s
H    0     0                      26.5685864   10.54720  60.3%     -    0s
     0     2   10.54720    0   84   26.56859   10.54720  60.3%     -    0s
H  244   260                      26.5685839   12.60088  52.6%   6.4    0s
H  463   413                      26.4240743   13.57727  48.6%   5.4    0s
H  883   687                      26.4240743   14.41267  45.5%   5.2    0s
H  886   654                      26.4240743   14.41267  45.5%   5.2    0s
H  897   629                      26.4240741   14.41267  45.5%   5.1    0s
H 1455   942                      26.4240724   14.41267  45.5%   7.1    0s
H 2120  1149                      26.3820158   14.41267  45.4%   7.2    1s
H 2123  1119                      26.3819989   14.41267  45.4%   7.2    1s
H 3139  1683                      26.3819908   16.11019  38.9%   7.3    1s
H 3239  1800                      26.3819906   16.21025  38.6%   7.3    1s
H 3522  1937                      26.3819906   16.21025  38.6%   7.3    1s
H 3552  1937                      26.3819905   16.21025  38.6%   7.3    1s
H 3614  1937                      26.3819905   16.21025  38.6%   7.3    1s
H 4702  2686                      26.3819839   16.89524  36.0%   7.4    1s
H 5771  3438                      26.3819821   17.22095  34.7%   7.7    1s
 18716 12566   20.32503   23   75   26.38198   18.92787  28.3%   8.4    5s
 41229 28442   23.47379   38   57   26.38198   19.90936  24.5%   8.4   10s
 67426 45674   23.75254   32   66   26.38198   20.55082  22.1%   8.2   15s
 95497 63941   26.19091   38   61   26.38198   20.94050  20.6%   8.1   20s
 124809 82658   24.28823   27   76   26.38198   21.23246  19.5%   7.9   25s
 153071 100378   23.22326   27   74   26.38198   21.44774  18.7%   7.9   30s
 176765 115312   25.04061   34   60   26.38198   21.59589  18.1%   7.8   35s
 206385 133611   22.56943   27   74   26.38198   21.74846  17.6%   7.7   40s
 233120 149574   24.65730   34   66   26.38198   21.86287  17.1%   7.7   45s
 256931 164087   25.50019   39   58   26.38198   21.96378  16.7%   7.7   50s
 286770 181987   25.93674   36   59   26.38198   22.06517  16.4%   7.6   55s
 318597 200551   26.15540   43   61   26.38198   22.16296  16.0%   7.6   60s
 346561 217077   23.32823   29   71   26.38198   22.23705  15.7%   7.6   65s
 369772 230656   25.43193   35   60   26.38198   22.29063  15.5%   7.5   70s
 398366 246491   24.68647   33   66   26.38198   22.35737  15.3%   7.5   75s
 425924 262654   24.81564   37   63   26.38198   22.41562  15.0%   7.5   80s
 454935 278987   23.30181   31   63   26.38198   22.47409  14.8%   7.5   85s
 477211 291557   25.48568   41   55   26.38198   22.51679  14.7%   7.5   90s
 505754 307619   23.69864   31   71   26.38198   22.56743  14.5%   7.5   95s
 534904 324024   24.11006   31   71   26.38198   22.61547  14.3%   7.5  100s
 563511 340224   23.27212   28   65   26.38198   22.66067  14.1%   7.4  105s
 588050 353590   25.53106   37   57   26.38198   22.69886  14.0%   7.4  110s
 616699 369185   24.26094   34   65   26.38198   22.73930  13.8%   7.4  115s
H634212 378197                      26.3819808   22.76329  13.7%   7.4  118s
 641661 382866   24.49616   35   60   26.38198   22.77333  13.7%   7.4  120s
 669502 398171   26.30731   40   58   26.38198   22.81050  13.5%   7.4  125s
 695941 411874   24.88165   40   56   26.38198   22.84283  13.4%   7.4  130s
 720756 425196   25.77806   38   56   26.38198   22.87308  13.3%   7.4  135s
 749890 440999   25.38616   38   57   26.38198   22.90570  13.2%   7.4  140s
 773170 453040   23.47704   29   67   26.38198   22.93223  13.1%   7.4  145s
 802034 467890     cutoff   40        26.38198   22.96250  13.0%   7.4  150s
 832218 483330   23.24263   31   71   26.38198   22.99496  12.8%   7.4  155s
H856745 495689                      26.3819807   23.02010  12.7%   7.4  159s
H856746 495689                      26.3819805   23.02010  12.7%   7.4  159s
 857623 496584   26.17825   48   50   26.38198   23.02099  12.7%   7.4  160s
 879127 507768   25.10869   31   68   26.38198   23.04223  12.7%   7.4  165s
 909026 523095   26.35067   38   55   26.38198   23.07009  12.6%   7.4  170s
 932729 535191   23.98266   34   64   26.38198   23.09179  12.5%   7.4  175s
 961979 549970   24.95433   32   76   26.38198   23.11713  12.4%   7.3  180s
 995296 566859   24.30194   35   61   26.38198   23.14530  12.3%   7.3  185s
 1024504 581142   26.35757   43   56   26.38198   23.16932  12.2%   7.3  190s
 1046860 592419   25.51917   35   60   26.38198   23.18853  12.1%   7.3  195s
 1076106 606581   24.36898   35   67   26.38198   23.21073  12.0%   7.3  200s
 1105662 621188   24.18070   34   58   26.38198   23.23358  11.9%   7.3  205s
 1129143 632485   24.70733   37   59   26.38198   23.25132  11.9%   7.3  210s
 1158559 646507   24.92691   35   61   26.38198   23.27333  11.8%   7.3  215s
 1188078 660772   25.44123   35   61   26.38198   23.29435  11.7%   7.3  220s
 1214526 673678   25.05860   36   59   26.38198   23.31179  11.6%   7.3  225s
 1243047 687165   26.16899   30   76   26.38198   23.33071  11.6%   7.3  230s
 1269872 700219   24.82575   34   57   26.38198   23.34847  11.5%   7.3  235s
 1296402 712906   24.70747   31   67   26.38198   23.36654  11.4%   7.3  240s
 1320173 724061   24.56097   32   64   26.38198   23.38201  11.4%   7.3  245s
 1347360 736676   25.09162   33   65   26.38198   23.39792  11.3%   7.3  250s
 1376501 750253   25.20964   42   58   26.38198   23.41601  11.2%   7.3  255s
 1404376 763248     cutoff   43        26.38198   23.43226  11.2%   7.3  260s
 1431467 775747   24.85780   35   64   26.38198   23.44853  11.1%   7.3  265s
 1458794 788562   24.10146   33   62   26.38198   23.46387  11.1%   7.3  270s
 1482608 799277   25.30699   29   75   26.38198   23.47636  11.0%   7.3  275s
 1509169 811370   25.64486   37   68   26.38198   23.49154  11.0%   7.3  280s
 1536043 823576   25.11874   35   64   26.38198   23.50549  10.9%   7.3  285s
 1564556 835965   24.64852   33   64   26.38198   23.52034  10.8%   7.3  290s
 1591756 848030   24.55319   26   74   26.38198   23.53433  10.8%   7.3  295s
 1619749 860411   25.68844   46   49   26.38198   23.54936  10.7%   7.3  300s

Explored 1620824 nodes (11816997 simplex iterations) in 300.01 seconds (622.82 work units)
Thread count was 8 (of 52 available processors)

Solution count 8: 26.382 26.4241 26.5686 ... 60

Time limit reached
Warning: max constraint violation (9.7125e-06) exceeds tolerance
Best objective 2.638198053145e+01, best bound 2.354987411596e+01, gap 10.7350%

User-callback calls 3257267, time in user-callback 4.58 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation without cut
The obj is 26.381980531445613.
The root upper bound is: 26.56858636930567, lower bound is: 10.547204560126346. The root gap is: 60.302%. Runtime: 300.0090889930725.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 241 rows, 244 columns and 723 nonzeros
Model fingerprint: 0xf34d6a36
Model has 486 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 124 continuous, 120 integer (120 binary)
Coefficient statistics:
  Matrix range     [4e-04, 2e+01]
  QMatrix range    [1e-08, 1e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [8e-02, 7e+01]
  QObjective range [7e-02, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e+00, 5e+00]
Found heuristic solution: objective 60.0000000
Warning: diagonal adjustment of 1.7e-08 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 241 rows, 244 columns, 723 nonzeros
Presolved model has 486 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 124 continuous, 120 integer (120 binary)

Root relaxation: objective 1.356468e+01, 625 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   13.56468    0   74   60.00000   13.56468  77.4%     -    0s
H    0     0                      32.9599394   13.56468  58.8%     -    0s
H    0     0                      32.8637511   13.56468  58.7%     -    0s
     0     0   13.56477    0   82   32.86375   13.56477  58.7%     -    0s
H    0     0                      30.9023355   13.56477  56.1%     -    0s
H    0     0                      27.3866902   13.56477  50.5%     -    0s
     0     0   13.56477    0   82   27.38669   13.56477  50.5%     -    0s
H    0     0                      26.5250334   13.56477  48.9%     -    0s
     0     2   13.56477    0   82   26.52503   13.56477  48.9%     -    0s
H   37    40                      26.3819928   13.56507  48.6%  30.8    0s
H   64    80                      26.3819921   13.56511  48.6%  25.5    0s
H   78    80                      26.3819822   13.56511  48.6%  23.4    0s
 44261 30522   20.99186   26   73   26.38198   19.81457  24.9%   7.1    5s
 116022 77636   25.90075   45   53   26.38198   20.97265  20.5%   6.7   10s
 185274 121529   23.65255   35   62   26.38198   21.50226  18.5%   6.4   15s
 252812 162889   26.11275   36   55   26.38198   21.83350  17.2%   6.3   20s
 322789 204880   25.18652   39   59   26.38198   22.08157  16.3%   6.1   25s
 390702 244259   25.85749   32   64   26.38198   22.27498  15.6%   6.0   30s
 453521 280378   23.34473   32   67   26.38198   22.42399  15.0%   6.0   35s
 523759 319579   24.05492   34   66   26.38198   22.56297  14.5%   5.9   40s
 591511 357783   24.01728   30   69   26.38198   22.67984  14.0%   5.9   45s
 661845 396420   25.61643   39   58   26.38198   22.79428  13.6%   5.8   50s
 730980 433835   25.93584   42   58   26.38198   22.89246  13.2%   5.8   55s
 800534 470744   25.37207   38   60   26.38198   22.98223  12.9%   5.8   60s
 865900 505275     cutoff   38        26.38198   23.05897  12.6%   5.8   65s
 934827 540961   24.31160   33   62   26.38198   23.13338  12.3%   5.7   70s
 1005155 576541   24.01041   29   64   26.38198   23.20315  12.0%   5.7   75s
 1070881 609490   25.90983   32   70   26.38198   23.26310  11.8%   5.7   80s
 1140864 644490   25.70234   37   63   26.38198   23.32091  11.6%   5.7   85s
 1208488 678115   23.65477   29   68   26.38198   23.37301  11.4%   5.7   90s
 1282123 713420   25.05991   26   75   26.38198   23.42742  11.2%   5.6   95s
 1349616 745317   23.68414   32   65   26.38198   23.47334  11.0%   5.6  100s
 1412548 775090   24.90306   32   67   26.38198   23.51451  10.9%   5.6  105s
 1482260 807799   25.49815   41   58   26.38198   23.55885  10.7%   5.6  110s
 1551958 839752   23.98301   28   68   26.38198   23.60017  10.5%   5.6  115s
 1622691 870925   24.37361   29   63   26.38198   23.63991  10.4%   5.6  120s
 1685833 899593   25.50298   44   53   26.38198   23.67483  10.3%   5.6  125s
 1754845 930076   24.21310   33   66   26.38198   23.71116  10.1%   5.6  130s
 1818394 958077   24.58702   30   65   26.38198   23.74325  10.0%   5.6  135s
 1888767 988714   24.97002   36   60   26.38198   23.77641  9.88%   5.5  140s
 1958137 1018195   26.18328   45   51   26.38198   23.80740  9.76%   5.5  145s
 2021427 1045418   25.63552   39   59   26.38198   23.83550  9.65%   5.5  150s
 2089112 1074083   25.75492   32   63   26.38198   23.86458  9.54%   5.5  155s
 2160716 1104150   24.10488   32   66   26.38198   23.89448  9.43%   5.5  160s
 2230660 1133348     cutoff   42        26.38198   23.92206  9.32%   5.5  165s
 2295614 1160394   24.42821   32   63   26.38198   23.94691  9.23%   5.5  170s
 2364865 1188366   24.97875   37   66   26.38198   23.97306  9.13%   5.5  175s
 2430336 1214453   25.76914   36   58   26.38198   23.99731  9.04%   5.5  180s
 2503400 1243632   25.02577   32   67   26.38198   24.02370  8.94%   5.5  185s
 2576475 1272185   25.23373   39   59   26.38198   24.04895  8.84%   5.5  190s
 2644172 1298403   24.07296   29   62   26.38198   24.07126  8.76%   5.5  195s
 2709185 1323705   25.25365   35   62   26.38198   24.09237  8.68%   5.5  200s
 2777810 1349592   25.92213   39   57   26.38198   24.11369  8.60%   5.5  205s
 2844735 1374205   26.21295   34   72   26.38198   24.13412  8.52%   5.5  210s
 2914024 1400074   24.26756   33   71   26.38198   24.15478  8.44%   5.5  215s
 2984273 1426084   24.55083   35   62   26.38198   24.17519  8.36%   5.5  220s
 3048883 1449238   26.29425   43   54   26.38198   24.19405  8.29%   5.5  225s
 3120424 1475064   25.75048   34   63   26.38198   24.21455  8.22%   5.4  230s
 3189745 1499513     cutoff   31        26.38198   24.23376  8.14%   5.4  235s
 3256475 1522709   25.67981   38   64   26.38198   24.25180  8.07%   5.4  240s
 3324781 1545810   25.08790   41   56   26.38198   24.26984  8.01%   5.4  245s
 3389011 1566963   25.10951   30   77   26.38198   24.28625  7.94%   5.4  250s
 3456321 1590164   25.90852   34   69   26.38198   24.30365  7.88%   5.4  255s
 3530328 1614675   25.68035   39   59   26.38198   24.32200  7.81%   5.4  260s
 3596996 1636285   24.60916   30   68   26.38198   24.33779  7.75%   5.4  265s
 3667729 1659098   26.21228   42   57   26.38198   24.35454  7.68%   5.4  270s
 3740611 1682423   25.65099   33   62   26.38198   24.37146  7.62%   5.4  275s
 3801555 1701424   26.07200   38   54   26.38198   24.38533  7.57%   5.4  280s
 3870779 1722797   25.72646   36   58   26.38198   24.40027  7.51%   5.4  285s
 3939941 1744364   25.35473   37   63   26.38198   24.41569  7.45%   5.4  290s
 4005507 1764468   24.68892   30   73   26.38198   24.43005  7.40%   5.4  295s
 4075849 1785502   26.08788   36   61   26.38198   24.44485  7.34%   5.4  300s

Explored 4076489 nodes (21976615 simplex iterations) in 300.00 seconds (553.71 work units)
Thread count was 8 (of 52 available processors)

Solution count 7: 26.382 26.525 27.3867 ... 60

Time limit reached
Warning: max constraint violation (7.5543e-06) exceeds tolerance
Best objective 2.638198215207e+01, best bound 2.444496513419e+01, gap 7.3422%

User-callback calls 8175369, time in user-callback 11.47 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_test_job3.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
26.381982152066165
The root upper bound is: 26.525033355117834, lower bound is: 13.564769115036839. The root gap is: 48.8605%. Runtime: 300.00574493408203.
--------------------------------------------------
    m    n  dataset  ...       end_gap  node_count        time
0   3   50  autompg  ...  0.000000e+00       165.0    0.096252
1   3   50  autompg  ...  3.744421e-05       680.0    0.179711
2   3   50  autompg  ...  1.065241e-05       766.0    0.142551
3   3   60  autompg  ...  0.000000e+00      1760.0    0.177319
4   3   60  autompg  ...  9.114340e-06      4511.0    0.503859
5   3   60  autompg  ...  1.274538e-05      3732.0    0.458886
6   3   70  autompg  ...  0.000000e+00      4376.0    0.262429
7   3   70  autompg  ...  5.833552e-05      9286.0    0.844768
8   3   70  autompg  ...  9.437327e-05     10161.0    0.872717
9   3   80  autompg  ...  0.000000e+00     41269.0    1.836254
10  3   80  autompg  ... -1.848882e-10    101969.0    7.174598
11  3   80  autompg  ... -1.848765e-10    203387.0   11.126156
12  3   90  autompg  ...  0.000000e+00    116639.0    4.953528
13  3   90  autompg  ...  4.334226e-05    220871.0   12.318489
14  3   90  autompg  ...  2.736805e-06    262312.0   14.337853
15  3  100  autompg  ...  0.000000e+00    128209.0    5.863274
16  3  100  autompg  ...  0.000000e+00    221118.0   18.217806
17  3  100  autompg  ...  5.146182e-05    718481.0   48.893445
18  3  120  autompg  ...  1.536560e-05   4033743.0  198.545901
19  3  120  autompg  ...  1.073500e-01   1620824.0  300.009089
20  3  120  autompg  ...  7.342197e-02   4076489.0  300.005745

[21 rows x 12 columns]
[3, 150, 'autompg']
[0.00173866 0.00296005 0.00449461 1.         1.        ]
The relaxed obj is 0.11780138822503261.
The larges value of x is 2.368682823920138
Use new Big-M 4.737365647840276.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 300 rows, 303 columns and 600 nonzeros
Model fingerprint: 0xe9ab2dcc
Model has 606 quadratic objective terms
Variable types: 153 continuous, 150 integer (150 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [2e-02, 8e+01]
  QObjective range [7e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 75.0000000
Presolve time: 0.00s
Presolved: 300 rows, 303 columns, 600 nonzeros
Presolved model has 606 quadratic objective terms
Variable types: 153 continuous, 150 integer (150 binary)

Root relaxation: objective 1.587536e+01, 648 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   15.87536    0  109   75.00000   15.87536  78.8%     -    0s
H    0     0                      39.6762003   15.87536  60.0%     -    0s
H    0     0                      39.5886266   15.87536  59.9%     -    0s
H    0     0                      38.7425034   15.87536  59.0%     -    0s
H    0     0                      38.5543916   15.87536  58.8%     -    0s
H    0     0                      38.2604401   15.87536  58.5%     -    0s
     0     0   15.92968    0  109   38.26044   15.92968  58.4%     -    0s
H    0     0                      38.0538048   15.92968  58.1%     -    0s
     0     2   15.92968    0  109   38.05380   15.92968  58.1%     -    0s
 55433 44460   29.65818   31   96   38.05380   25.16376  33.9%   8.3    5s
 125950 100427   28.94336   30   99   38.05380   26.31444  30.8%   8.2   10s
 197617 156835   35.33996   40   89   38.05380   26.88907  29.3%   8.0   15s
 263858 208348   32.52617   35   96   38.05380   27.28035  28.3%   7.9   20s
 338455 265179   32.41282   36   88   38.05380   27.59640  27.5%   7.8   25s
 412245 321802   30.31597   34   91   38.05380   27.84916  26.8%   7.8   30s
 484008 376466   31.61131   33   97   38.05380   28.05526  26.3%   7.7   35s
 559156 434893   30.50881   30  101   38.05380   28.21896  25.8%   7.7   40s
 626821 486468   37.25903   54   77   38.05380   28.35564  25.5%   7.7   45s
 699463 542388   37.19438   49   82   38.05380   28.48550  25.1%   7.6   50s
 772988 598594   33.42634   39   81   38.05380   28.60124  24.8%   7.6   55s
 842290 651416     cutoff   57        38.05380   28.70223  24.6%   7.6   60s
 917425 707829   32.34504   31   98   38.05380   28.79887  24.3%   7.6   65s
 987669 760757   35.24413   43   88   38.05380   28.88243  24.1%   7.6   70s
 1059895 815100   31.05819   31   99   38.05380   28.96353  23.9%   7.5   75s
 1136588 872367   30.43331   32   91   38.05380   29.03977  23.7%   7.5   80s
 1206196 924089   35.27301   45   84   38.05380   29.10610  23.5%   7.5   85s
 1279187 979316   35.40219   40   91   38.05380   29.17352  23.3%   7.5   90s
 1355090 1034678   36.88941   39   89   38.05380   29.23888  23.2%   7.5   95s
 1428476 1089858   37.97588   45   85   38.05380   29.29841  23.0%   7.5  100s
 1504251 1146499   34.13051   33   97   38.05380   29.35839  22.9%   7.4  105s
 1572104 1196985   36.92888   41   88   38.05380   29.40813  22.7%   7.4  110s
 1648890 1253104   36.95287   41   91   38.05380   29.46298  22.6%   7.4  115s
 1728662 1311135   34.91795   43   82   38.05380   29.51900  22.4%   7.4  120s
 1799962 1363141   37.00070   45   85   38.05380   29.56579  22.3%   7.4  125s
 1875562 1418253   36.38531   49   81   38.05380   29.61631  22.2%   7.4  130s
 1941922 1467607   31.11713   34   86   38.05380   29.65427  22.1%   7.4  135s
 2018726 1523814   33.34428   35   99   38.05380   29.69818  22.0%   7.4  140s
 2086384 1573686   35.80252   41   92   38.05380   29.73203  21.9%   7.4  145s
 2162415 1628811   37.85939   50   69   38.05380   29.77307  21.8%   7.4  150s
 2237180 1683604   35.69389   42   81   38.05380   29.81071  21.7%   7.4  155s
 2310432 1736781   34.78639   43   82   38.05380   29.84745  21.6%   7.3  160s
 2386602 1792541   35.32979   40   83   38.05380   29.88417  21.5%   7.3  165s
 2460304 1846274   33.67348   35   96   38.05380   29.91544  21.4%   7.3  170s
 2528295 1895343   34.54062   38   91   38.05380   29.94578  21.3%   7.3  175s
 2608256 1954406   34.51077   38   90   38.05380   29.97862  21.2%   7.3  180s
 2681179 2007885   37.09192   51   78   38.05380   30.00820  21.1%   7.3  185s
 2754538 2061007   35.27452   44   88   38.05380   30.03814  21.1%   7.3  190s
 2828162 2114273   31.22672   34   91   38.05380   30.06727  21.0%   7.3  195s
 2904039 2168636   34.07530   40   92   38.05380   30.09625  20.9%   7.3  200s
 2981135 2224805     cutoff   43        38.05380   30.12520  20.8%   7.3  205s
 3053447 2276776   35.46238   47   72   38.05380   30.15206  20.8%   7.3  210s
 3132634 2334067   35.01393   40   78   38.05380   30.18122  20.7%   7.3  215s
 3202077 2384394   32.23268   31  100   38.05380   30.20512  20.6%   7.3  220s
 3278545 2438628   35.08174   42   89   38.05380   30.23156  20.6%   7.3  225s
 3350463 2490601   35.86870   49   75   38.05380   30.25587  20.5%   7.3  230s
 3430723 2547784   35.33183   40   92   38.05380   30.28300  20.4%   7.3  235s
 3511461 2605547   35.13947   40   91   38.05380   30.30884  20.4%   7.3  240s
 3580918 2655329   36.09758   46   76   38.05380   30.33038  20.3%   7.3  245s
 3655811 2709300   34.86362   41   90   38.05380   30.35355  20.2%   7.3  250s
 3733247 2764472   34.50840   45   85   38.05380   30.37704  20.2%   7.2  255s
 3803352 2814504   32.98193   32   96   38.05380   30.39731  20.1%   7.2  260s
 3888965 2875705   37.94184   48   80   38.05380   30.42115  20.1%   7.2  265s
 3969354 2933273   33.20161   36   93   38.05380   30.44350  20.0%   7.2  270s
 4050680 2991067   30.76003   29  101   38.05380   30.46532  19.9%   7.2  275s
 4130678 3048657   33.07823   37   95   38.05380   30.48716  19.9%   7.2  280s
 4205097 3101399   33.15754   33   99   38.05380   30.50636  19.8%   7.2  285s
 4285444 3158763   37.67638   45   80   38.05380   30.52730  19.8%   7.2  290s
 4360436 3211713   37.75301   51   78   38.05380   30.54649  19.7%   7.2  295s
 4440376 3268202   32.04675   29  103   38.05380   30.56651  19.7%   7.2  300s

Explored 4440530 nodes (32030767 simplex iterations) in 300.00 seconds (606.16 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 38.0538 38.2604 39.5886 75 

Time limit reached
Best objective 3.805380479778e+01, best bound 3.056651406081e+01, gap 19.6755%

User-callback calls 8911912, time in user-callback 12.56 sec
--------------------------------
solve the problem in original formulation
The obj is 38.05380479777608.
The root upper bound is: 38.05380479777608, lower bound is: 15.92968179163551. The root gap is: 58.1391%. Runtime: 300.00300002098083.
[ 25  26  28  30  54  70  84 102 107 114 130 131 141 144 145 146]
Number of outliers: 16
--------------------------------
The decomposition time is 0.27224058378487825.
Optimal value: 0.9891789529039753
The decomposition time is 0.24201624561101198.
Optimal value: 25.931554449842636
The decomposition time is 0.3438010038807988.
Optimal value: 15.76524632728573
The best pair is: [[0, 2]]
------------------------
The decomposition time is 0.24190132692456245.
Optimal value: 25.931554449842636
[3, 200, 'autompg']
[0.00138762 0.00204665 0.00331983 1.         1.        ]
The relaxed obj is 0.15733341651267096.
The larges value of x is 2.3405596828329456
Use new Big-M 4.681119365665891.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 400 rows, 403 columns and 800 nonzeros
Model fingerprint: 0x5625a5d2
Model has 806 quadratic objective terms
Variable types: 203 continuous, 200 integer (200 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [4e-02, 9e+01]
  QObjective range [3e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 100.0000000
Presolve time: 0.00s
Presolved: 400 rows, 403 columns, 800 nonzeros
Presolved model has 806 quadratic objective terms
Variable types: 203 continuous, 200 integer (200 binary)

Root relaxation: objective 2.403982e+01, 909 iterations, 0.02 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   24.03982    0  162  100.00000   24.03982  76.0%     -    0s
H    0     0                      62.2761794   24.03982  61.4%     -    0s
H    0     0                      61.8680766   24.03982  61.1%     -    0s
H    0     0                      59.1556519   24.03982  59.4%     -    0s
     0     0   24.03982    0  162   59.15565   24.03982  59.4%     -    0s
H    0     0                      58.5455276   24.03982  58.9%     -    0s
H    0     0                      58.5279423   24.03982  58.9%     -    0s
H    0     2                      58.5204506   24.03982  58.9%     -    0s
     0     2   24.03982    0  162   58.52045   24.03982  58.9%     -    0s
 40914 35798   48.61333   44  128   58.52045   31.89045  45.5%   7.8    5s
 92129 81318   37.07309   26  144   58.52045   33.06035  43.5%   7.6   10s
 149533 133373   48.58410   48  123   58.52045   33.68246  42.4%   7.6   15s
 208410 185206   41.75298   34  137   58.52045   34.21237  41.5%   7.4   20s
 258496 230139   50.41875   49  123   58.52045   34.50922  41.0%   7.4   25s
 320547 284479   43.08039   37  134   58.52045   34.86874  40.4%   7.3   30s
 377340 334394   41.06881   30  143   58.52045   35.10447  40.0%   7.3   35s
 432116 383171   39.07271   30  145   58.52045   35.28657  39.7%   7.3   40s
 487576 433445   47.76618   42  133   58.52045   35.41388  39.5%   7.3   45s
 547268 485863   41.87858   32  143   58.52045   35.58452  39.2%   7.2   50s
 604261 535961   37.03186   29  143   58.52045   35.73186  38.9%   7.2   55s
 661782 586851   47.33329   42  129   58.52045   35.84998  38.7%   7.2   60s
 720485 638718   42.15542   36  143   58.52045   35.96192  38.5%   7.2   65s
 774045 685918   45.20689   37  136   58.52045   36.06483  38.4%   7.2   70s
 832563 737877   49.17875   44  136   58.52045   36.15279  38.2%   7.2   75s
 894218 791708   40.63973   29  146   58.52045   36.24834  38.1%   7.1   80s
 947091 838021   40.43043   33  141   58.52045   36.32265  37.9%   7.1   85s
 1004806 888949   45.88058   41  131   58.52045   36.39788  37.8%   7.1   90s
 1064989 941829   55.49662   67  101   58.52045   36.47236  37.7%   7.1   95s
 1119231 989682   51.30245   52  127   58.52045   36.53421  37.6%   7.1  100s
 1175029 1039759   50.00390   51  120   58.52045   36.59329  37.5%   7.1  105s
 1239445 1095653   54.06426   58  114   58.52045   36.67237  37.3%   7.1  110s
 1301276 1150141   43.36354   34  139   58.52045   36.73860  37.2%   7.1  115s
 1355091 1197722   41.71212   36  138   58.52045   36.79241  37.1%   7.1  120s
 1416210 1251447   38.03748   30  144   58.52045   36.85270  37.0%   7.0  125s
 1479264 1306300   49.85657   43  131   58.52045   36.91657  36.9%   7.0  130s
 1535517 1356143   41.63169   30  145   58.52045   36.95874  36.8%   7.0  135s
 1595150 1408199   58.35956   59  110   58.52045   37.00322  36.8%   7.0  140s
 1653837 1460451   57.75159   77   95   58.52045   37.04669  36.7%   7.0  145s
 1705873 1507083   55.66642   58  113   58.52045   37.08525  36.6%   7.0  150s
 1770066 1564067   42.41224   36  136   58.52045   37.13111  36.6%   7.0  155s
 1827506 1614370   47.10865   38  131   58.52045   37.17144  36.5%   7.0  160s
 1882784 1663133   56.89570   69  101   58.52045   37.21088  36.4%   7.0  165s
 1946877 1719223   51.50650   52  120   58.52045   37.25220  36.3%   7.0  170s
 2005788 1771797   50.41450   45  126   58.52045   37.28842  36.3%   7.0  175s
 2059310 1817882   57.56806   55  116   58.52045   37.32060  36.2%   7.0  180s
 2116646 1869519   53.55922   50  121   58.52045   37.35064  36.2%   7.0  185s
 2181819 1925833   57.13444   71  103   58.52045   37.39037  36.1%   7.0  190s
 2235378 1972999   42.20364   35  138   58.52045   37.41833  36.1%   7.0  195s
 2293851 2024996   55.22669   62  106   58.52045   37.44866  36.0%   7.0  200s
 2356956 2079904   57.10059   71  100   58.52045   37.48433  35.9%   7.0  205s
 2413051 2129321   51.04690   52  118   58.52045   37.51380  35.9%   7.0  210s
 2474203 2182617   39.18173   30  140   58.52045   37.54570  35.8%   7.0  215s
 2533320 2234482   57.20656   57  115   58.52045   37.57607  35.8%   7.0  220s
 2589761 2283984   57.86349   64  108   58.52045   37.60293  35.7%   7.0  225s
 2646114 2333766   43.22836   33  139   58.52045   37.62785  35.7%   7.0  230s
 2705550 2386368   43.86508   35  140   58.52045   37.65467  35.7%   6.9  235s
 2763894 2437424   57.10906   71  102   58.52045   37.68238  35.6%   6.9  240s
 2825074 2491322   54.14952   51  117   58.52045   37.70802  35.6%   6.9  245s
 2883985 2543336   45.51365   41  130   58.52045   37.73258  35.5%   6.9  250s
 2938057 2590003   55.02727   58  110   58.52045   37.75453  35.5%   6.9  255s
 3003486 2646747   42.88513   34  138   58.52045   37.78242  35.4%   6.9  260s
 3065358 2701549   43.33838   36  134   58.52045   37.80652  35.4%   6.9  265s
 3120486 2750732   53.92451   51  118   58.52045   37.82755  35.4%   6.9  270s
 3181395 2804244   54.83510   56  117   58.52045   37.85015  35.3%   6.9  275s
 3240912 2856939   45.78459   39  132   58.52045   37.87211  35.3%   6.9  280s
 3297343 2905988   47.80845   44  125   58.52045   37.89326  35.2%   6.9  285s
 3359644 2960540   40.16258   31  144   58.52045   37.91723  35.2%   6.9  290s
 3421473 3014445   47.16291   42  132   58.52045   37.94081  35.2%   6.9  295s
 3476382 3062325   47.40968   46  127   58.52045   37.96047  35.1%   6.9  300s

Explored 3477159 nodes (24041158 simplex iterations) in 300.01 seconds (775.16 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 58.5205 58.5279 59.1557 ... 100

Time limit reached
Best objective 5.852045061447e+01, best bound 3.796075660639e+01, gap 35.1325%

User-callback calls 6983606, time in user-callback 9.37 sec
--------------------------------
solve the problem in original formulation
The obj is 58.5204506144671.
The root upper bound is: 58.52794227008117, lower bound is: 24.03981807332005. The root gap is: 58.9259%. Runtime: 300.0068898200989.
[ 28  30  54  70  84 102 107 114 116 127 131 139 140 144 145 151 167 181 182 185 186 197 198]
Number of outliers: 23
--------------------------------
The decomposition time is 0.561576365493238.
Optimal value: 1.016464642868366
The decomposition time is 0.6818283228203654.
Optimal value: 29.257301952244084
The decomposition time is 0.7133947471156716.
Optimal value: 18.77578334784359
The best pair is: [[0, 2]]
------------------------
The decomposition time is 0.6449302555993199.
Optimal value: 29.257301952244084
24.039823852340703
29.678213427650306
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 400 rows, 404 columns and 800 nonzeros
Model fingerprint: 0x31abeebf
Model has 806 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 204 continuous, 200 integer (200 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  QMatrix range    [1e-08, 1e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [4e-02, 9e+01]
  QObjective range [1e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 100.0000000
Warning: diagonal adjustment of 1.9e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 400 rows, 404 columns, 800 nonzeros
Presolved model has 806 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 204 continuous, 200 integer (200 binary)

Root relaxation: objective -6.163427e+00, 949 iterations, 0.02 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   -6.16343    0  158  100.00000   -6.16343   106%     -    0s
H    0     0                      75.1436603   -6.16343   108%     -    0s
H    0     0                      75.0670943   -6.16343   108%     -    0s
     0     0   19.45855    0  160   75.06709   19.45855  74.1%     -    0s
H    0     0                      64.3107336   19.45855  69.7%     -    0s
H    0     0                      60.0623419   19.45855  67.6%     -    0s
     0     0   21.13573    0  161   60.06234   21.13573  64.8%     -    0s
H    0     0                      59.4205831   21.13573  64.4%     -    0s
     0     0   23.05540    0  163   59.42058   23.05540  61.2%     -    0s
     0     0   23.77742    0  160   59.42058   23.77742  60.0%     -    0s
H    0     0                      59.3962974   23.77742  60.0%     -    0s
     0     0   23.88524    0  161   59.39630   23.88524  59.8%     -    0s
     0     0   23.97292    0  163   59.39630   23.97292  59.6%     -    0s
     0     0   23.99331    0  162   59.39630   23.99331  59.6%     -    0s
     0     0   23.99331    0  162   59.39630   23.99331  59.6%     -    0s
     0     2   23.99331    0  162   59.39630   23.99331  59.6%     -    0s
H   71    80                      58.8290787   26.95519  54.2%   8.2    0s
H   73    80                      58.7004443   26.95519  54.1%   8.2    0s
H 1185  1226                      58.7003070   26.95519  54.1%   5.7    0s
H 1448  1364                      58.7003069   27.30722  53.5%   6.2    1s
H 1494  1333                      58.6182003   27.30722  53.4%   7.0    1s
H 1604  1342                      58.6182003   27.38831  53.3%   7.3    1s
H 1608  1279                      58.6182002   27.38831  53.3%   7.3    1s
H 1610  1219                      58.6181998   27.38831  53.3%   7.3    1s
H 2614  1806                      58.6181951   27.38831  53.3%   7.7    1s
H 2620  1751                      58.6181918   27.38831  53.3%   7.7    1s
H 3691  2283                      58.6181875   27.71704  52.7%   7.8    2s
 15457 12758   45.52426   40  133   58.61819   29.87503  49.0%   8.5    5s
H16622 13550                      58.6181854   29.92602  48.9%   8.6    5s
H16686 13782                      58.5204678   29.92602  48.9%   8.6    5s
H16946 13790                      58.5204616   29.92602  48.9%   8.6    7s
H16947 13790                      58.5204508   29.92602  48.9%   8.6    7s
H16949 13790                      58.5204502   29.92602  48.9%   8.6    7s
H18248 15201                      58.5204444   30.02445  48.7%   8.6    7s
H19928 16922                      58.5204441   30.02445  48.7%   8.6    7s
H21441 17843                      58.5204437   30.41913  48.0%   8.5    8s
 28819 24643   46.76620   38  127   58.52044   30.86233  47.3%   8.5   10s
 47695 41641   37.04668   23  149   58.52044   31.53950  46.1%   8.7   15s
 68845 59930   58.16682   84   85   58.52044   32.08794  45.2%   8.6   20s
 89928 78205   53.23321   64  106   58.52044   32.50848  44.4%   8.5   25s
H91984 79171                      58.5204431   32.53739  44.4%   8.5   25s
H94348 81193                      58.5204426   32.58056  44.3%   8.5   26s
 111208 96268   55.28968   58  116   58.52044   32.82909  43.9%   8.5   30s
 134849 116352   36.68670   26  149   58.52044   33.11526  43.4%   8.5   35s
 157357 135273   49.81411   44  129   58.52044   33.36863  43.0%   8.4   40s
 174361 150534   58.17370   91   79   58.52044   33.46815  42.8%   8.5   45s
 191316 165827   54.78924   82   92   58.52044   33.56611  42.6%   8.5   50s
 204844 177784   52.04812   48  126   58.52044   33.63813  42.5%   8.5   55s
 224408 194317   45.13407   37  134   58.52044   33.78756  42.3%   8.5   60s
 242413 210108   52.73857   66  106   58.52044   33.88114  42.1%   8.5   65s
 262500 227012   54.93538   82   90   58.52044   34.00858  41.9%   8.5   70s
 285503 246505   41.77344   33  133   58.52044   34.11583  41.7%   8.4   75s
 305509 263293   42.99035   36  132   58.52044   34.20822  41.5%   8.4   80s
 323734 279706   56.42130   75   93   58.52044   34.27024  41.4%   8.4   85s
 341357 295361   57.65024   86   84   58.52044   34.32731  41.3%   8.5   90s
 361415 311912   51.77854   51  117   58.52044   34.40926  41.2%   8.4   95s
 376989 325055   57.58598   92   78   58.52044   34.46648  41.1%   8.4  100s
 396168 341267   42.28825   33  138   58.52044   34.52357  41.0%   8.4  105s
 416677 358777   48.75220   45  123   58.52044   34.59326  40.9%   8.4  110s
 433577 373876   46.41013   43  125   58.52044   34.63541  40.8%   8.4  115s
 452337 389625   40.66515   34  138   58.52044   34.69662  40.7%   8.3  120s
 471683 406007   48.21145   44  126   58.52044   34.74641  40.6%   8.3  125s
 488706 420885   52.79950   70   99   58.52044   34.78359  40.6%   8.3  130s
 508909 438260   52.46716   58  114   58.52044   34.83140  40.5%   8.3  135s
 524089 451032   36.33154   23  151   58.52044   34.87107  40.4%   8.3  140s
 542651 466368   37.86905   28  144   58.52044   34.91835  40.3%   8.3  145s
 561814 482516   51.38612   59  112   58.52044   34.96883  40.2%   8.3  150s
 579391 497920   44.01421   37  135   58.52044   35.00247  40.2%   8.3  155s
 597701 513628   39.14596   30  138   58.52044   35.04208  40.1%   8.3  160s
 617210 530386   55.13985   74   97   58.52044   35.08290  40.1%   8.3  165s
 636121 546350   54.44938   63  115   58.52044   35.12891  40.0%   8.3  170s
 653775 561190   57.83239   90   82   58.52044   35.16472  39.9%   8.3  175s
 673499 578308   56.79141   88   80   58.52044   35.20048  39.8%   8.3  180s
 690649 593169   46.86907   46  125   58.52044   35.23666  39.8%   8.2  185s
 713426 611966   47.95935   44  129   58.52044   35.27995  39.7%   8.2  190s
 733270 628488   53.50406   75   97   58.52044   35.31905  39.6%   8.2  195s
 753931 645512   51.58810   58  116   58.52044   35.35852  39.6%   8.2  200s
 773577 661949   36.42557   24  144   58.52044   35.39171  39.5%   8.2  205s
 797629 681646   50.70791   54  120   58.52044   35.43039  39.5%   8.2  210s
 817711 699290   46.98586   38  135   58.52044   35.45892  39.4%   8.2  215s
 836080 713944   41.13832   34  136   58.52044   35.48297  39.4%   8.2  220s
 849932 726957   53.64595   78   94   58.52044   35.50010  39.3%   8.2  225s
 868576 742717   55.84115   77   90   58.52044   35.52865  39.3%   8.2  230s
 887759 758908   52.88418   65  107   58.52044   35.55273  39.2%   8.2  235s
 907159 775320   48.73456   46  126   58.52044   35.58062  39.2%   8.2  240s
 925372 790752   38.93662   29  141   58.52044   35.60843  39.2%   8.2  245s
 944577 807292   39.71801   32  138   58.52044   35.63372  39.1%   8.2  250s
 966294 825840   37.55409   30  138   58.52044   35.66453  39.1%   8.2  255s
 985302 841665   46.37054   41  129   58.52044   35.68836  39.0%   8.2  260s
 1006058 858818   47.93039   44  125   58.52044   35.71332  39.0%   8.2  265s
 1023783 873810   42.07688   34  140   58.52044   35.73613  38.9%   8.2  270s
 1043340 890668   49.20079   41  134   58.52044   35.75693  38.9%   8.1  275s
 1064124 907642   51.99309   62  107   58.52044   35.78214  38.9%   8.1  280s
 1085314 925246   36.91098   23  149   58.52044   35.80878  38.8%   8.1  285s
 1105953 942889   46.66239   44  129   58.52044   35.83355  38.8%   8.1  290s
 1124369 958782   42.74963   34  135   58.52044   35.85124  38.7%   8.1  295s
 1144031 975505   45.00735   41  135   58.52044   35.87144  38.7%   8.1  300s

Explored 1144735 nodes (9316570 simplex iterations) in 300.01 seconds (715.03 work units)
Thread count was 8 (of 52 available processors)

Solution count 10: 58.5204 58.6182 58.7003 ... 75.1437

Time limit reached
Warning: max constraint violation (9.3029e-06) exceeds tolerance
Best objective 5.852044261646e+01, best bound 3.587212233099e+01, gap 38.7016%

User-callback calls 2305737, time in user-callback 3.16 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation without cut
The obj is 58.52044261646286.
The root upper bound is: 59.396297408173126, lower bound is: 23.9933122973421. The root gap is: 59.6047%. Runtime: 300.00954008102417.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 401 rows, 404 columns and 1203 nonzeros
Model fingerprint: 0x11bd13b0
Model has 806 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 204 continuous, 200 integer (200 binary)
Coefficient statistics:
  Matrix range     [7e-04, 1e+01]
  QMatrix range    [1e-08, 1e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [4e-02, 9e+01]
  QObjective range [1e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e+00, 3e+00]
Found heuristic solution: objective 100.0000000
Warning: diagonal adjustment of 1.9e-09 performed to make Q PSD
Warning: diagonal adjustment of 1.0e-10 performed to make Q PSD
Presolve time: 0.00s
Presolved: 401 rows, 404 columns, 1203 nonzeros
Presolved model has 806 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 204 continuous, 200 integer (200 binary)

Root relaxation: objective 2.967818e+01, 1073 iterations, 0.03 seconds (0.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   29.67818    0  148  100.00000   29.67818  70.3%     -    0s
H    0     0                      69.2603029   29.67818  57.1%     -    0s
     0     0   29.67819    0  157   69.26030   29.67819  57.1%     -    0s
H    0     0                      61.2994970   29.67819  51.6%     -    0s
     0     0   29.67819    0  157   61.29950   29.67819  51.6%     -    0s
     0     2   29.67819    0  157   61.29950   29.67819  51.6%     -    0s
H   31    40                      60.2158198   29.67821  50.7%  49.4    0s
H   33    40                      59.9962991   29.67821  50.5%  47.1    0s
H   37    40                      59.8492580   29.67821  50.4%  47.7    0s
H   77    92                      59.8491853   29.67821  50.4%  43.0    0s
H   79    92                      59.8490578   29.67821  50.4%  42.1    0s
H   83    92                      59.8490578   29.67821  50.4%  41.2    0s
H   87    92                      59.8409736   29.67823  50.4%  42.3    0s
H   90    92                      59.4912864   29.67823  50.1%  42.0    0s
H  304   347                      59.4797834   29.68129  50.1%  21.5    0s
H  328   347                      59.4381224   29.68129  50.1%  20.3    0s
H 1039  1048                      59.3205026   29.68129  50.0%   8.9    1s
H 1040  1048                      58.7405021   29.68129  49.5%   8.9    1s
H 1043  1048                      58.5299286   29.68129  49.3%   8.9    1s
H 1074  1153                      58.5248575   29.68129  49.3%   8.7    1s
H 1137  1153                      58.5214320   29.68129  49.3%   8.4    1s
H 1819  1735                      58.5204525   29.68950  49.3%   7.7    1s
H 1823  1651                      58.5204506   29.68950  49.3%   7.7    1s
H 1862  1596                      58.5204487   29.68950  49.3%   8.9    1s
H 2955  2255                      58.5204463   29.68950  49.3%   8.4    2s
 15504 12694   42.67245   44  129   58.52045   30.95372  47.1%   7.7    5s
 41525 36076   35.22991   29  146   58.52045   32.26405  44.9%   7.2   10s
 73350 63869   43.28511   44  134   58.52045   32.72098  44.1%   7.1   15s
 110076 95975   53.40269   72  104   58.52045   33.17887  43.3%   7.0   20s
 143007 125152   56.67413   91   80   58.52045   33.44540  42.8%   6.9   25s
 176778 154352   36.48334   30  146   58.52045   33.63104  42.5%   6.8   30s
 207767 181754   41.76692   41  133   58.52045   33.79777  42.2%   6.8   35s
 244453 212642   35.02650   29  168   58.52045   34.00892  41.9%   6.7   40s
H258143 224307                      58.5204454   34.07301  41.8%   6.7   41s
 273078 237576   53.93933   58  119   58.52045   34.13198  41.7%   6.7   45s
 306373 266423   55.02067   88   81   58.52045   34.26412  41.4%   6.7   50s
 336844 293057   48.02459   53  122   58.52045   34.37202  41.3%   6.6   55s
 371605 322582   45.77738   44  134   58.52045   34.49012  41.1%   6.6   60s
 405025 351084   37.35231   34  143   58.52045   34.58459  40.9%   6.6   65s
 438831 380175   55.05515   91   87   58.52045   34.67110  40.8%   6.6   70s
 468951 405467   57.19434   91   84   58.52045   34.74852  40.6%   6.5   75s
 504201 435741   45.23521   42  140   58.52045   34.83709  40.5%   6.5   80s
 537937 464401   39.44608   38  137   58.52045   34.90953  40.3%   6.5   85s
 569883 491905   41.74608   37  143   58.52045   34.96660  40.2%   6.5   90s
 604740 521553   58.16390   94   79   58.52045   35.03799  40.1%   6.4   95s
 642323 553271   38.97395   34  144   58.52045   35.11800  40.0%   6.4  100s
 670895 578043   45.36216   47  126   58.52045   35.17102  39.9%   6.4  105s
 704976 607654   42.06796   40  136   58.52045   35.22840  39.8%   6.4  110s
 741135 638512   52.38676   61  111   58.52045   35.29252  39.7%   6.4  115s
 775914 668271   58.06542   95   79   58.52045   35.34314  39.6%   6.3  120s
 808190 695809   52.96860   68  109   58.52045   35.39694  39.5%   6.3  125s
 837918 721335   43.42444   42  131   58.52045   35.43601  39.4%   6.3  130s
 873008 750825   52.38964   53  127   58.52045   35.48328  39.4%   6.3  135s
 906281 779516   41.45871   36  139   58.52045   35.52659  39.3%   6.3  140s
 940490 808700   38.60479   33  147   58.52045   35.57358  39.2%   6.3  145s
 975312 838096   50.54122   59  114   58.52045   35.62291  39.1%   6.3  150s
 1006326 864370   57.82241   96   80   58.52045   35.65846  39.1%   6.2  155s
 1041396 894378   49.19346   55  118   58.52045   35.69918  39.0%   6.2  160s
 1075528 923603   56.80813   87   93   58.52045   35.73445  38.9%   6.2  165s
 1108614 951828   39.05705   35  139   58.52045   35.76824  38.9%   6.2  170s
 1141300 980417   54.28562   84   91   58.52045   35.79763  38.8%   6.2  175s
 1171564 1005913   45.07395   48  130   58.52045   35.82419  38.8%   6.2  180s
 1204793 1034033   49.23178   58  117   58.52045   35.85874  38.7%   6.2  185s
 1236449 1061215   49.01299   50  130   58.52045   35.88500  38.7%   6.2  190s
 1266852 1088537   45.00424   42  131   58.52045   35.90715  38.6%   6.2  195s
 1299114 1116394   41.55064   38  139   58.52045   35.93638  38.6%   6.2  200s
 1332820 1145566   43.62200   42  130   58.52045   35.96925  38.5%   6.2  205s
 1363218 1171617   51.12087   54  122   58.52045   36.00222  38.5%   6.2  210s
 1396460 1199849   41.03724   38  140   58.52045   36.03188  38.4%   6.2  215s
 1431648 1229286   37.80200   33  148   58.52045   36.06307  38.4%   6.2  220s
 1464267 1258233   52.35172   63  114   58.52045   36.09050  38.3%   6.2  225s
 1495741 1284872   54.52348   58  115   58.52045   36.11477  38.3%   6.2  230s
 1530928 1314715   57.03183   91   81   58.52045   36.14209  38.2%   6.1  235s
 1558146 1338559   39.06398   32  152   58.52045   36.15886  38.2%   6.1  240s
 1593015 1367869   44.12075   47  126   58.52045   36.19065  38.2%   6.1  245s
 1627556 1397890   50.40429   59  115   58.52045   36.21665  38.1%   6.1  250s
 1665566 1430139   55.24236   56  119   58.52045   36.24657  38.1%   6.1  255s
 1702770 1462237   58.42293   96   82   58.52045   36.27074  38.0%   6.1  260s
 1732948 1488199   50.65061   62  114   58.52045   36.29504  38.0%   6.1  265s
 1768732 1518307   43.87949   42  131   58.52045   36.32324  37.9%   6.1  270s
 1800531 1546377   58.48868   93   78   58.52045   36.34210  37.9%   6.1  275s
 1833123 1574258   41.58946   38  134   58.52045   36.36312  37.9%   6.1  280s
 1866614 1603221   40.43053   35  138   58.52045   36.38329  37.8%   6.1  285s
 1901668 1633381   41.25441   41  136   58.52045   36.40515  37.8%   6.1  290s
 1928648 1656206   57.33225   94   78   58.52045   36.42089  37.8%   6.1  295s
 1962324 1684988   37.37802   35  136   58.52045   36.44145  37.7%   6.1  300s

Explored 1962642 nodes (11930642 simplex iterations) in 300.00 seconds (730.93 work units)
Thread count was 8 (of 52 available processors)

Solution count 10: 58.5204 58.7405 59.3205 ... 60.2158

Time limit reached
Warning: max constraint violation (7.4972e-06) exceeds tolerance
Best objective 5.852044541932e+01, best bound 3.644145356130e+01, gap 37.7287%

User-callback calls 3945146, time in user-callback 5.34 sec
--------------------------------------------------
Solve the problem in the proposed formulation with cut
58.52044541931568
The root upper bound is: 61.29949703393015, lower bound is: 29.6781908746904. The root gap is: 51.5849%. Runtime: 300.0049579143524.
--------------------------------------------------
    m    n  dataset  ...       end_gap  node_count        time
0   3   50  autompg  ...  0.000000e+00       165.0    0.096252
1   3   50  autompg  ...  3.744421e-05       680.0    0.179711
2   3   50  autompg  ...  1.065241e-05       766.0    0.142551
3   3   60  autompg  ...  0.000000e+00      1760.0    0.177319
4   3   60  autompg  ...  9.114340e-06      4511.0    0.503859
5   3   60  autompg  ...  1.274538e-05      3732.0    0.458886
6   3   70  autompg  ...  0.000000e+00      4376.0    0.262429
7   3   70  autompg  ...  5.833552e-05      9286.0    0.844768
8   3   70  autompg  ...  9.437327e-05     10161.0    0.872717
9   3   80  autompg  ...  0.000000e+00     41269.0    1.836254
10  3   80  autompg  ... -1.848882e-10    101969.0    7.174598
11  3   80  autompg  ... -1.848765e-10    203387.0   11.126156
12  3   90  autompg  ...  0.000000e+00    116639.0    4.953528
13  3   90  autompg  ...  4.334226e-05    220871.0   12.318489
14  3   90  autompg  ...  2.736805e-06    262312.0   14.337853
15  3  100  autompg  ...  0.000000e+00    128209.0    5.863274
16  3  100  autompg  ...  0.000000e+00    221118.0   18.217806
17  3  100  autompg  ...  5.146182e-05    718481.0   48.893445
18  3  120  autompg  ...  1.536560e-05   4033743.0  198.545901
19  3  120  autompg  ...  1.073500e-01   1620824.0  300.009089
20  3  120  autompg  ...  7.342197e-02   4076489.0  300.005745
21  3  150  autompg  ...  1.967554e-01   4440530.0  300.003000
22  3  200  autompg  ...  3.513249e-01   3477159.0  300.006890
23  3  200  autompg  ...  3.870155e-01   1144735.0  300.009540
24  3  200  autompg  ...  3.772868e-01   1962642.0  300.004958

[25 rows x 12 columns]
