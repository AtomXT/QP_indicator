[2, 50, 'autompg']
[0.00656781 0.00955091 1.         1.         1.        ]
Set parameter TokenServer to value "questlicense2.quest.northwestern.edu"
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
The relaxed obj is 0.041120658516909714.
The larges value of x is 1.922503564449926
Use new Big-M 3.845007128899852.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 100 rows, 102 columns and 200 nonzeros
Model fingerprint: 0x9bd40615
Model has 153 quadratic objective terms
Variable types: 52 continuous, 50 integer (50 binary)
Coefficient statistics:
  Matrix range     [1e+00, 4e+00]
  Objective range  [4e-03, 2e+01]
  QObjective range [7e-02, 5e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 25.0000000
Presolve time: 0.00s
Presolved: 100 rows, 102 columns, 200 nonzeros
Presolved model has 153 quadratic objective terms
Variable types: 52 continuous, 50 integer (50 binary)

Root relaxation: objective 6.929134e+00, 220 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    6.92913    0   31   25.00000    6.92913  72.3%     -    0s
H    0     0                      17.6662096    6.92913  60.8%     -    0s
H    0     0                      16.6830560    6.92913  58.5%     -    0s
H    0     0                      16.3604456    6.92913  57.6%     -    0s
H    0     0                      14.0444636    6.92913  50.7%     -    0s
H    0     0                      13.9316698    6.92913  50.3%     -    0s
     0     0    7.73248    0   31   13.93167    7.73248  44.5%     -    0s
H    0     0                      13.4770400    7.73248  42.6%     -    0s
     0     2    7.73248    0   31   13.47704    7.73248  42.6%     -    0s

Explored 987 nodes (6389 simplex iterations) in 0.14 seconds (0.05 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 13.477 16.3604 16.6831 ... 25

Optimal solution found (tolerance 1.00e-04)
Best objective 1.347703996995e+01, best bound 1.347703996995e+01, gap 0.0000%

User-callback calls 2226, time in user-callback 0.00 sec
--------------------------------
solve the problem in original formulation
The obj is 13.47703996995205.
The root upper bound is: 13.47703996995205, lower bound is: 7.732484220210905. The root gap is: 42.6248%. Runtime: 0.14367890357971191.
[23 25 26 27 28 29 30 31 32]
Number of outliers: 9
--------------------------------
The decomposition time is 0.128929752856493.
Optimal value: 49.99999997753413
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.03341641090810299.
Optimal value: 49.99999997753413
6.92913408249985
13.475782921687221
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 350 rows, 202 columns and 950 nonzeros
Model fingerprint: 0x7321c7fb
Model has 153 quadratic objective terms
Variable types: 52 continuous, 150 integer (150 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+03]
  Objective range  [4e-03, 2e+01]
  QObjective range [7e-02, 5e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 1e+03]
Found heuristic solution: objective 32.8773314
Presolve time: 0.00s
Presolved: 350 rows, 202 columns, 950 nonzeros
Presolved model has 153 quadratic objective terms
Variable types: 52 continuous, 150 integer (150 binary)

Root relaxation: objective 6.929134e+00, 548 iterations, 0.00 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    6.92913    0   62   32.87733    6.92913  78.9%     -    0s
H    0     0                      18.2181327    6.92913  62.0%     -    0s
H    0     0                      14.2935677    6.92913  51.5%     -    0s
H    0     0                      13.6195362    6.92913  49.1%     -    0s
     0     0    6.92913    0   65   13.61954    6.92913  49.1%     -    0s
H    0     0                      13.4770400    8.01942  40.5%     -    0s
     0     2    8.01942    0   65   13.47704    8.01942  40.5%     -    0s

Cutting planes:
  Learned: 12
  Clique: 12

Explored 185 nodes (4122 simplex iterations) in 0.20 seconds (0.12 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 13.477 13.6195 14.2936 ... 32.8773

Optimal solution found (tolerance 1.00e-04)
Best objective 1.347703996995e+01, best bound 1.347703996995e+01, gap 0.0000%

User-callback calls 661, time in user-callback 0.00 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 13.477039969952056.
The root upper bound is: 13.477039969952056, lower bound is: 8.019423532678337. The root gap is: 40.4957%. Runtime: 0.204819917678833.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 351 rows, 203 columns and 1053 nonzeros
Model fingerprint: 0xec9511a8
Model has 153 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 53 continuous, 150 integer (150 binary)
Coefficient statistics:
  Matrix range     [4e-03, 1e+03]
  QMatrix range    [4e-02, 3e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [4e-03, 2e+01]
  QObjective range [3e-10, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 1e+03]
Presolve time: 0.00s
Presolved: 351 rows, 203 columns, 1053 nonzeros
Presolved model has 153 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 53 continuous, 150 integer (150 binary)

Root relaxation: objective 1.347563e+01, 476 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   13.47563    0   24          -   13.47563      -     -    0s
H    0     0                      69.8844072   13.47563  80.7%     -    0s
H    0     0                      53.0205211   13.47563  74.6%     -    0s
     0     0   13.47565    0   20   53.02052   13.47565  74.6%     -    0s
H    0     0                      39.4777625   13.47565  65.9%     -    0s
     0     0   13.47567    0   20   39.47776   13.47567  65.9%     -    0s
     0     0   13.47567    0   26   39.47776   13.47567  65.9%     -    0s
     0     0   13.47567    0   30   39.47776   13.47567  65.9%     -    0s
     0     0   13.47567    0   32   39.47776   13.47567  65.9%     -    0s
     0     0   13.47569    0   34   39.47776   13.47569  65.9%     -    0s
     0     0   13.47570    0   34   39.47776   13.47570  65.9%     -    0s
     0     0   13.47570    0   34   39.47776   13.47570  65.9%     -    0s
     0     0   13.47570    0   34   39.47776   13.47570  65.9%     -    0s
     0     0   13.47570    0   34   39.47776   13.47570  65.9%     -    0s
     0     0   13.47570    0   34   39.47776   13.47570  65.9%     -    0s
     0     0   13.47570    0   34   39.47776   13.47570  65.9%     -    0s
     0     0   13.47571    0   34   39.47776   13.47571  65.9%     -    0s
     0     0   13.47572    0   32   39.47776   13.47572  65.9%     -    0s
     0     0   13.47572    0   32   39.47776   13.47572  65.9%     -    0s
     0     0   13.47573    0   30   39.47776   13.47573  65.9%     -    0s
     0     0   13.47573    0   30   39.47776   13.47573  65.9%     -    0s
     0     0   13.47573    0   36   39.47776   13.47573  65.9%     -    0s
     0     0   13.47573    0   36   39.47776   13.47573  65.9%     -    0s
     0     0   13.47573    0   36   39.47776   13.47573  65.9%     -    0s
     0     0   13.47573    0   36   39.47776   13.47573  65.9%     -    0s
     0     0   13.47573    0   36   39.47776   13.47573  65.9%     -    0s
     0     0   13.47573    0   36   39.47776   13.47573  65.9%     -    0s
     0     0   13.47573    0   26   39.47776   13.47573  65.9%     -    0s
     0     0   13.47573    0   26   39.47776   13.47573  65.9%     -    0s
     0     0   13.47574    0   26   39.47776   13.47574  65.9%     -    0s
     0     0   13.47574    0   26   39.47776   13.47574  65.9%     -    0s
     0     0   13.47574    0   26   39.47776   13.47574  65.9%     -    0s
     0     0   13.47574    0   28   39.47776   13.47574  65.9%     -    0s
     0     0   13.47576    0   28   39.47776   13.47576  65.9%     -    0s
     0     0   13.47576    0   34   39.47776   13.47576  65.9%     -    0s
     0     0   13.47576    0   34   39.47776   13.47576  65.9%     -    0s
     0     0   13.47576    0   34   39.47776   13.47576  65.9%     -    0s
     0     0   13.47576    0   34   39.47776   13.47576  65.9%     -    0s
     0     0   13.47576    0   34   39.47776   13.47576  65.9%     -    0s
     0     0   13.47576    0   34   39.47776   13.47576  65.9%     -    0s
     0     0   13.47576    0   34   39.47776   13.47576  65.9%     -    0s
     0     0   13.47576    0   34   39.47776   13.47576  65.9%     -    0s
     0     0   13.47576    0   34   39.47776   13.47576  65.9%     -    0s
     0     0   13.47576    0   34   39.47776   13.47576  65.9%     -    0s
     0     0   13.47577    0   34   39.47776   13.47577  65.9%     -    0s
     0     0   13.47577    0   34   39.47776   13.47577  65.9%     -    0s
     0     0   13.47577    0   34   39.47776   13.47577  65.9%     -    0s
     0     0   13.47577    0   34   39.47776   13.47577  65.9%     -    0s
     0     0   13.47578    0   34   39.47776   13.47578  65.9%     -    0s
     0     0   13.47578    0   34   39.47776   13.47578  65.9%     -    0s
     0     0   13.47578    0   34   39.47776   13.47578  65.9%     -    0s
     0     0   13.47578    0   34   39.47776   13.47578  65.9%     -    0s
     0     0   13.47578    0   34   39.47776   13.47578  65.9%     -    0s
     0     0   13.47578    0   34   39.47776   13.47578  65.9%     -    0s
     0     0   13.47578    0   34   39.47776   13.47578  65.9%     -    0s
     0     0   13.47578    0   34   39.47776   13.47578  65.9%     -    0s
     0     0   13.47579    0   34   39.47776   13.47579  65.9%     -    0s
     0     0   13.47579    0   34   39.47776   13.47579  65.9%     -    0s
     0     0   13.47579    0   34   39.47776   13.47579  65.9%     -    0s
     0     0   13.47579    0   34   39.47776   13.47579  65.9%     -    0s
     0     0   13.47579    0   34   39.47776   13.47579  65.9%     -    0s
     0     0   13.47579    0   34   39.47776   13.47579  65.9%     -    0s
     0     0   13.47579    0   34   39.47776   13.47579  65.9%     -    0s
     0     0   13.47580    0   34   39.47776   13.47580  65.9%     -    0s
     0     0   13.47580    0   34   39.47776   13.47580  65.9%     -    0s
     0     0   13.47580    0   34   39.47776   13.47580  65.9%     -    0s
     0     0   13.47580    0   34   39.47776   13.47580  65.9%     -    0s
     0     0   13.47580    0   34   39.47776   13.47580  65.9%     -    0s
     0     0   13.47580    0   34   39.47776   13.47580  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47581    0   34   39.47776   13.47581  65.9%     -    0s
     0     0   13.47587    0   34   39.47776   13.47587  65.9%     -    0s
     0     0   13.47587    0   34   39.47776   13.47587  65.9%     -    0s
     0     0   13.47587    0   34   39.47776   13.47587  65.9%     -    0s
     0     0   13.47587    0   34   39.47776   13.47587  65.9%     -    0s
     0     0   13.47587    0   34   39.47776   13.47587  65.9%     -    0s
     0     0   13.47587    0   34   39.47776   13.47587  65.9%     -    0s
     0     0   13.47587    0   34   39.47776   13.47587  65.9%     -    0s
     0     0   13.47587    0   34   39.47776   13.47587  65.9%     -    0s
     0     0   13.47587    0   32   39.47776   13.47587  65.9%     -    0s
     0     0   13.47587    0   32   39.47776   13.47587  65.9%     -    0s
     0     0   13.47587    0   32   39.47776   13.47587  65.9%     -    0s
H    0     0                      16.3168457   13.47587  17.4%     -    0s
H    0     0                      15.9097213   13.47587  15.3%     -    0s
H    0     0                      13.4770459   13.47587  0.01%     -    0s

Cutting planes:
  Learned: 15
  Clique: 4
  MIR: 5
  RLT: 2

Explored 1 nodes (2208 simplex iterations) in 0.43 seconds (0.23 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 13.477 15.9097 16.3168 ... 69.8844

Optimal solution found (tolerance 1.00e-04)
Best objective 1.347704594323e+01, best bound 1.347601777202e+01, gap 0.0076%

User-callback calls 834, time in user-callback 0.00 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
13.477045943227925
The root upper bound is: 39.477762502960324, lower bound is: 13.475866451015035. The root gap is: 65.8647%. Runtime: 0.4277830123901367.
--------------------------------------------------
   m   n  dataset formulation  ...     end_lb   end_gap  node_count      time
0  2  50  autompg    original  ...  13.477040  0.000000       987.0  0.143679
1  2  50  autompg         opt  ...  13.477040  0.000000       185.0  0.204820
2  2  50  autompg     opt_cut  ...  13.476018  0.000076         1.0  0.427783

[3 rows x 12 columns]
[2, 60, 'autompg']
[0.00449643 0.01182583 1.         1.         1.        ]
The relaxed obj is 0.050327517518837794.
The larges value of x is 2.37127901672217
Use new Big-M 4.74255803344434.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 120 rows, 122 columns and 240 nonzeros
Model fingerprint: 0xd1f4d177
Model has 183 quadratic objective terms
Variable types: 62 continuous, 60 integer (60 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [1e-01, 4e+01]
  QObjective range [1e-01, 6e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 30.0000000
Presolve time: 0.00s
Presolved: 120 rows, 122 columns, 240 nonzeros
Presolved model has 183 quadratic objective terms
Variable types: 62 continuous, 60 integer (60 binary)

Root relaxation: objective 6.519445e+00, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    6.51945    0   42   30.00000    6.51945  78.3%     -    0s
H    0     0                      16.8998912    6.51945  61.4%     -    0s
H    0     0                      16.7300554    6.51945  61.0%     -    0s
H    0     0                      16.0074866    6.51945  59.3%     -    0s
H    0     0                      15.9950416    6.51945  59.2%     -    0s
H    0     0                      15.8824335    6.51945  59.0%     -    0s
     0     0    7.15978    0   42   15.88243    7.15978  54.9%     -    0s
     0     2    7.15978    0   42   15.88243    7.15978  54.9%     -    0s

Explored 29340 nodes (158996 simplex iterations) in 1.16 seconds (0.91 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 15.8824 16.7301 30 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.588243354221e+01, best bound 1.588243354221e+01, gap 0.0000%

User-callback calls 59265, time in user-callback 0.07 sec
--------------------------------
solve the problem in original formulation
The obj is 15.88243354221319.
The root upper bound is: 15.88243354221319, lower bound is: 7.159782599545807. The root gap is: 54.9201%. Runtime: 1.1595301628112793.
[25 26 28 51 54]
Number of outliers: 5
--------------------------------
The decomposition time is 0.056552497670054436.
Optimal value: 59.99999992012645
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.0462497491389513.
Optimal value: 59.99999992012645
6.519456200311481
15.879415032404747
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 420 rows, 242 columns and 1140 nonzeros
Model fingerprint: 0x5fbc3939
Model has 183 quadratic objective terms
Variable types: 62 continuous, 180 integer (180 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+03]
  Objective range  [1e-01, 4e+01]
  QObjective range [1e-01, 6e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-02, 1e+03]
Found heuristic solution: objective 27.2430213
Presolve time: 0.00s
Presolved: 420 rows, 242 columns, 1140 nonzeros
Presolved model has 183 quadratic objective terms
Variable types: 62 continuous, 180 integer (180 binary)

Root relaxation: objective 6.519445e+00, 648 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    6.51945    0   84   27.24302    6.51945  76.1%     -    0s
H    0     0                      15.8824335    6.51945  59.0%     -    0s
     0     0    6.51945    0   88   15.88243    6.51945  59.0%     -    0s
     0     2    7.18461    0   88   15.88243    7.18461  54.8%     -    0s

Cutting planes:
  Learned: 18
  Clique: 12

Explored 424 nodes (8393 simplex iterations) in 0.27 seconds (0.20 work units)
Thread count was 8 (of 52 available processors)

Solution count 2: 15.8824 27.243 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.588243354221e+01, best bound 1.588243354221e+01, gap 0.0000%

User-callback calls 1152, time in user-callback 0.00 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 15.882433542213196.
The root upper bound is: 15.882433542213196, lower bound is: 7.184605469821793. The root gap is: 54.7638%. Runtime: 0.2693960666656494.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 421 rows, 243 columns and 1263 nonzeros
Model fingerprint: 0x45916d35
Model has 183 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 63 continuous, 180 integer (180 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+03]
  QMatrix range    [7e-02, 3e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [1e-01, 4e+01]
  QObjective range [1e-09, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-02, 1e+03]
Presolve time: 0.00s
Presolved: 421 rows, 243 columns, 1263 nonzeros
Presolved model has 183 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 63 continuous, 180 integer (180 binary)

Root relaxation: objective 1.585635e+01, 633 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   15.85635    0   74          -   15.85635      -     -    0s
H    0     0                      64.7863860   15.85635  75.5%     -    0s
H    0     0                      56.0315772   15.85635  71.7%     -    0s
     0     0   15.85988    0   53   56.03158   15.85988  71.7%     -    0s
     0     0   15.85993    0   60   56.03158   15.85993  71.7%     -    0s
     0     0   15.86140    0   50   56.03158   15.86140  71.7%     -    0s
     0     0   15.86140    0   52   56.03158   15.86140  71.7%     -    0s
     0     0   15.86244    0   48   56.03158   15.86244  71.7%     -    0s
H    0     0                      54.6939286   15.86244  71.0%     -    0s
H    0     0                      28.9610517   15.86244  45.2%     -    0s
     0     0   15.86244    0   50   28.96105   15.86244  45.2%     -    0s
     0     0   15.86383    0   54   28.96105   15.86383  45.2%     -    0s
H    0     0                      24.4631493   15.86392  35.2%     -    0s
H    0     0                      16.2948406   15.86392  2.64%     -    0s
H    0     0                      16.2948395   15.86392  2.64%     -    0s
     0     0   15.86393    0   55   16.29484   15.86393  2.64%     -    0s
     0     0   15.86472    0   47   16.29484   15.86472  2.64%     -    0s
H    0     0                      15.8824338   15.86472  0.11%     -    0s
     0     0   15.86681    0   42   15.88243   15.86681  0.10%     -    0s
     0     0   15.86809    0   38   15.88243   15.86809  0.09%     -    0s
     0     0   15.86949    0   40   15.88243   15.86949  0.08%     -    0s
     0     0   15.88127    0   30   15.88243   15.88127  0.01%     -    0s

Explored 1 nodes (3400 simplex iterations) in 0.54 seconds (0.33 work units)
Thread count was 8 (of 52 available processors)

Solution count 7: 15.8824 16.2948 24.4631 ... 64.7864

Optimal solution found (tolerance 1.00e-04)
Best objective 1.588243379351e+01, best bound 1.588126668806e+01, gap 0.0073%

User-callback calls 538, time in user-callback 0.00 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
15.882433793514641
The root upper bound is: 15.882433793514641, lower bound is: 15.869485057743054. The root gap is: 0.0815%. Runtime: 0.537510871887207.
--------------------------------------------------
   m   n  dataset formulation  ...     end_lb   end_gap  node_count      time
0  2  50  autompg    original  ...  13.477040  0.000000       987.0  0.143679
1  2  50  autompg         opt  ...  13.477040  0.000000       185.0  0.204820
2  2  50  autompg     opt_cut  ...  13.476018  0.000076         1.0  0.427783
3  2  60  autompg    original  ...  15.882434  0.000000     29340.0  1.159530
4  2  60  autompg         opt  ...  15.882434  0.000000       424.0  0.269396
5  2  60  autompg     opt_cut  ...  15.881267  0.000073         1.0  0.537511

[6 rows x 12 columns]
[2, 70, 'autompg']
[0.00454177 0.00731038 1.         1.         1.        ]
The relaxed obj is 0.057755321316655284.
The larges value of x is 2.5148736324142518
Use new Big-M 5.0297472648285035.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 140 rows, 142 columns and 280 nonzeros
Model fingerprint: 0x723d0877
Model has 213 quadratic objective terms
Variable types: 72 continuous, 70 integer (70 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [2e-01, 4e+01]
  QObjective range [4e-02, 7e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 35.0000000
Presolve time: 0.00s
Presolved: 140 rows, 142 columns, 280 nonzeros
Presolved model has 213 quadratic objective terms
Variable types: 72 continuous, 70 integer (70 binary)

Root relaxation: objective 7.084533e+00, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    7.08453    0   51   35.00000    7.08453  79.8%     -    0s
H    0     0                      20.2249426    7.08453  65.0%     -    0s
H    0     0                      19.4898890    7.08453  63.7%     -    0s
H    0     0                      18.0970309    7.08453  60.9%     -    0s
H    0     0                      18.0886354    7.08453  60.8%     -    0s
H    0     0                      17.9723636    7.08453  60.6%     -    0s
     0     0    7.34602    0   51   17.97236    7.34602  59.1%     -    0s
     0     2    7.34602    0   51   17.97236    7.34602  59.1%     -    0s

Explored 78473 nodes (490151 simplex iterations) in 3.13 seconds (2.99 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 17.9724 19.4899 20.2249 35 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.797236364471e+01, best bound 1.797236364471e+01, gap 0.0000%

User-callback calls 157790, time in user-callback 0.19 sec
--------------------------------
solve the problem in original formulation
The obj is 17.972363644709056.
The root upper bound is: 17.972363644709056, lower bound is: 7.346020708176778. The root gap is: 59.126%. Runtime: 3.126955986022949.
[25 26 27 28 51 54]
Number of outliers: 6
--------------------------------
The decomposition time is 0.06290878728032112.
Optimal value: 69.99999961781218
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.05341806635260582.
Optimal value: 69.99999961781218
7.084535072273386
17.968623210472497
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 490 rows, 282 columns and 1330 nonzeros
Model fingerprint: 0x9f099da9
Model has 213 quadratic objective terms
Variable types: 72 continuous, 210 integer (210 binary)
Coefficient statistics:
  Matrix range     [2e-02, 1e+03]
  Objective range  [2e-01, 4e+01]
  QObjective range [4e-02, 7e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [8e-02, 1e+03]
Found heuristic solution: objective 30.6775087
Presolve time: 0.00s
Presolved: 490 rows, 282 columns, 1330 nonzeros
Presolved model has 213 quadratic objective terms
Variable types: 72 continuous, 210 integer (210 binary)
Found heuristic solution: objective 28.9951208

Root relaxation: objective 7.084533e+00, 747 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    7.08453    0  102   28.99512    7.08453  75.6%     -    0s
H    0     0                      19.3002175    7.08453  63.3%     -    0s
H    0     0                      17.9723636    7.08453  60.6%     -    0s
     0     0    8.21636    0  108   17.97236    8.21636  54.3%     -    0s
     0     2    8.41321    0  108   17.97236    8.41321  53.2%     -    0s

Cutting planes:
  Learned: 20
  Clique: 19

Explored 548 nodes (11608 simplex iterations) in 0.33 seconds (0.23 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 17.9724 19.3002 28.9951 30.6775 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.797236364471e+01, best bound 1.797236364471e+01, gap 0.0000%

User-callback calls 1420, time in user-callback 0.00 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 17.97236364470904.
The root upper bound is: 17.97236364470904, lower bound is: 8.41320891755025. The root gap is: 53.1881%. Runtime: 0.32898497581481934.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 491 rows, 283 columns and 1473 nonzeros
Model fingerprint: 0xe89daf9d
Model has 213 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 73 continuous, 210 integer (210 binary)
Coefficient statistics:
  Matrix range     [7e-07, 1e+03]
  QMatrix range    [2e-02, 4e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [2e-01, 4e+01]
  QObjective range [4e-09, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [8e-02, 1e+03]
Presolve time: 0.00s
Presolved: 491 rows, 283 columns, 1473 nonzeros
Presolved model has 213 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 73 continuous, 210 integer (210 binary)

Root relaxation: objective 1.795753e+01, 736 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   17.95753    0   80          -   17.95753      -     -    0s
H    0     0                      85.6133859   17.95753  79.0%     -    0s
H    0     0                      81.7716131   17.95753  78.0%     -    0s
     0     0   17.95918    0   84   81.77161   17.95918  78.0%     -    0s
     0     0   17.95964    0   80   81.77161   17.95964  78.0%     -    0s
     0     0   17.96020    0   84   81.77161   17.96020  78.0%     -    0s
H    0     0                      55.4441889   17.96020  67.6%     -    0s
H    0     0                      33.5211564   17.96020  46.4%     -    0s
     0     0   17.96034    0   84   33.52116   17.96034  46.4%     -    0s
     0     0   17.96040    0   84   33.52116   17.96040  46.4%     -    0s
     0     0   17.96059    0   84   33.52116   17.96059  46.4%     -    0s
     0     0   17.96071    0   80   33.52116   17.96071  46.4%     -    0s
     0     0   17.96075    0   80   33.52116   17.96075  46.4%     -    0s
     0     0   17.96078    0   78   33.52116   17.96078  46.4%     -    0s
     0     0   17.96081    0   82   33.52116   17.96081  46.4%     -    0s
     0     0   17.96082    0   82   33.52116   17.96082  46.4%     -    0s
     0     0   17.96086    0   80   33.52116   17.96086  46.4%     -    0s
     0     0   17.96091    0   81   33.52116   17.96091  46.4%     -    0s
     0     0   17.96098    0   77   33.52116   17.96098  46.4%     -    0s
     0     0   17.96110    0   81   33.52116   17.96110  46.4%     -    0s
     0     0   17.96118    0   78   33.52116   17.96118  46.4%     -    0s
     0     0   17.96136    0   78   33.52116   17.96136  46.4%     -    0s
     0     0   17.96136    0   72   33.52116   17.96136  46.4%     -    0s
     0     0   17.96151    0   76   33.52116   17.96151  46.4%     -    0s
     0     0   17.96151    0   78   33.52116   17.96151  46.4%     -    0s
     0     0   17.96151    0   78   33.52116   17.96151  46.4%     -    0s
     0     0   17.96154    0   78   33.52116   17.96154  46.4%     -    0s
     0     0   17.96165    0   78   33.52116   17.96165  46.4%     -    0s
     0     0   17.96175    0   82   33.52116   17.96175  46.4%     -    0s
     0     0   17.96180    0   81   33.52116   17.96180  46.4%     -    0s
     0     0   17.96184    0   80   33.52116   17.96184  46.4%     -    0s
H    0     0                      28.9865322   17.96184  38.0%     -    0s
     0     0   17.96184    0   78   28.98653   17.96184  38.0%     -    0s
     0     0   17.96190    0   76   28.98653   17.96190  38.0%     -    0s
     0     0   17.96192    0   78   28.98653   17.96192  38.0%     -    0s
     0     0   17.96198    0   78   28.98653   17.96198  38.0%     -    0s
     0     0   17.96199    0   72   28.98653   17.96199  38.0%     -    0s
     0     0   17.96202    0   73   28.98653   17.96202  38.0%     -    0s
     0     0   17.96218    0   80   28.98653   17.96218  38.0%     -    0s
     0     0   17.96236    0   82   28.98653   17.96236  38.0%     -    0s
     0     0   17.96261    0   74   28.98653   17.96261  38.0%     -    0s
     0     0   17.96261    0   70   28.98653   17.96261  38.0%     -    0s
     0     0   17.96267    0   68   28.98653   17.96267  38.0%     -    0s
     0     0   17.96271    0   69   28.98653   17.96271  38.0%     -    0s
     0     0   17.96279    0   76   28.98653   17.96279  38.0%     -    0s
     0     0   17.96282    0   76   28.98653   17.96282  38.0%     -    0s
     0     0   17.96283    0   78   28.98653   17.96283  38.0%     -    0s
     0     0   17.96288    0   79   28.98653   17.96288  38.0%     -    0s
     0     0   17.96288    0   76   28.98653   17.96288  38.0%     -    0s
     0     0   17.96288    0   68   28.98653   17.96288  38.0%     -    0s
     0     0   17.96288    0   72   28.98653   17.96288  38.0%     -    0s
     0     0   17.96293    0   68   28.98653   17.96293  38.0%     -    0s
     0     0   17.96301    0   70   28.98653   17.96301  38.0%     -    0s
     0     0   17.96302    0   73   28.98653   17.96302  38.0%     -    0s
     0     0   17.96302    0   60   28.98653   17.96302  38.0%     -    0s
     0     0   17.96303    0   61   28.98653   17.96303  38.0%     -    0s
     0     0   17.96306    0   65   28.98653   17.96306  38.0%     -    0s
     0     0   17.96312    0   77   28.98653   17.96312  38.0%     -    0s
     0     0   17.96312    0   68   28.98653   17.96312  38.0%     -    0s
     0     0   17.96312    0   58   28.98653   17.96312  38.0%     -    0s
     0     0   17.96314    0   64   28.98653   17.96314  38.0%     -    0s
     0     0   17.96319    0   60   28.98653   17.96319  38.0%     -    0s
     0     0   17.96333    0   62   28.98653   17.96333  38.0%     -    0s
     0     0   17.96336    0   56   28.98653   17.96336  38.0%     -    0s
     0     0   17.96342    0   56   28.98653   17.96342  38.0%     -    0s
     0     0   17.96342    0   54   28.98653   17.96342  38.0%     -    0s
     0     0   17.96346    0   63   28.98653   17.96346  38.0%     -    0s
     0     0   17.96353    0   61   28.98653   17.96353  38.0%     -    0s
     0     0   17.96358    0   60   28.98653   17.96358  38.0%     -    0s
     0     0   17.96358    0   58   28.98653   17.96358  38.0%     -    0s
     0     0   17.96361    0   56   28.98653   17.96361  38.0%     -    0s
     0     0   17.96361    0   60   28.98653   17.96361  38.0%     -    0s
     0     0   17.96367    0   64   28.98653   17.96367  38.0%     -    0s
     0     0   17.96373    0   60   28.98653   17.96373  38.0%     -    0s
     0     0   17.96375    0   66   28.98653   17.96375  38.0%     -    0s
     0     0   17.96382    0   57   28.98653   17.96382  38.0%     -    0s
     0     0   17.96387    0   58   28.98653   17.96387  38.0%     -    0s
     0     0   17.96390    0   54   28.98653   17.96390  38.0%     -    0s
     0     0   17.96395    0   54   28.98653   17.96395  38.0%     -    0s
     0     0   17.96400    0   56   28.98653   17.96400  38.0%     -    0s
     0     0   17.96404    0   54   28.98653   17.96404  38.0%     -    0s
     0     0   17.96417    0   60   28.98653   17.96417  38.0%     -    0s
     0     0   17.96417    0   56   28.98653   17.96417  38.0%     -    0s
     0     0   17.96422    0   56   28.98653   17.96422  38.0%     -    0s
     0     0   17.96427    0   50   28.98653   17.96427  38.0%     -    0s
     0     0   17.96427    0   48   28.98653   17.96427  38.0%     -    0s
     0     0   17.96427    0   42   28.98653   17.96427  38.0%     -    0s
     0     0   17.96430    0   48   28.98653   17.96430  38.0%     -    0s
     0     0   17.96430    0   55   28.98653   17.96430  38.0%     -    0s
H    0     0                      28.9865322   17.96430  38.0%     -    0s
     0     0   17.96430    0   53   28.98653   17.96430  38.0%     -    0s
     0     0   17.96431    0   50   28.98653   17.96431  38.0%     -    0s
     0     0   17.96443    0   53   28.98653   17.96443  38.0%     -    0s
     0     0   17.96445    0   52   28.98653   17.96445  38.0%     -    0s
     0     0   17.96447    0   50   28.98653   17.96447  38.0%     -    0s
     0     0   17.96455    0   46   28.98653   17.96455  38.0%     -    0s
     0     0   17.96455    0   44   28.98653   17.96455  38.0%     -    0s
     0     0   17.96461    0   48   28.98653   17.96461  38.0%     -    0s
     0     0   17.96471    0   55   28.98653   17.96471  38.0%     -    1s
     0     0   17.96593    0   42   28.98653   17.96593  38.0%     -    1s
     0     0   17.96631    0   49   28.98653   17.96631  38.0%     -    1s
     0     0   17.96673    0   48   28.98653   17.96673  38.0%     -    1s
     0     0   17.96685    0   44   28.98653   17.96685  38.0%     -    1s
     0     0   17.96685    0   42   28.98653   17.96685  38.0%     -    1s
     0     0   17.96685    0   40   28.98653   17.96685  38.0%     -    1s
     0     0   17.96685    0   46   28.98653   17.96685  38.0%     -    1s
     0     0   17.96698    0   45   28.98653   17.96698  38.0%     -    1s
     0     0   17.96701    0   55   28.98653   17.96701  38.0%     -    1s
     0     0   17.96701    0   52   28.98653   17.96701  38.0%     -    1s
H    0     0                      17.9723645   17.96701  0.03%     -    1s
     0     0   17.96945    0   19   17.97236   17.96945  0.02%     -    1s
     0     0   17.96946    0   19   17.97236   17.96946  0.02%     -    1s
     0     0   17.96946    0   19   17.97236   17.96946  0.02%     -    1s
     0     2   17.96947    0   19   17.97236   17.96947  0.02%     -    1s

Cutting planes:
  Clique: 1

Explored 19 nodes (30571 simplex iterations) in 1.47 seconds (1.28 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 17.9724 28.9865 33.5212 ... 85.6134

Optimal solution found (tolerance 1.00e-04)
Best objective 1.797236449977e+01, best bound 1.797077352999e+01, gap 0.0089%

User-callback calls 1215, time in user-callback 0.00 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
17.97236449977157
The root upper bound is: 17.97236449977157, lower bound is: 17.969463447140633. The root gap is: 0.0161%. Runtime: 1.467073917388916.
--------------------------------------------------
   m   n  dataset formulation  ...     end_lb   end_gap  node_count      time
0  2  50  autompg    original  ...  13.477040  0.000000       987.0  0.143679
1  2  50  autompg         opt  ...  13.477040  0.000000       185.0  0.204820
2  2  50  autompg     opt_cut  ...  13.476018  0.000076         1.0  0.427783
3  2  60  autompg    original  ...  15.882434  0.000000     29340.0  1.159530
4  2  60  autompg         opt  ...  15.882434  0.000000       424.0  0.269396
5  2  60  autompg     opt_cut  ...  15.881267  0.000073         1.0  0.537511
6  2  70  autompg    original  ...  17.972364  0.000000     78473.0  3.126956
7  2  70  autompg         opt  ...  17.972364  0.000000       548.0  0.328985
8  2  70  autompg     opt_cut  ...  17.970774  0.000089        19.0  1.467074

[9 rows x 12 columns]
[2, 80, 'autompg']
[0.00385977 0.00676175 1.         1.         1.        ]
The relaxed obj is 0.06541070547690708.
The larges value of x is 2.6145795023476626
Use new Big-M 5.229159004695325.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 160 rows, 162 columns and 320 nonzeros
Model fingerprint: 0xaa1327ea
Model has 243 quadratic objective terms
Variable types: 82 continuous, 80 integer (80 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [3e-02, 4e+01]
  QObjective range [2e-01, 8e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 40.0000000
Presolve time: 0.00s
Presolved: 160 rows, 162 columns, 320 nonzeros
Presolved model has 243 quadratic objective terms
Variable types: 82 continuous, 80 integer (80 binary)

Root relaxation: objective 7.945671e+00, 332 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    7.94567    0   58   40.00000    7.94567  80.1%     -    0s
H    0     0                      22.1833018    7.94567  64.2%     -    0s
H    0     0                      21.9859982    7.94567  63.9%     -    0s
H    0     0                      21.0405655    7.94567  62.2%     -    0s
H    0     0                      21.0187866    7.94567  62.2%     -    0s
H    0     0                      20.9294471    7.94567  62.0%     -    0s
     0     0    8.51505    0   58   20.92945    8.51505  59.3%     -    0s
     0     2    8.51505    0   58   20.92945    8.51505  59.3%     -    0s
 134670 47907   19.60108   27   40   20.92945   18.79713  10.2%   6.5    5s
 292283 56968   20.44539   31   39   20.92945   19.69356  5.91%   6.3   10s
 449785 17780   20.83744   31   37   20.92945   20.61803  1.49%   5.9   15s

Explored 476643 nodes (2761296 simplex iterations) in 15.95 seconds (19.18 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 20.9294 21.986 40 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.092944713936e+01, best bound 2.092944713936e+01, gap 0.0000%

User-callback calls 955402, time in user-callback 1.18 sec
--------------------------------
solve the problem in original formulation
The obj is 20.92944713936033.
The root upper bound is: 20.92944713936033, lower bound is: 8.515050120633628. The root gap is: 59.3155%. Runtime: 15.951053142547607.
[25 26 27 28 51 54]
Number of outliers: 6
--------------------------------
The decomposition time is 0.07472420111298561.
Optimal value: 79.9999999729323
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.06981964595615864.
Optimal value: 79.9999999729323
7.9456868392682765
20.925846590113803
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 560 rows, 322 columns and 1520 nonzeros
Model fingerprint: 0xcc2e3dc2
Model has 243 quadratic objective terms
Variable types: 82 continuous, 240 integer (240 binary)
Coefficient statistics:
  Matrix range     [8e-02, 1e+03]
  Objective range  [3e-02, 4e+01]
  QObjective range [2e-01, 8e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-03, 1e+03]
Presolve time: 0.00s
Presolved: 560 rows, 322 columns, 1520 nonzeros
Presolved model has 243 quadratic objective terms
Variable types: 82 continuous, 240 integer (240 binary)

Root relaxation: objective 7.945671e+00, 830 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

H    0     0                     183.7336731    7.94567  95.7%     -    0s
     0     0    7.94567    0  116  183.73367    7.94567  95.7%     -    0s
H    0     0                      21.9656561    7.94567  63.8%     -    0s
H    0     0                      20.9294471    7.94567  62.0%     -    0s
     0     0    8.42355    0  121   20.92945    8.42355  59.8%     -    0s
     0     2    8.67437    0  121   20.92945    8.67437  58.6%     -    0s

Cutting planes:
  Learned: 20
  Cover: 1
  Clique: 7
  Inf proof: 1

Explored 841 nodes (21105 simplex iterations) in 0.37 seconds (0.36 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 20.9294 21.9657 183.734 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.092944713936e+01, best bound 2.092944713936e+01, gap 0.0000%

User-callback calls 2017, time in user-callback 0.00 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 20.929447139360335.
The root upper bound is: 20.929447139360335, lower bound is: 8.674372962345904. The root gap is: 58.5542%. Runtime: 0.36792516708374023.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 561 rows, 323 columns and 1683 nonzeros
Model fingerprint: 0x69705f1b
Model has 243 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 83 continuous, 240 integer (240 binary)
Coefficient statistics:
  Matrix range     [3e-02, 1e+03]
  QMatrix range    [8e-02, 4e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [3e-02, 4e+01]
  QObjective range [3e-10, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-03, 1e+03]
Presolve time: 0.00s
Presolved: 561 rows, 323 columns, 1683 nonzeros
Presolved model has 243 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 83 continuous, 240 integer (240 binary)

Root relaxation: objective 2.089904e+01, 934 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   20.89904    0  106          -   20.89904      -     -    0s
H    0     0                      44.3872935   20.89904  52.9%     -    0s
H    0     0                      44.3872912   20.89904  52.9%     -    0s
H    0     0                      44.3872909   20.90269  52.9%     -    0s
     0     0   20.90269    0   94   44.38729   20.90269  52.9%     -    0s
     0     0   20.90269    0   98   44.38729   20.90269  52.9%     -    0s
     0     0   20.90451    0  100   44.38729   20.90451  52.9%     -    0s
     0     0   20.90451    0  102   44.38729   20.90451  52.9%     -    0s
     0     0   20.90530    0   79   44.38729   20.90530  52.9%     -    0s
     0     0   20.90530    0   86   44.38729   20.90530  52.9%     -    0s
     0     0   20.90581    0   76   44.38729   20.90581  52.9%     -    0s
     0     0   20.90581    0   80   44.38729   20.90581  52.9%     -    0s
     0     0   20.90630    0   87   44.38729   20.90630  52.9%     -    0s
     0     0   20.90630    0   82   44.38729   20.90630  52.9%     -    0s
     0     0   20.90697    0   85   44.38729   20.90697  52.9%     -    0s
H    0     0                      44.3321182   20.90697  52.8%     -    0s
     0     0   20.90697    0   89   44.33212   20.90697  52.8%     -    0s
     0     0   20.90784    0   68   44.33212   20.90784  52.8%     -    0s
     0     0   20.90789    0   72   44.33212   20.90789  52.8%     -    0s
     0     0   20.90844    0   75   44.33212   20.90844  52.8%     -    0s
     0     0   20.90844    0   70   44.33212   20.90844  52.8%     -    0s
     0     0   20.90898    0   74   44.33212   20.90898  52.8%     -    0s
     0     0   20.90899    0   75   44.33212   20.90899  52.8%     -    0s
     0     0   20.90936    0   59   44.33212   20.90936  52.8%     -    0s
     0     0   20.90946    0   68   44.33212   20.90946  52.8%     -    0s
     0     0   20.90956    0   65   44.33212   20.90956  52.8%     -    0s
     0     0   20.90981    0   58   44.33212   20.90981  52.8%     -    0s
     0     0   20.91022    0   78   44.33212   20.91022  52.8%     -    0s
     0     0   20.91077    0   70   44.33212   20.91077  52.8%     -    0s
     0     0   20.91117    0   68   44.33212   20.91117  52.8%     -    0s
H    0     0                      33.4083955   20.91142  37.4%     -    0s
     0     0   20.91142    0   59   33.40840   20.91142  37.4%     -    0s
     0     0   20.91158    0   56   33.40840   20.91158  37.4%     -    0s
     0     0   20.91184    0   66   33.40840   20.91184  37.4%     -    0s
     0     0   20.91201    0   56   33.40840   20.91201  37.4%     -    0s
     0     0   20.91233    0   60   33.40840   20.91233  37.4%     -    0s
     0     0   20.91267    0   66   33.40840   20.91267  37.4%     -    0s
     0     0   20.91276    0   65   33.40840   20.91276  37.4%     -    1s
     0     0   20.91294    0   58   33.40840   20.91294  37.4%     -    1s
     0     0   20.91320    0   62   33.40840   20.91320  37.4%     -    1s
     0     0   20.91344    0   56   33.40840   20.91344  37.4%     -    1s
     0     0   20.91351    0   61   33.40840   20.91351  37.4%     -    1s
     0     0   20.91363    0   59   33.40840   20.91363  37.4%     -    1s
     0     0   20.91393    0   58   33.40840   20.91393  37.4%     -    1s
     0     0   20.91424    0   60   33.40840   20.91424  37.4%     -    1s
     0     0   20.91443    0   55   33.40840   20.91443  37.4%     -    1s
     0     0   20.91452    0   52   33.40840   20.91452  37.4%     -    1s
     0     0   20.91463    0   64   33.40840   20.91463  37.4%     -    1s
     0     0   20.91469    0   58   33.40840   20.91469  37.4%     -    1s
     0     0   20.91478    0   59   33.40840   20.91478  37.4%     -    1s
     0     0   20.91502    0   52   33.40840   20.91502  37.4%     -    1s
     0     0   20.91508    0   50   33.40840   20.91508  37.4%     -    1s
     0     0   20.91512    0   56   33.40840   20.91512  37.4%     -    1s
     0     0   20.91534    0   59   33.40840   20.91534  37.4%     -    1s
     0     0   20.91544    0   54   33.40840   20.91544  37.4%     -    1s
     0     0   20.91547    0   47   33.40840   20.91547  37.4%     -    1s
     0     0   20.91555    0   54   33.40840   20.91555  37.4%     -    1s
     0     0   20.91557    0   62   33.40840   20.91557  37.4%     -    1s
     0     0   20.91564    0   62   33.40840   20.91564  37.4%     -    1s
     0     0   20.91571    0   60   33.40840   20.91571  37.4%     -    1s
     0     0   20.91583    0   58   33.40840   20.91583  37.4%     -    1s
     0     0   20.91583    0   60   33.40840   20.91583  37.4%     -    1s
     0     0   20.91587    0   55   33.40840   20.91587  37.4%     -    1s
     0     0   20.91590    0   60   33.40840   20.91590  37.4%     -    1s
     0     0   20.91594    0   62   33.40840   20.91594  37.4%     -    1s
     0     0   20.91603    0   56   33.40840   20.91603  37.4%     -    1s
     0     0   20.91612    0   61   33.40840   20.91612  37.4%     -    1s
     0     0   20.91619    0   50   33.40840   20.91619  37.4%     -    1s
     0     0   20.91631    0   66   33.40840   20.91631  37.4%     -    1s
     0     0   20.91640    0   58   33.40840   20.91640  37.4%     -    2s
     0     0   20.91644    0   57   33.40840   20.91644  37.4%     -    2s
     0     0   20.91652    0   62   33.40840   20.91652  37.4%     -    2s
     0     0   20.91661    0   64   33.40840   20.91661  37.4%     -    2s
     0     0   20.91668    0   64   33.40840   20.91668  37.4%     -    2s
H    0     0                      33.4083951   20.91686  37.4%     -    2s
     0     0   20.91686    0   54   33.40840   20.91686  37.4%     -    2s
     0     0   20.91701    0   54   33.40840   20.91701  37.4%     -    2s
     0     0   20.91719    0   58   33.40840   20.91719  37.4%     -    2s
     0     0   20.91721    0   57   33.40840   20.91721  37.4%     -    2s
     0     0   20.91733    0   60   33.40840   20.91733  37.4%     -    2s
     0     0   20.91733    0   60   33.40840   20.91733  37.4%     -    2s
     0     0   20.91746    0   60   33.40840   20.91746  37.4%     -    2s
     0     0   20.91751    0   54   33.40840   20.91751  37.4%     -    2s
     0     0   20.91759    0   54   33.40840   20.91759  37.4%     -    2s
     0     0   20.91767    0   62   33.40840   20.91767  37.4%     -    2s
     0     0   20.91779    0   60   33.40840   20.91779  37.4%     -    2s
     0     0   20.91781    0   57   33.40840   20.91781  37.4%     -    2s
     0     0   20.91784    0   60   33.40840   20.91784  37.4%     -    2s
     0     0   20.91787    0   60   33.40840   20.91787  37.4%     -    2s
     0     0   20.91790    0   50   33.40840   20.91790  37.4%     -    2s
     0     0   20.91790    0   58   33.40840   20.91790  37.4%     -    2s
     0     0   20.91792    0   64   33.40840   20.91792  37.4%     -    2s
     0     0   20.91793    0   56   33.40840   20.91793  37.4%     -    2s
     0     0   20.91793    0   64   33.40840   20.91793  37.4%     -    2s
     0     0   20.91796    0   62   33.40840   20.91796  37.4%     -    2s
     0     0   20.91801    0   58   33.40840   20.91801  37.4%     -    2s
     0     0   20.91801    0   60   33.40840   20.91801  37.4%     -    2s
     0     0   20.91803    0   60   33.40840   20.91803  37.4%     -    2s
     0     0   20.91803    0   58   33.40840   20.91803  37.4%     -    2s
     0     0   20.91810    0   60   33.40840   20.91810  37.4%     -    2s
     0     0   20.91810    0   70   33.40840   20.91810  37.4%     -    2s
     0     0   20.91814    0   66   33.40840   20.91814  37.4%     -    2s
     0     0   20.91814    0   60   33.40840   20.91814  37.4%     -    2s
     0     0   20.91820    0   58   33.40840   20.91820  37.4%     -    2s
     0     0   20.91826    0   52   33.40840   20.91826  37.4%     -    2s
     0     0   20.91828    0   54   33.40840   20.91828  37.4%     -    2s
     0     0   20.91834    0   60   33.40840   20.91834  37.4%     -    2s
     0     0   20.91844    0   58   33.40840   20.91844  37.4%     -    2s
     0     0   20.91849    0   54   33.40840   20.91849  37.4%     -    2s
     0     0   20.91858    0   52   33.40840   20.91858  37.4%     -    2s
     0     0   20.91867    0   49   33.40840   20.91867  37.4%     -    2s
     0     0   20.91872    0   57   33.40840   20.91872  37.4%     -    2s
     0     0   20.91872    0   56   33.40840   20.91872  37.4%     -    2s
     0     0   20.91881    0   60   33.40840   20.91881  37.4%     -    2s
     0     0   20.91882    0   58   33.40840   20.91882  37.4%     -    2s
     0     0   20.91889    0   58   33.40840   20.91889  37.4%     -    2s
     0     0   20.91893    0   61   33.40840   20.91893  37.4%     -    2s
H    0     0                      21.2445702   20.91893  1.53%     -    3s
H    0     0                      20.9294490   20.91893  0.05%     -    3s
H    0     0                      20.9294475   20.91893  0.05%     -    3s
     0     0   20.92777    0   20   20.92945   20.92777  0.01%     -    3s

Explored 1 nodes (107416 simplex iterations) in 3.43 seconds (3.45 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 20.9294 21.2446 33.4084 ... 44.3873

Optimal solution found (tolerance 1.00e-04)
Best objective 2.092944748354e+01, best bound 2.092776545562e+01, gap 0.0080%

User-callback calls 1434, time in user-callback 0.01 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
20.929447483540272
The root upper bound is: 33.408395085064136, lower bound is: 20.918926243404325. The root gap is: 37.3842%. Runtime: 3.4294259548187256.
--------------------------------------------------
    m   n  dataset formulation  ...     end_lb   end_gap  node_count       time
0   2  50  autompg    original  ...  13.477040  0.000000       987.0   0.143679
1   2  50  autompg         opt  ...  13.477040  0.000000       185.0   0.204820
2   2  50  autompg     opt_cut  ...  13.476018  0.000076         1.0   0.427783
3   2  60  autompg    original  ...  15.882434  0.000000     29340.0   1.159530
4   2  60  autompg         opt  ...  15.882434  0.000000       424.0   0.269396
5   2  60  autompg     opt_cut  ...  15.881267  0.000073         1.0   0.537511
6   2  70  autompg    original  ...  17.972364  0.000000     78473.0   3.126956
7   2  70  autompg         opt  ...  17.972364  0.000000       548.0   0.328985
8   2  70  autompg     opt_cut  ...  17.970774  0.000089        19.0   1.467074
9   2  80  autompg    original  ...  20.929447  0.000000    476643.0  15.951053
10  2  80  autompg         opt  ...  20.929447  0.000000       841.0   0.367925
11  2  80  autompg     opt_cut  ...  20.927765  0.000080         1.0   3.429426

[12 rows x 12 columns]
[2, 90, 'autompg']
[0.00374549 0.00526343 1.         1.         1.        ]
The relaxed obj is 0.07445644642348981.
The larges value of x is 2.5447975147918904
Use new Big-M 5.089595029583781.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 180 rows, 182 columns and 360 nonzeros
Model fingerprint: 0x4f6f35d7
Model has 273 quadratic objective terms
Variable types: 92 continuous, 90 integer (90 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [2e-02, 5e+01]
  QObjective range [1e-01, 9e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 45.0000000
Presolve time: 0.00s
Presolved: 180 rows, 182 columns, 360 nonzeros
Presolved model has 273 quadratic objective terms
Variable types: 92 continuous, 90 integer (90 binary)

Root relaxation: objective 9.541948e+00, 349 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    9.54195    0   67   45.00000    9.54195  78.8%     -    0s
H    0     0                      27.0910824    9.54195  64.8%     -    0s
H    0     0                      26.4309956    9.54195  63.9%     -    0s
H    0     0                      24.4470164    9.54195  61.0%     -    0s
H    0     0                      24.3552366    9.54195  60.8%     -    0s
H    0     0                      24.1437639    9.54195  60.5%     -    0s
     0     0   10.26128    0   67   24.14376   10.26128  57.5%     -    0s
     0     2   10.26128    0   67   24.14376   10.26128  57.5%     -    0s
 64774 37459   21.35524   29   53   24.14376   19.51468  19.2%   5.9    5s
 186833 94228   23.17620   31   52   24.14376   20.67270  14.4%   5.7   10s
 325754 146281   23.62746   33   48   24.14376   21.28534  11.8%   5.6   15s
 468368 187993   22.49490   31   52   24.14376   21.69032  10.2%   5.5   20s
 615478 222071     cutoff   39        24.14376   21.99989  8.88%   5.4   25s
 757509 247289   23.99373   39   41   24.14376   22.23771  7.89%   5.3   30s
 899496 264528   22.44064   33   49   24.14376   22.43764  7.07%   5.2   35s
 1043199 274829   24.06920   37   44   24.14376   22.61407  6.34%   5.2   40s
 1187448 277266   24.00444   36   47   24.14376   22.77458  5.67%   5.2   45s
 1334779 271722   23.96924   34   50   24.14376   22.92910  5.03%   5.1   50s
 1476539 257663   23.53832   37   42   24.14376   23.07514  4.43%   5.1   55s
 1624230 234867   23.62832   33   51   24.14376   23.22645  3.80%   5.1   60s
 1769512 201612     cutoff   37        24.14376   23.38252  3.15%   5.0   65s
 1908750 158905     cutoff   34        24.14376   23.54681  2.47%   5.0   70s
 2049756 105853     cutoff   32        24.14376   23.73486  1.69%   4.9   75s
 2194194 28264   24.02052   40   41   24.14376   24.01920  0.52%   4.9   80s

Explored 2228170 nodes (10802274 simplex iterations) in 81.51 seconds (100.32 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 24.1438 26.431 27.0911 45 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.414376393647e+01, best bound 2.414376393647e+01, gap 0.0000%

User-callback calls 4464327, time in user-callback 5.65 sec
--------------------------------
solve the problem in original formulation
The obj is 24.143763936473537.
The root upper bound is: 24.143763936473537, lower bound is: 10.261284450391074. The root gap is: 57.4992%. Runtime: 81.51093411445618.
[25 26 27 28 51 54 81 84]
Number of outliers: 8
--------------------------------
The decomposition time is 0.08888640441000462.
Optimal value: 89.99999991377138
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.0809897631406784.
Optimal value: 89.99999991377138
9.541951754507743
24.139789305097054
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 630 rows, 362 columns and 1710 nonzeros
Model fingerprint: 0x69fc8079
Model has 273 quadratic objective terms
Variable types: 92 continuous, 270 integer (270 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+03]
  Objective range  [2e-02, 5e+01]
  QObjective range [1e-01, 9e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 1e+03]
Found heuristic solution: objective 41.3500822
Presolve time: 0.00s
Presolved: 630 rows, 362 columns, 1710 nonzeros
Presolved model has 273 quadratic objective terms
Variable types: 92 continuous, 270 integer (270 binary)

Root relaxation: objective 9.541948e+00, 911 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    9.54195    0  134   41.35008    9.54195  76.9%     -    0s
H    0     0                      24.5981141    9.54195  61.2%     -    0s
H    0     0                      24.1437639   10.01144  58.5%     -    0s
     0     0   10.01144    0  137   24.14376   10.01144  58.5%     -    0s
     0     2   10.26128    0  137   24.14376   10.26128  57.5%     -    0s

Cutting planes:
  Learned: 23
  Clique: 2
  Inf proof: 2

Explored 918 nodes (23847 simplex iterations) in 0.47 seconds (0.46 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 24.1438 24.5981 41.3501 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.414376393647e+01, best bound 2.414376393647e+01, gap 0.0000%

User-callback calls 2194, time in user-callback 0.00 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 24.14376393647353.
The root upper bound is: 24.14376393647353, lower bound is: 10.261284450391068. The root gap is: 57.4992%. Runtime: 0.4688599109649658.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 631 rows, 363 columns and 1893 nonzeros
Model fingerprint: 0x00bf806d
Model has 273 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 93 continuous, 270 integer (270 binary)
Coefficient statistics:
  Matrix range     [2e-02, 1e+03]
  QMatrix range    [7e-02, 5e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [2e-02, 5e+01]
  QObjective range [8e-10, 1e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 1e+03]
Presolve time: 0.00s
Presolved: 631 rows, 363 columns, 1893 nonzeros
Presolved model has 273 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 93 continuous, 270 integer (270 binary)

Root relaxation: objective 2.412440e+01, 942 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   24.12440    0  116          -   24.12440      -     -    0s
     0     0   24.12662    0  106          -   24.12662      -     -    0s
H    0     0                      58.3263064   24.12662  58.6%     -    0s
     0     0   24.12666    0  113   58.32631   24.12666  58.6%     -    0s
     0     0   24.12739    0  105   58.32631   24.12739  58.6%     -    0s
     0     0   24.12739    0  109   58.32631   24.12739  58.6%     -    0s
     0     0   24.12767    0  106   58.32631   24.12767  58.6%     -    0s
     0     0   24.12767    0  106   58.32631   24.12767  58.6%     -    0s
     0     0   24.12776    0  104   58.32631   24.12776  58.6%     -    0s
     0     0   24.12781    0  100   58.32631   24.12781  58.6%     -    0s
     0     0   24.12792    0  100   58.32631   24.12792  58.6%     -    0s
     0     0   24.12796    0   85   58.32631   24.12796  58.6%     -    0s
     0     0   24.12824    0   78   58.32631   24.12824  58.6%     -    0s
     0     0   24.12837    0   78   58.32631   24.12837  58.6%     -    0s
     0     0   24.12894    0   82   58.32631   24.12894  58.6%     -    0s
     0     0   24.12894    0   82   58.32631   24.12894  58.6%     -    0s
H    0     0                      49.1794890   24.12907  50.9%     -    0s
     0     0   24.12907    0   82   49.17949   24.12907  50.9%     -    0s
     0     0   24.12918    0   72   49.17949   24.12918  50.9%     -    0s
     0     0   24.12937    0   74   49.17949   24.12937  50.9%     -    0s
     0     0   24.12944    0   68   49.17949   24.12944  50.9%     -    0s
     0     0   24.12950    0   74   49.17949   24.12950  50.9%     -    0s
     0     0   24.12951    0   75   49.17949   24.12951  50.9%     -    0s
     0     0   24.12962    0   70   49.17949   24.12962  50.9%     -    0s
     0     0   24.12983    0   70   49.17949   24.12983  50.9%     -    0s
     0     0   24.12996    0   62   49.17949   24.12996  50.9%     -    0s
     0     0   24.13001    0   62   49.17949   24.13001  50.9%     -    0s
     0     0   24.13013    0   60   49.17949   24.13013  50.9%     -    0s
     0     0   24.13015    0   60   49.17949   24.13015  50.9%     -    0s
H    0     0                      49.1794844   24.13015  50.9%     -    0s
     0     0   24.13026    0   62   49.17948   24.13026  50.9%     -    0s
     0     0   24.13026    0   56   49.17948   24.13026  50.9%     -    0s
     0     0   24.13031    0   56   49.17948   24.13031  50.9%     -    0s
     0     0   24.13050    0   64   49.17948   24.13050  50.9%     -    0s
H    0     0                      45.2830648   24.13056  46.7%     -    0s
     0     0   24.13056    0   65   45.28306   24.13056  46.7%     -    0s
     0     0   24.13076    0   72   45.28306   24.13076  46.7%     -    0s
     0     0   24.13087    0   71   45.28306   24.13087  46.7%     -    0s
     0     0   24.13087    0   63   45.28306   24.13087  46.7%     -    0s
     0     0   24.13096    0   62   45.28306   24.13096  46.7%     -    0s
     0     0   24.13102    0   60   45.28306   24.13102  46.7%     -    0s
     0     0   24.13110    0   63   45.28306   24.13110  46.7%     -    0s
     0     0   24.13116    0   59   45.28306   24.13116  46.7%     -    0s
     0     0   24.13116    0   71   45.28306   24.13116  46.7%     -    0s
     0     0   24.13116    0   62   45.28306   24.13116  46.7%     -    0s
     0     0   24.13337    0   70   45.28306   24.13337  46.7%     -    0s
     0     0   24.13337    0   56   45.28306   24.13337  46.7%     -    0s
     0     0   24.13365    0   54   45.28306   24.13365  46.7%     -    1s
H    0     0                      42.5247302   24.13462  43.2%     -    1s
     0     0   24.13462    0   59   42.52473   24.13462  43.2%     -    1s
     0     0   24.13577    0   66   42.52473   24.13577  43.2%     -    1s
     0     0   24.13577    0   57   42.52473   24.13577  43.2%     -    1s
     0     0   24.13577    0   70   42.52473   24.13577  43.2%     -    1s
     0     0   24.13577    0   63   42.52473   24.13577  43.2%     -    1s
     0     0   24.13577    0   53   42.52473   24.13577  43.2%     -    1s
H    0     0                      25.0265123   24.13577  3.56%     -    1s
     0     0   24.13662    0   61   25.02651   24.13662  3.56%     -    1s
     0     0   24.13662    0   68   25.02651   24.13662  3.56%     -    1s
     0     0   24.13662    0   70   25.02651   24.13662  3.56%     -    1s
     0     0   24.13708    0   65   25.02651   24.13708  3.55%     -    1s
     0     0   24.13772    0   77   25.02651   24.13772  3.55%     -    1s
     0     0   24.13802    0   70   25.02651   24.13802  3.55%     -    1s
     0     0   24.13812    0   61   25.02651   24.13812  3.55%     -    1s
     0     0   24.13832    0   71   25.02651   24.13832  3.55%     -    1s
     0     0   24.13885    0   64   25.02651   24.13885  3.55%     -    1s
H    0     0                      24.1437642   24.13885  0.02%     -    1s
     0     0   24.13889    0   48   24.14376   24.13889  0.02%     -    1s
     0     0   24.13987    0   30   24.14376   24.13987  0.02%     -    1s
     0     0   24.14195    0   28   24.14376   24.14195  0.01%     -    1s

Cutting planes:
  Learned: 20
  MIR: 1

Explored 1 nodes (48587 simplex iterations) in 1.66 seconds (1.70 work units)
Thread count was 8 (of 52 available processors)

Solution count 7: 24.1438 25.0265 42.5247 ... 58.3263

Optimal solution found (tolerance 1.00e-04)
Best objective 2.414376419028e+01, best bound 2.414194626403e+01, gap 0.0075%

User-callback calls 660, time in user-callback 0.00 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
24.143764190275355
The root upper bound is: 24.143764190275355, lower bound is: 24.13889209653632. The root gap is: 0.0202%. Runtime: 1.6591839790344238.
--------------------------------------------------
    m   n  dataset formulation  ...     end_lb   end_gap  node_count       time
0   2  50  autompg    original  ...  13.477040  0.000000       987.0   0.143679
1   2  50  autompg         opt  ...  13.477040  0.000000       185.0   0.204820
2   2  50  autompg     opt_cut  ...  13.476018  0.000076         1.0   0.427783
3   2  60  autompg    original  ...  15.882434  0.000000     29340.0   1.159530
4   2  60  autompg         opt  ...  15.882434  0.000000       424.0   0.269396
5   2  60  autompg     opt_cut  ...  15.881267  0.000073         1.0   0.537511
6   2  70  autompg    original  ...  17.972364  0.000000     78473.0   3.126956
7   2  70  autompg         opt  ...  17.972364  0.000000       548.0   0.328985
8   2  70  autompg     opt_cut  ...  17.970774  0.000089        19.0   1.467074
9   2  80  autompg    original  ...  20.929447  0.000000    476643.0  15.951053
10  2  80  autompg         opt  ...  20.929447  0.000000       841.0   0.367925
11  2  80  autompg     opt_cut  ...  20.927765  0.000080         1.0   3.429426
12  2  90  autompg    original  ...  24.143764  0.000000   2228170.0  81.510934
13  2  90  autompg         opt  ...  24.143764  0.000000       918.0   0.468860
14  2  90  autompg     opt_cut  ...  24.141946  0.000075         1.0   1.659184

[15 rows x 12 columns]
[2, 100, 'autompg']
[0.00351351 0.00449712 1.         1.         1.        ]
The relaxed obj is 0.08163225885550673.
The larges value of x is 2.6517962633804157
Use new Big-M 5.3035925267608315.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 200 rows, 202 columns and 400 nonzeros
Model fingerprint: 0x19b30071
Model has 303 quadratic objective terms
Variable types: 102 continuous, 100 integer (100 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [7e-02, 5e+01]
  QObjective range [1e-01, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 50.0000000
Presolve time: 0.00s
Presolved: 200 rows, 202 columns, 400 nonzeros
Presolved model has 303 quadratic objective terms
Variable types: 102 continuous, 100 integer (100 binary)

Root relaxation: objective 9.771490e+00, 410 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    9.77149    0   72   50.00000    9.77149  80.5%     -    0s
H    0     0                      27.4194733    9.77149  64.4%     -    0s
H    0     0                      25.6575124    9.77149  61.9%     -    0s
H    0     0                      25.5665747    9.77149  61.8%     -    0s
H    0     0                      25.3469167    9.77149  61.4%     -    0s
H    0     0                      25.3307743    9.96490  60.7%     -    0s
     0     0   10.41209    0   72   25.33077   10.41209  58.9%     -    0s
     0     2   10.41209    0   72   25.33077   10.41209  58.9%     -    0s
 109854 63262   23.04369   30   59   25.33077   20.76739  18.0%   6.3    5s
 243467 128005   25.20813   40   44   25.33077   21.65143  14.5%   6.1   10s
 372692 182398   22.58416   26   63   25.33077   22.11181  12.7%   6.1   15s
 503654 230413   25.30335   46   38   25.33077   22.43858  11.4%   6.0   20s
 639029 273999   23.77911   35   49   25.33077   22.68704  10.4%   5.9   25s
 768346 311432   24.74517   33   50   25.33077   22.88696  9.65%   5.9   30s
 898383 343906   24.80113   36   47   25.33077   23.05488  8.98%   5.9   35s
 1026834 371535   24.04039   30   55   25.33077   23.19891  8.42%   5.8   40s
 1160826 396484   24.75917   31   56   25.33077   23.33554  7.88%   5.8   45s
 1293678 416942   25.12689   41   43   25.33077   23.45727  7.40%   5.8   50s
 1426908 433460   25.15495   37   45   25.33077   23.56712  6.96%   5.8   55s
 1558559 445916   23.66853   32   53   25.33077   23.66708  6.57%   5.7   60s
 1691615 454285   24.97657   32   55   25.33077   23.76238  6.19%   5.7   65s
 1820577 458513   25.03634   31   58   25.33077   23.85145  5.84%   5.7   70s
 1950229 459609   24.54524   33   54   25.33077   23.93661  5.50%   5.7   75s
 2086906 456785   24.55531   34   50   25.33077   24.02400  5.16%   5.6   80s
 2215248 450371   24.79740   37   50   25.33077   24.10567  4.84%   5.6   85s
 2349546 439693   25.22795   36   49   25.33077   24.19077  4.50%   5.6   90s
 2482440 424377   24.81384   35   50   25.33077   24.27530  4.17%   5.6   95s
 2611490 404954   25.30396   34   55   25.33077   24.35792  3.84%   5.5  100s
 2739634 381956   24.74781   32   52   25.33077   24.43968  3.52%   5.5  105s
 2867349 352344   25.11248   36   49   25.33077   24.52429  3.18%   5.5  110s
 2999616 314711   24.98094   32   56   25.33077   24.61768  2.82%   5.4  115s
 3124785 275834   25.11107   37   52   25.33077   24.70927  2.45%   5.4  120s
 3253452 231468   25.23498   31   58   25.33077   24.80904  2.06%   5.4  125s
 3381181 182049   24.91872   33   50   25.33077   24.91850  1.63%   5.4  130s
 3512968 121478   25.05274   35   51   25.33077   25.05220  1.10%   5.3  135s
 3634117 47127   25.21621   37   53   25.33077   25.21576  0.45%   5.3  140s

Explored 3689803 nodes (19316318 simplex iterations) in 142.39 seconds (193.48 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 25.3308 25.3469 27.4195 50 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.533077425987e+01, best bound 2.533077425987e+01, gap 0.0000%

User-callback calls 7392942, time in user-callback 9.46 sec
--------------------------------
solve the problem in original formulation
The obj is 25.330774259865535.
The root upper bound is: 25.330774259865535, lower bound is: 10.412085121895444. The root gap is: 58.8955%. Runtime: 142.39015889167786.
[25 26 27 28 51 54 81 83 84]
Number of outliers: 9
--------------------------------
The decomposition time is 0.10407200641930103.
Optimal value: 99.99999977699778
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.09572322107851505.
Optimal value: 99.99999977699778
9.771495645722595
25.327799241323234
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 700 rows, 402 columns and 1900 nonzeros
Model fingerprint: 0xc3e3fdae
Model has 303 quadratic objective terms
Variable types: 102 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+03]
  Objective range  [7e-02, 5e+01]
  QObjective range [1e-01, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-02, 1e+03]
Found heuristic solution: objective 40.3530018
Presolve time: 0.00s
Presolved: 700 rows, 402 columns, 1900 nonzeros
Presolved model has 303 quadratic objective terms
Variable types: 102 continuous, 300 integer (300 binary)

Root relaxation: objective 9.771490e+00, 1018 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    9.77149    0  144   40.35300    9.77149  75.8%     -    0s
H    0     0                      26.7771279    9.77149  63.5%     -    0s
H    0     0                      25.3307743    9.77149  61.4%     -    0s
     0     0   10.25295    0  145   25.33077   10.25295  59.5%     -    0s
     0     2   11.04800    0  145   25.33077   11.04800  56.4%     -    0s

Cutting planes:
  Learned: 49
  Cover: 9
  Clique: 7
  Inf proof: 34

Explored 2899 nodes (77918 simplex iterations) in 1.22 seconds (1.19 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 25.3308 26.7771 40.353 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.533077425987e+01, best bound 2.533077425987e+01, gap 0.0000%

User-callback calls 6295, time in user-callback 0.01 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 25.33077425986554.
The root upper bound is: 25.33077425986554, lower bound is: 11.048002359746999. The root gap is: 56.3851%. Runtime: 1.223505973815918.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 701 rows, 403 columns and 2103 nonzeros
Model fingerprint: 0xb8468056
Model has 303 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 103 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+03]
  QMatrix range    [7e-02, 5e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [7e-02, 5e+01]
  QObjective range [2e-09, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-02, 1e+03]
Presolve time: 0.00s
Presolved: 701 rows, 403 columns, 2103 nonzeros
Presolved model has 303 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 103 continuous, 300 integer (300 binary)

Root relaxation: objective 2.532081e+01, 806 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   25.32081    0   76          -   25.32081      -     -    0s
H    0     0                      53.6052412   25.32081  52.8%     -    0s
H    0     0                      53.2423801   25.32081  52.4%     -    0s
     0     0   25.32081    0  132   53.24238   25.32081  52.4%     -    0s
H    0     0                      53.1463006   25.32081  52.4%     -    0s
     0     0   25.32081    0  132   53.14630   25.32081  52.4%     -    0s
     0     0   25.32106    0  134   53.14630   25.32106  52.4%     -    0s
     0     0   25.32106    0  134   53.14630   25.32106  52.4%     -    0s
     0     0   25.32109    0  132   53.14630   25.32109  52.4%     -    0s
     0     0   25.32109    0  132   53.14630   25.32109  52.4%     -    0s
     0     0   25.32111    0  132   53.14630   25.32111  52.4%     -    0s
     0     0   25.32114    0  132   53.14630   25.32114  52.4%     -    0s
     0     0   25.32116    0  132   53.14630   25.32116  52.4%     -    0s
     0     0   25.32117    0  132   53.14630   25.32117  52.4%     -    0s
     0     0   25.32118    0  132   53.14630   25.32118  52.4%     -    0s
     0     0   25.32118    0  132   53.14630   25.32118  52.4%     -    0s
     0     0   25.32118    0  132   53.14630   25.32118  52.4%     -    0s
     0     0   25.32119    0  130   53.14630   25.32119  52.4%     -    0s
     0     0   25.32119    0  130   53.14630   25.32119  52.4%     -    0s
     0     0   25.32119    0  130   53.14630   25.32119  52.4%     -    0s
     0     0   25.32120    0  130   53.14630   25.32120  52.4%     -    0s
     0     0   25.32120    0  130   53.14630   25.32120  52.4%     -    0s
     0     0   25.32121    0  130   53.14630   25.32121  52.4%     -    0s
     0     0   25.32123    0  130   53.14630   25.32123  52.4%     -    0s
     0     0   25.32125    0  130   53.14630   25.32125  52.4%     -    0s
     0     0   25.32126    0  130   53.14630   25.32126  52.4%     -    0s
     0     0   25.32127    0  130   53.14630   25.32127  52.4%     -    0s
     0     0   25.32128    0  130   53.14630   25.32128  52.4%     -    0s
     0     0   25.32129    0  130   53.14630   25.32129  52.4%     -    0s
     0     0   25.32129    0  130   53.14630   25.32129  52.4%     -    0s
     0     0   25.32130    0  130   53.14630   25.32130  52.4%     -    0s
     0     0   25.32130    0  130   53.14630   25.32130  52.4%     -    0s
     0     0   25.32131    0  130   53.14630   25.32131  52.4%     -    0s
     0     0   25.32131    0  130   53.14630   25.32131  52.4%     -    0s
     0     0   25.32131    0  130   53.14630   25.32131  52.4%     -    0s
     0     0   25.32132    0  130   53.14630   25.32132  52.4%     -    0s
     0     0   25.32132    0  130   53.14630   25.32132  52.4%     -    0s
     0     0   25.32133    0  130   53.14630   25.32133  52.4%     -    0s
     0     0   25.32134    0  130   53.14630   25.32134  52.4%     -    0s
     0     0   25.32136    0  130   53.14630   25.32136  52.4%     -    0s
     0     0   25.32137    0  130   53.14630   25.32137  52.4%     -    0s
     0     0   25.32138    0  130   53.14630   25.32138  52.4%     -    0s
     0     0   25.32138    0  130   53.14630   25.32138  52.4%     -    0s
     0     0   25.32139    0  130   53.14630   25.32139  52.4%     -    0s
     0     0   25.32140    0  130   53.14630   25.32140  52.4%     -    0s
     0     0   25.32141    0  130   53.14630   25.32141  52.4%     -    0s
     0     0   25.32141    0  130   53.14630   25.32141  52.4%     -    0s
     0     0   25.32142    0  130   53.14630   25.32142  52.4%     -    0s
     0     0   25.32142    0  130   53.14630   25.32142  52.4%     -    0s
     0     0   25.32142    0  130   53.14630   25.32142  52.4%     -    0s
     0     0   25.32142    0  130   53.14630   25.32142  52.4%     -    0s
     0     0   25.32142    0  132   53.14630   25.32142  52.4%     -    0s
     0     0   25.32142    0  132   53.14630   25.32142  52.4%     -    0s
     0     0   25.32144    0  132   53.14630   25.32144  52.4%     -    0s
     0     0   25.32148    0  132   53.14630   25.32148  52.4%     -    0s
     0     0   25.32151    0  132   53.14630   25.32151  52.4%     -    0s
     0     0   25.32151    0  126   53.14630   25.32151  52.4%     -    0s
H    0     0                      50.4675524   25.32151  49.8%     -    0s
     0     0   25.32151    0  128   50.46755   25.32151  49.8%     -    0s
     0     0   25.32151    0  128   50.46755   25.32151  49.8%     -    0s
     0     0   25.32151    0  128   50.46755   25.32151  49.8%     -    0s
     0     0   25.32151    0  128   50.46755   25.32151  49.8%     -    0s
     0     0   25.32151    0  128   50.46755   25.32151  49.8%     -    0s
     0     0   25.32151    0  128   50.46755   25.32151  49.8%     -    0s
     0     0   25.32151    0  128   50.46755   25.32151  49.8%     -    0s
     0     0   25.32151    0  128   50.46755   25.32151  49.8%     -    0s
     0     0   25.32151    0  128   50.46755   25.32151  49.8%     -    0s
     0     0   25.32152    0  128   50.46755   25.32152  49.8%     -    0s
     0     0   25.32153    0  128   50.46755   25.32153  49.8%     -    0s
     0     0   25.32154    0  128   50.46755   25.32154  49.8%     -    0s
     0     0   25.32155    0  128   50.46755   25.32155  49.8%     -    0s
     0     0   25.32155    0  128   50.46755   25.32155  49.8%     -    0s
     0     0   25.32156    0  128   50.46755   25.32156  49.8%     -    0s
     0     0   25.32156    0  128   50.46755   25.32156  49.8%     -    0s
     0     0   25.32156    0  128   50.46755   25.32156  49.8%     -    0s
     0     0   25.32156    0  128   50.46755   25.32156  49.8%     -    0s
     0     0   25.32157    0  128   50.46755   25.32157  49.8%     -    0s
     0     0   25.32157    0  128   50.46755   25.32157  49.8%     -    0s
     0     0   25.32158    0  128   50.46755   25.32158  49.8%     -    0s
     0     0   25.32158    0  128   50.46755   25.32158  49.8%     -    0s
     0     0   25.32158    0  128   50.46755   25.32158  49.8%     -    0s
     0     0   25.32159    0  128   50.46755   25.32159  49.8%     -    0s
     0     0   25.32159    0  128   50.46755   25.32159  49.8%     -    0s
     0     0   25.32159    0  130   50.46755   25.32159  49.8%     -    0s
     0     0   25.32159    0  130   50.46755   25.32159  49.8%     -    0s
     0     0   25.32159    0  130   50.46755   25.32159  49.8%     -    0s
     0     0   25.32159    0  130   50.46755   25.32159  49.8%     -    0s
     0     0   25.32159    0  130   50.46755   25.32159  49.8%     -    0s
     0     0   25.32160    0  130   50.46755   25.32160  49.8%     -    0s
     0     0   25.32161    0  130   50.46755   25.32161  49.8%     -    0s
     0     0   25.32162    0  130   50.46755   25.32162  49.8%     -    0s
     0     0   25.32162    0  130   50.46755   25.32162  49.8%     -    0s
     0     0   25.32163    0  130   50.46755   25.32163  49.8%     -    0s
     0     0   25.32163    0  130   50.46755   25.32163  49.8%     -    0s
     0     0   25.32164    0  130   50.46755   25.32164  49.8%     -    0s
     0     0   25.32165    0  130   50.46755   25.32165  49.8%     -    0s
     0     0   25.32166    0  130   50.46755   25.32166  49.8%     -    0s
     0     0   25.32167    0  130   50.46755   25.32167  49.8%     -    0s
     0     0   25.32167    0  130   50.46755   25.32167  49.8%     -    0s
     0     0   25.32168    0  130   50.46755   25.32168  49.8%     -    0s
     0     0   25.32168    0  130   50.46755   25.32168  49.8%     -    0s
     0     0   25.32168    0  130   50.46755   25.32168  49.8%     -    0s
     0     0   25.32168    0  130   50.46755   25.32168  49.8%     -    0s
     0     0   25.32169    0  130   50.46755   25.32169  49.8%     -    0s
     0     0   25.32169    0  130   50.46755   25.32169  49.8%     -    0s
     0     0   25.32169    0  130   50.46755   25.32169  49.8%     -    0s
     0     0   25.32171    0  130   50.46755   25.32171  49.8%     -    0s
     0     0   25.32173    0  130   50.46755   25.32173  49.8%     -    0s
H    0     0                      25.3307762   25.32173  0.04%     -    0s
     0     0   25.32884    0   47   25.33078   25.32884  0.01%     -    0s

Explored 1 nodes (5375 simplex iterations) in 0.93 seconds (0.64 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 25.3308 50.4676 53.1463 ... 53.6052

Optimal solution found (tolerance 1.00e-04)
Best objective 2.533077615000e+01, best bound 2.532884180349e+01, gap 0.0076%

User-callback calls 1112, time in user-callback 0.00 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
25.330776150003796
The root upper bound is: 50.4675523592399, lower bound is: 25.32172831904653. The root gap is: 49.8257%. Runtime: 0.9274020195007324.
--------------------------------------------------
    m    n  dataset formulation  ...     end_lb   end_gap  node_count        time
0   2   50  autompg    original  ...  13.477040  0.000000       987.0    0.143679
1   2   50  autompg         opt  ...  13.477040  0.000000       185.0    0.204820
2   2   50  autompg     opt_cut  ...  13.476018  0.000076         1.0    0.427783
3   2   60  autompg    original  ...  15.882434  0.000000     29340.0    1.159530
4   2   60  autompg         opt  ...  15.882434  0.000000       424.0    0.269396
5   2   60  autompg     opt_cut  ...  15.881267  0.000073         1.0    0.537511
6   2   70  autompg    original  ...  17.972364  0.000000     78473.0    3.126956
7   2   70  autompg         opt  ...  17.972364  0.000000       548.0    0.328985
8   2   70  autompg     opt_cut  ...  17.970774  0.000089        19.0    1.467074
9   2   80  autompg    original  ...  20.929447  0.000000    476643.0   15.951053
10  2   80  autompg         opt  ...  20.929447  0.000000       841.0    0.367925
11  2   80  autompg     opt_cut  ...  20.927765  0.000080         1.0    3.429426
12  2   90  autompg    original  ...  24.143764  0.000000   2228170.0   81.510934
13  2   90  autompg         opt  ...  24.143764  0.000000       918.0    0.468860
14  2   90  autompg     opt_cut  ...  24.141946  0.000075         1.0    1.659184
15  2  100  autompg    original  ...  25.330774  0.000000   3689803.0  142.390159
16  2  100  autompg         opt  ...  25.330774  0.000000      2899.0    1.223506
17  2  100  autompg     opt_cut  ...  25.328842  0.000076         1.0    0.927402

[18 rows x 12 columns]
[2, 120, 'autompg']
[0.00280783 0.00398667 1.         1.         1.        ]
The relaxed obj is 0.097993448279027.
The larges value of x is 2.688891034276679
Use new Big-M 5.377782068553358.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 240 rows, 242 columns and 480 nonzeros
Model fingerprint: 0xd67bae81
Model has 363 quadratic objective terms
Variable types: 122 continuous, 120 integer (120 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [8e-02, 6e+01]
  QObjective range [7e-02, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 60.0000000
Presolve time: 0.00s
Presolved: 240 rows, 242 columns, 480 nonzeros
Presolved model has 363 quadratic objective terms
Variable types: 122 continuous, 120 integer (120 binary)

Root relaxation: objective 1.274358e+01, 470 iterations, 0.00 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   12.74358    0   92   60.00000   12.74358  78.8%     -    0s
H    0     0                      37.2407908   12.74358  65.8%     -    0s
H    0     0                      35.9683822   12.74358  64.6%     -    0s
H    0     0                      34.1010968   12.74358  62.6%     -    0s
H    0     0                      33.9493036   12.74358  62.5%     -    0s
     0     0   12.74358    0   92   33.94930   12.74358  62.5%     -    0s
H    0     0                      33.5217309   12.74358  62.0%     -    0s
     0     2   12.74358    0   92   33.52173   12.74358  62.0%     -    0s
 44254 32412   26.74451   30   81   33.52173   22.34952  33.3%   6.2    5s
 136057 97035   30.60176   36   75   33.52173   24.05981  28.2%   6.0   10s
 237510 172516     cutoff   35        33.52173   24.81376  26.0%   5.9   15s
 355893 249006   29.04491   32   78   33.52173   25.30994  24.5%   5.8   20s
 464182 321178   33.46453   39   71   33.52173   25.63912  23.5%   5.8   25s
 577776 398135   30.67167   35   73   33.52173   25.89591  22.7%   5.8   30s
 687914 470515   30.02225   38   71   33.52173   26.10708  22.1%   5.7   35s
 796798 542115   32.68961   51   55   33.52173   26.27369  21.6%   5.7   40s
 911854 618591   27.90186   33   73   33.52173   26.42512  21.2%   5.7   45s
 1019261 688724   30.72436   40   68   33.52173   26.55234  20.8%   5.7   50s
 1137276 763925   27.35819   30   79   33.52173   26.67847  20.4%   5.7   55s
 1244920 833324   26.78486   29   74   33.52173   26.77748  20.1%   5.7   60s
 1358609 905669   33.25785   48   59   33.52173   26.87505  19.8%   5.7   65s
 1471188 977727   31.47307   37   71   33.52173   26.96111  19.6%   5.7   70s
 1578613 1045906   32.62056   48   57   33.52173   27.03918  19.3%   5.7   75s
 1694329 1118788   32.34795   46   60   33.52173   27.11838  19.1%   5.7   80s
 1803400 1188264   27.70645   31   78   33.52173   27.18543  18.9%   5.7   85s
 1921957 1260657   33.37052   55   53   33.52173   27.25652  18.7%   5.7   90s
 2034373 1331120   28.17446   34   74   33.52173   27.31784  18.5%   5.7   95s
 2142156 1402946   31.54043   38   71   33.52173   27.37318  18.3%   5.7  100s
 2257670 1469601     cutoff   39        33.52173   27.42926  18.2%   5.7  105s
 2366088 1536633   27.48107   33   76   33.52173   27.47789  18.0%   5.7  110s
 2479633 1606322   32.56645   44   62   33.52173   27.52805  17.9%   5.7  115s
 2584852 1670093   28.35141   31   80   33.52173   27.57310  17.7%   5.7  120s
 2698150 1739059   28.88478   33   79   33.52173   27.61922  17.6%   5.7  125s
 2804375 1803079   29.11565   32   81   33.52173   27.66003  17.5%   5.7  130s
 2921010 1872585   32.52791   53   55   33.52173   27.70360  17.4%   5.7  135s
 3027444 1937315   28.17356   35   73   33.52173   27.74137  17.2%   5.7  140s
 3130277 1998707   30.62513   31   75   33.52173   27.77733  17.1%   5.7  145s
 3245616 2067588   29.52950   33   78   33.52173   27.81658  17.0%   5.7  150s
 3353533 2132250   31.41548   35   71   33.52173   27.85121  16.9%   5.7  155s
 3462714 2196688   33.40116   41   71   33.52173   27.88570  16.8%   5.7  160s
 3569883 2260139   33.31516   45   68   33.52173   27.91823  16.7%   5.7  165s
 3686741 2329609   32.46896   47   58   33.52173   27.95243  16.6%   5.7  170s
 3795734 2394229   32.69068   42   66   33.52173   27.98386  16.5%   5.7  175s
 3901499 2456516   28.81506   33   80   33.52173   28.01287  16.4%   5.7  180s
 4012382 2521149   33.02507   42   69   33.52173   28.04353  16.3%   5.7  185s
 4123965 2585213   29.45016   33   77   33.52173   28.07354  16.3%   5.7  190s
 4232185 2648738   33.48078   44   61   33.52173   28.10076  16.2%   5.7  195s
 4341629 2712659     cutoff   44        33.52173   28.12714  16.1%   5.7  200s
 4447841 2773341   31.13096   42   66   33.52173   28.15302  16.0%   5.7  205s
 4561249 2838551   29.63258   35   76   33.52173   28.17912  15.9%   5.7  210s
 4667667 2899559   33.12228   35   78   33.52173   28.20385  15.9%   5.7  215s
 4783272 2965829   28.87727   32   81   33.52173   28.23007  15.8%   5.7  220s
 4891178 3028092   29.65770   37   68   33.52173   28.25451  15.7%   5.7  225s
 5003293 3091900   29.64720   34   73   33.52173   28.27715  15.6%   5.7  230s
 5105999 3150336   32.83684   48   58   33.52173   28.29844  15.6%   5.7  235s
 5219455 3215158     cutoff   41        33.52173   28.32161  15.5%   5.7  240s
 5333533 3279465   32.22567   41   66   33.52173   28.34384  15.4%   5.7  245s
 5439824 3339402     cutoff   48        33.52173   28.36510  15.4%   5.7  250s
 5554864 3403271   32.78901   46   58   33.52173   28.38663  15.3%   5.7  255s
 5657111 3460251   30.42950   34   79   33.52173   28.40629  15.3%   5.7  260s
 5770854 3523201   32.57441   42   62   33.52173   28.42714  15.2%   5.7  265s
 5877581 3582859   33.33546   38   73   33.52173   28.44607  15.1%   5.7  270s
 5989174 3644206   31.60926   39   68   33.52173   28.46564  15.1%   5.7  275s
 6103914 3708060   30.87446   38   70   33.52173   28.48538  15.0%   5.7  280s
 6217335 3770768     cutoff   48        33.52173   28.50427  15.0%   5.7  285s
 6335833 3835770   30.93855   40   68   33.52173   28.52351  14.9%   5.7  290s
 6448673 3898284   31.09635   36   76   33.52173   28.54192  14.9%   5.7  295s
 6562161 3960347   31.42750   38   75   33.52173   28.55982  14.8%   5.7  300s

Explored 6562358 nodes (37469927 simplex iterations) in 300.00 seconds (483.43 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 33.5217 33.9493 35.9684 ... 60

Time limit reached
Best objective 3.352173087785e+01, best bound 2.855984215325e+01, gap 14.8020%

User-callback calls 13154566, time in user-callback 16.78 sec
--------------------------------
solve the problem in original formulation
The obj is 33.521730877854615.
The root upper bound is: 33.521730877854615, lower bound is: 12.743576034984912. The root gap is: 61.9841%. Runtime: 300.00343203544617.
[ 25  26  27  28  51  54  81  84 102 114 117 118]
Number of outliers: 12
--------------------------------
The decomposition time is 0.13962597772479057.
Optimal value: 119.99999989445058
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.13306484557688236.
Optimal value: 119.99999989445058
12.743578086443762
33.52052812976099
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 840 rows, 482 columns and 2280 nonzeros
Model fingerprint: 0x6c7dbffa
Model has 363 quadratic objective terms
Variable types: 122 continuous, 360 integer (360 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+03]
  Objective range  [8e-02, 6e+01]
  QObjective range [7e-02, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [8e-02, 1e+03]
Found heuristic solution: objective 72.8316269
Presolve time: 0.00s
Presolved: 840 rows, 482 columns, 2280 nonzeros
Presolved model has 363 quadratic objective terms
Variable types: 122 continuous, 360 integer (360 binary)
Found heuristic solution: objective 71.4299679

Root relaxation: objective 1.274358e+01, 1150 iterations, 0.02 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   12.74358    0  184   71.42997   12.74358  82.2%     -    0s
H    0     0                      36.0913183   12.74358  64.7%     -    0s
H    0     0                      33.5217309   12.74358  62.0%     -    0s
     0     0   13.21931    0  184   33.52173   13.21931  60.6%     -    0s
     0     2   13.55803    0  184   33.52173   13.55803  59.6%     -    0s

Cutting planes:
  Learned: 84
  Cover: 100
  Clique: 3
  Inf proof: 84

Explored 6372 nodes (157593 simplex iterations) in 1.86 seconds (2.79 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 33.5217 36.0913 71.43 72.8316 

Optimal solution found (tolerance 1.00e-04)
Best objective 3.352173087785e+01, best bound 3.352173087785e+01, gap 0.0000%

User-callback calls 13307, time in user-callback 0.02 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 33.5217308778546.
The root upper bound is: 33.5217308778546, lower bound is: 13.558026220318986. The root gap is: 59.5545%. Runtime: 1.8585970401763916.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 841 rows, 483 columns and 2523 nonzeros
Model fingerprint: 0x0cf703b4
Model has 363 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 123 continuous, 360 integer (360 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+03]
  QMatrix range    [4e-02, 6e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [8e-02, 6e+01]
  QObjective range [7e-10, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [8e-02, 1e+03]
Presolve time: 0.01s
Presolved: 841 rows, 483 columns, 2523 nonzeros
Presolved model has 363 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 123 continuous, 360 integer (360 binary)

Root relaxation: objective 3.351981e+01, 1150 iterations, 0.02 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   33.51981    0   44          -   33.51981      -     -    0s
H    0     0                      83.6973564   33.51981  60.0%     -    0s
H    0     0                      83.6973489   33.51981  60.0%     -    0s
     0     0   33.52011    0   52   83.69735   33.52011  60.0%     -    0s
H    0     0                      80.8072266   33.52011  58.5%     -    0s
     0     0   33.52011    0   54   80.80723   33.52011  58.5%     -    0s
H    0     0                      39.4970741   33.52011  15.1%     -    0s
     0     0   33.52011    0   52   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   52   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   52   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   52   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   52   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   50   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   56   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   68   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   74   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   66   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   66   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   66   39.49707   33.52011  15.1%     -    0s
H    0     0                      39.4970741   33.52011  15.1%     -    0s
     0     0   33.52011    0   64   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   64   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   64   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   66   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   78   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   84   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   82   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52011    0   86   39.49707   33.52011  15.1%     -    0s
     0     0   33.52012    0   86   39.49707   33.52012  15.1%     -    0s
     0     0   33.52012    0   86   39.49707   33.52012  15.1%     -    0s
     0     0   33.52012    0   86   39.49707   33.52012  15.1%     -    0s
     0     0   33.52012    0   86   39.49707   33.52012  15.1%     -    0s
     0     0   33.52012    0   86   39.49707   33.52012  15.1%     -    0s
     0     0   33.52012    0   86   39.49707   33.52012  15.1%     -    0s
H    0     0                      34.4392121   33.52012  2.67%     -    0s
H    0     0                      33.5217314   33.52012  0.00%     -    0s

Cutting planes:
  Learned: 23
  MIR: 2
  RLT: 7

Explored 1 nodes (4639 simplex iterations) in 0.79 seconds (0.50 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 33.5217 34.4392 39.4971 ... 83.6974

Optimal solution found (tolerance 1.00e-04)
Best objective 3.352173143389e+01, best bound 3.352045756850e+01, gap 0.0038%

User-callback calls 967, time in user-callback 0.00 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
33.521731433885435
The root upper bound is: 39.497074062590805, lower bound is: 33.52011857335329. The root gap is: 15.1327%. Runtime: 0.7872829437255859.
--------------------------------------------------
    m    n  dataset formulation  ...     end_lb   end_gap  node_count        time
0   2   50  autompg    original  ...  13.477040  0.000000       987.0    0.143679
1   2   50  autompg         opt  ...  13.477040  0.000000       185.0    0.204820
2   2   50  autompg     opt_cut  ...  13.476018  0.000076         1.0    0.427783
3   2   60  autompg    original  ...  15.882434  0.000000     29340.0    1.159530
4   2   60  autompg         opt  ...  15.882434  0.000000       424.0    0.269396
5   2   60  autompg     opt_cut  ...  15.881267  0.000073         1.0    0.537511
6   2   70  autompg    original  ...  17.972364  0.000000     78473.0    3.126956
7   2   70  autompg         opt  ...  17.972364  0.000000       548.0    0.328985
8   2   70  autompg     opt_cut  ...  17.970774  0.000089        19.0    1.467074
9   2   80  autompg    original  ...  20.929447  0.000000    476643.0   15.951053
10  2   80  autompg         opt  ...  20.929447  0.000000       841.0    0.367925
11  2   80  autompg     opt_cut  ...  20.927765  0.000080         1.0    3.429426
12  2   90  autompg    original  ...  24.143764  0.000000   2228170.0   81.510934
13  2   90  autompg         opt  ...  24.143764  0.000000       918.0    0.468860
14  2   90  autompg     opt_cut  ...  24.141946  0.000075         1.0    1.659184
15  2  100  autompg    original  ...  25.330774  0.000000   3689803.0  142.390159
16  2  100  autompg         opt  ...  25.330774  0.000000      2899.0    1.223506
17  2  100  autompg     opt_cut  ...  25.328842  0.000076         1.0    0.927402
18  2  120  autompg    original  ...  28.559842  0.148020   6562358.0  300.003432
19  2  120  autompg         opt  ...  33.521731  0.000000      6372.0    1.858597
20  2  120  autompg     opt_cut  ...  33.520458  0.000038         1.0    0.787283

[21 rows x 12 columns]
[2, 150, 'autompg']
[0.00209999 0.00356135 1.         1.         1.        ]
The relaxed obj is 0.1235955321513984.
The larges value of x is 2.4911670916153494
Use new Big-M 4.982334183230699.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 300 rows, 302 columns and 600 nonzeros
Model fingerprint: 0xd6b3d13f
Model has 453 quadratic objective terms
Variable types: 152 continuous, 150 integer (150 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [2e-02, 7e+01]
  QObjective range [7e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 75.0000000
Presolve time: 0.00s
Presolved: 300 rows, 302 columns, 600 nonzeros
Presolved model has 453 quadratic objective terms
Variable types: 152 continuous, 150 integer (150 binary)

Root relaxation: objective 1.884431e+01, 584 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   18.84431    0  122   75.00000   18.84431  74.9%     -    0s
H    0     0                      52.0787416   18.84431  63.8%     -    0s
H    0     0                      50.7475925   18.84431  62.9%     -    0s
H    0     0                      48.9850146   18.84431  61.5%     -    0s
H    0     0                      48.8359154   18.84431  61.4%     -    0s
H    0     0                      48.4247244   18.84431  61.1%     -    0s
     0     0   19.00406    0  122   48.42472   19.00406  60.8%     -    0s
H    0     0                      48.2456845   19.00406  60.6%     -    0s
     0     2   19.00406    0  122   48.24568   19.00406  60.6%     -    0s
 55980 48058   39.88347   34   99   48.24568   27.78104  42.4%   6.0    5s
 150344 128259   38.81054   34   98   48.24568   29.50718  38.8%   5.8   10s
 247290 211184   47.49130   57   74   48.24568   30.17117  37.5%   5.8   15s
 335718 285922   37.22206   36   96   48.24568   30.56739  36.6%   5.7   20s
 431334 366520   39.37961   34   99   48.24568   30.86919  36.0%   5.7   25s
 521232 442244   43.31228   53   78   48.24568   31.10177  35.5%   5.7   30s
 619269 524712   35.10652   36  103   48.24568   31.31346  35.1%   5.7   35s
 714404 605088   45.37828   52   79   48.24568   31.47707  34.8%   5.6   40s
 809110 685613   33.80804   28  107   48.24568   31.61811  34.5%   5.6   45s
 898391 760703   34.86632   33  100   48.24568   31.73739  34.2%   5.6   50s
 1000525 847233   35.46500   34  100   48.24568   31.85831  34.0%   5.6   55s
 1104825 935898   41.72426   48   84   48.24568   31.97327  33.7%   5.6   60s
 1203711 1020053   40.15526   44   90   48.24568   32.06624  33.5%   5.6   65s
 1307681 1107147   37.47054   34   99   48.24568   32.16083  33.3%   5.6   70s
 1406792 1192039   38.72239   35  107   48.24568   32.24517  33.2%   5.6   75s
 1509144 1278128     cutoff   53        48.24568   32.32395  33.0%   5.6   80s
 1610769 1363484   34.84036   33  102   48.24568   32.39892  32.8%   5.6   85s
 1719586 1455905   48.14129   70   60   48.24568   32.47174  32.7%   5.6   90s
 1820189 1540645   37.44256   34   99   48.24568   32.53815  32.6%   5.6   95s
 1926889 1630005   33.94884   32  100   48.24568   32.60695  32.4%   5.6  100s
 2030927 1718479   37.65699   36   97   48.24568   32.66658  32.3%   5.6  105s
 2130431 1803519   45.75552   63   67   48.24568   32.71632  32.2%   5.6  110s
 2233211 1890406   37.65004   34   95   48.24568   32.77212  32.1%   5.6  115s
 2339174 1978480   40.92202   37   96   48.24568   32.82322  32.0%   5.5  120s
 2438576 2062656   48.13393   53   79   48.24568   32.87010  31.9%   5.5  125s
 2537533 2145722   35.37262   30  104   48.24568   32.91278  31.8%   5.5  130s
 2641196 2234029   45.15955   47   82   48.24568   32.95688  31.7%   5.5  135s
 2754107 2328836   38.49275   40   92   48.24568   33.00680  31.6%   5.5  140s
 2852378 2411884   38.56103   35   99   48.24568   33.04501  31.5%   5.5  145s
 2963202 2505363   39.19221   32  102   48.24568   33.08810  31.4%   5.5  150s
 3063912 2590502   41.37220   38   92   48.24568   33.12513  31.3%   5.5  155s
 3167003 2677561   37.49561   34   99   48.24568   33.16100  31.3%   5.5  160s
 3267601 2761105   37.49779   35  100   48.24568   33.19710  31.2%   5.5  165s
 3373211 2850237   41.98214   43   89   48.24568   33.23018  31.1%   5.5  170s
 3472610 2934370   42.18648   41   91   48.24568   33.26251  31.1%   5.5  175s
 3575719 3020063   37.70532   37   96   48.24568   33.29717  31.0%   5.5  180s
 3671341 3100634   35.40877   31  101   48.24568   33.32622  30.9%   5.5  185s
 3777774 3188908   41.90679   40   90   48.24568   33.35875  30.9%   5.5  190s
 3873524 3269446   36.93209   36   94   48.24568   33.38576  30.8%   5.5  195s
 3974371 3355020   43.11081   47   84   48.24568   33.41195  30.7%   5.5  200s
 4073572 3437955   37.66825   34  100   48.24568   33.43925  30.7%   5.5  205s
 4176851 3524137   47.52510   71   62   48.24568   33.46769  30.6%   5.5  210s
 4272504 3603872   33.49736   26  108   48.24568   33.49328  30.6%   5.5  215s
 4372406 3688274   43.06918   48   83   48.24568   33.51727  30.5%   5.5  220s
 4466849 3767426     cutoff   52        48.24568   33.54100  30.5%   5.5  225s
 4572036 3856303   39.68768   35   98   48.24568   33.56871  30.4%   5.5  230s
 4671025 3938916   35.09254   32  101   48.24568   33.59309  30.4%   5.5  235s
 4773331 4024362   37.85955   35   97   48.24568   33.61768  30.3%   5.5  240s
 4869890 4105070   47.51375   81   50   48.24568   33.63899  30.3%   5.5  245s
 4981871 4198495   33.66863   30  104   48.24568   33.66460  30.2%   5.5  250s
 5079219 4280192   45.16213   60   72   48.24568   33.68638  30.2%   5.5  255s
 5182663 4365988   43.79962   51   80   48.24568   33.70978  30.1%   5.5  260s
 5282038 4448619   40.53169   43   89   48.24568   33.73159  30.1%   5.5  265s
 5388657 4537537   34.92778   31  105   48.24568   33.75434  30.0%   5.5  270s
 5487897 4620227   46.82944   61   69   48.24568   33.77405  30.0%   5.5  275s
 5589849 4705679   44.09141   44   90   48.24568   33.79443  30.0%   5.5  280s
 5684069 4785903   43.60443   53   79   48.24568   33.81199  29.9%   5.5  285s
 5792196 4874826   35.82059   33  101   48.24568   33.83371  29.9%   5.5  290s
 5890588 4957503   36.76100   35   96   48.24568   33.85215  29.8%   5.5  295s
 5989388 5040428   45.44562   51   78   48.24568   33.86996  29.8%   5.5  300s

Explored 5989982 nodes (32867556 simplex iterations) in 300.01 seconds (596.22 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 48.2457 48.4247 50.7476 ... 75

Time limit reached
Best objective 4.824568453080e+01, best bound 3.386995655178e+01, gap 29.7969%

User-callback calls 12010621, time in user-callback 14.29 sec
--------------------------------
solve the problem in original formulation
The obj is 48.2456845307982.
The root upper bound is: 48.2456845307982, lower bound is: 19.004055641409437. The root gap is: 60.6098%. Runtime: 300.0068459510803.
[ 25  26  27  28  51  54  81  84 102 114 117 131 141 144 145 146]
Number of outliers: 16
--------------------------------
The decomposition time is 0.21726383082568645.
Optimal value: 149.99999986206888
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.19336288049817085.
Optimal value: 149.99999986206888
18.844319892877508
48.24168626093051
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 1050 rows, 602 columns and 2850 nonzeros
Model fingerprint: 0x91b3137d
Model has 453 quadratic objective terms
Variable types: 152 continuous, 450 integer (450 binary)
Coefficient statistics:
  Matrix range     [3e-02, 1e+03]
  Objective range  [2e-02, 7e+01]
  QObjective range [7e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 1e+03]
Found heuristic solution: objective 94.4855365
Presolve time: 0.00s
Presolved: 1050 rows, 602 columns, 2850 nonzeros
Presolved model has 453 quadratic objective terms
Variable types: 152 continuous, 450 integer (450 binary)

Root relaxation: objective 1.884431e+01, 1260 iterations, 0.02 seconds (0.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   18.84431    0  244   94.48554   18.84431  80.1%     -    0s
H    0     0                      52.1040650   18.84431  63.8%     -    0s
H    0     0                      48.2456845   18.84431  60.9%     -    0s
     0     0   19.30591    0  244   48.24568   19.30591  60.0%     -    0s
     0     0   19.76397    0  244   48.24568   19.76397  59.0%     -    0s
     0     2   19.76397    0  244   48.24568   19.76397  59.0%     -    0s

Cutting planes:
  Learned: 1
  Cover: 3
  Clique: 2

Explored 3739 nodes (103932 simplex iterations) in 2.48 seconds (3.74 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 48.2457 52.1041 94.4855 

Optimal solution found (tolerance 1.00e-04)
Best objective 4.824568453080e+01, best bound 4.824568453080e+01, gap 0.0000%

User-callback calls 8525, time in user-callback 0.01 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 48.245684530798215.
The root upper bound is: 48.245684530798215, lower bound is: 19.76397355987646. The root gap is: 59.0347%. Runtime: 2.4861409664154053.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 1051 rows, 603 columns and 3153 nonzeros
Model fingerprint: 0x96fe98c4
Model has 453 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 153 continuous, 450 integer (450 binary)
Coefficient statistics:
  Matrix range     [2e-02, 1e+03]
  QMatrix range    [3e-02, 8e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [2e-02, 7e+01]
  QObjective range [1e-10, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 1e+03]
Presolve time: 0.01s
Presolved: 1051 rows, 603 columns, 3153 nonzeros
Presolved model has 453 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 153 continuous, 450 integer (450 binary)

Root relaxation: objective 4.823731e+01, 1525 iterations, 0.03 seconds (0.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   48.23731    0  148          -   48.23731      -     -    0s
H    0     0                     222.3757727   48.23731  78.3%     -    0s
H    0     0                     222.3757490   48.23731  78.3%     -    0s
H    0     0                      48.9153166   48.23731  1.39%     -    0s
     0     0   48.23731    0  154   48.91532   48.23731  1.39%     -    0s
H    0     0                      48.8857719   48.23731  1.33%     -    0s
     0     0   48.23759    0  156   48.88577   48.23759  1.33%     -    0s
     0     0   48.23760    0  162   48.88577   48.23760  1.33%     -    0s
     0     0   48.23760    0  166   48.88577   48.23760  1.33%     -    0s
     0     0   48.23760    0  166   48.88577   48.23760  1.33%     -    0s
     0     0   48.23760    0  164   48.88577   48.23760  1.33%     -    0s
     0     0   48.23760    0  164   48.88577   48.23760  1.33%     -    0s
     0     0   48.23760    0  164   48.88577   48.23760  1.33%     -    0s
     0     0   48.23760    0  164   48.88577   48.23760  1.33%     -    0s
     0     0   48.23760    0  164   48.88577   48.23760  1.33%     -    0s
     0     0   48.23760    0  164   48.88577   48.23760  1.33%     -    0s
     0     0   48.23760    0  164   48.88577   48.23760  1.33%     -    0s
     0     0   48.23760    0  164   48.88577   48.23760  1.33%     -    0s
     0     0   48.23760    0  164   48.88577   48.23760  1.33%     -    0s
     0     0   48.23760    0  164   48.88577   48.23760  1.33%     -    0s
     0     0   48.23760    0  164   48.88577   48.23760  1.33%     -    0s
H    0     0                      48.2456861   48.23760  0.02%     -    0s
     0     0   48.23876    0  132   48.24569   48.23876  0.01%     -    0s
     0     0   48.24258    0   77   48.24569   48.24258  0.01%     -    0s

Explored 1 nodes (2921 simplex iterations) in 0.99 seconds (0.69 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 48.2457 48.8858 48.9153 222.376 

Optimal solution found (tolerance 1.00e-04)
Best objective 4.824568614272e+01, best bound 4.824257902388e+01, gap 0.0064%

User-callback calls 691, time in user-callback 0.00 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
48.245686142715506
The root upper bound is: 48.245686142715506, lower bound is: 48.23875606514092. The root gap is: 0.0144%. Runtime: 0.988785982131958.
--------------------------------------------------
    m    n  dataset formulation  ...     end_lb   end_gap  node_count        time
0   2   50  autompg    original  ...  13.477040  0.000000       987.0    0.143679
1   2   50  autompg         opt  ...  13.477040  0.000000       185.0    0.204820
2   2   50  autompg     opt_cut  ...  13.476018  0.000076         1.0    0.427783
3   2   60  autompg    original  ...  15.882434  0.000000     29340.0    1.159530
4   2   60  autompg         opt  ...  15.882434  0.000000       424.0    0.269396
5   2   60  autompg     opt_cut  ...  15.881267  0.000073         1.0    0.537511
6   2   70  autompg    original  ...  17.972364  0.000000     78473.0    3.126956
7   2   70  autompg         opt  ...  17.972364  0.000000       548.0    0.328985
8   2   70  autompg     opt_cut  ...  17.970774  0.000089        19.0    1.467074
9   2   80  autompg    original  ...  20.929447  0.000000    476643.0   15.951053
10  2   80  autompg         opt  ...  20.929447  0.000000       841.0    0.367925
11  2   80  autompg     opt_cut  ...  20.927765  0.000080         1.0    3.429426
12  2   90  autompg    original  ...  24.143764  0.000000   2228170.0   81.510934
13  2   90  autompg         opt  ...  24.143764  0.000000       918.0    0.468860
14  2   90  autompg     opt_cut  ...  24.141946  0.000075         1.0    1.659184
15  2  100  autompg    original  ...  25.330774  0.000000   3689803.0  142.390159
16  2  100  autompg         opt  ...  25.330774  0.000000      2899.0    1.223506
17  2  100  autompg     opt_cut  ...  25.328842  0.000076         1.0    0.927402
18  2  120  autompg    original  ...  28.559842  0.148020   6562358.0  300.003432
19  2  120  autompg         opt  ...  33.521731  0.000000      6372.0    1.858597
20  2  120  autompg     opt_cut  ...  33.520458  0.000038         1.0    0.787283
21  2  150  autompg    original  ...  33.869957  0.297969   5989982.0  300.006846
22  2  150  autompg         opt  ...  48.245685  0.000000      3739.0    2.486141
23  2  150  autompg     opt_cut  ...  48.242579  0.000064         1.0    0.988786

[24 rows x 12 columns]
[2, 200, 'autompg']
[0.00150035 0.00293707 1.         1.         1.        ]
The relaxed obj is 0.16483038724999233.
The larges value of x is 2.4717899636090723
Use new Big-M 4.943579927218145.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 400 rows, 402 columns and 800 nonzeros
Model fingerprint: 0x01a35949
Model has 603 quadratic objective terms
Variable types: 202 continuous, 200 integer (200 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [4e-02, 8e+01]
  QObjective range [3e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 100.0000000
Presolve time: 0.00s
Presolved: 400 rows, 402 columns, 800 nonzeros
Presolved model has 603 quadratic objective terms
Variable types: 202 continuous, 200 integer (200 binary)

Root relaxation: objective 2.678508e+01, 758 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   26.78508    0  166  100.00000   26.78508  73.2%     -    0s
H    0     0                      75.0311600   26.78508  64.3%     -    0s
H    0     0                      72.9999127   26.78508  63.3%     -    0s
H    0     0                      72.9047263   26.78508  63.3%     -    0s
H    0     0                      72.4342902   26.78508  63.0%     -    0s
     0     0   27.38980    0  166   72.43429   27.38980  62.2%     -    0s
H    0     0                      72.3919416   27.38980  62.2%     -    0s
     0     2   27.38980    0  166   72.39194   27.38980  62.2%     -    0s
H  135   145                      72.3884483   30.28586  58.2%   7.8    0s
H  136   145                      72.3793144   30.28586  58.2%   7.8    0s
H  573   583                      72.3343583   30.28586  58.1%   7.8    0s
H  580   583                      72.3137814   30.28586  58.1%   7.8    0s
 34953 31839   45.59636   36  139   72.31378   33.44742  53.7%   6.4    5s
 109302 99600   49.88899   41  135   72.31378   35.44404  51.0%   6.1   10s
 189788 173138   70.89177   69  106   72.31378   36.43708  49.6%   6.1   15s
 258405 236156   65.27556   64  114   72.31378   36.89333  49.0%   6.1   20s
 330328 302776   41.35552   31  147   72.31378   37.19547  48.6%   6.1   25s
 404641 371153   70.91030   69  109   72.31378   37.48647  48.2%   6.1   30s
 480453 440109   46.36039   35  138   72.31378   37.79503  47.7%   6.1   35s
 560586 513718   58.51737   51  123   72.31378   38.02282  47.4%   6.0   40s
 635140 581680   42.88347   31  148   72.31378   38.21547  47.2%   6.0   45s
 709147 650430   40.13808   27  149   72.31378   38.36030  47.0%   6.0   50s
 787345 722356   49.69764   42  135   72.31378   38.50371  46.8%   6.0   55s
 862773 791349   51.65185   43  132   72.31378   38.63525  46.6%   6.0   60s
 938500 860605   61.22014   58  112   72.31378   38.75622  46.4%   6.0   65s
 1005328 922693   49.12579   36  137   72.31378   38.84360  46.3%   6.0   70s
 1082557 992075   54.13953   47  130   72.31378   38.95764  46.1%   6.0   75s
 1157456 1060283   42.27127   29  149   72.31378   39.04427  46.0%   6.0   80s
 1228924 1126763   63.36979   61  110   72.31378   39.12237  45.9%   6.0   85s
 1306086 1197257   62.13137   59  114   72.31378   39.20941  45.8%   6.0   90s
 1381819 1266438   66.19117   75  101   72.31378   39.29911  45.7%   6.0   95s
 1468499 1344456   60.94751   55  120   72.31378   39.38409  45.5%   6.0  100s
 1541324 1409945   45.78039   36  139   72.31378   39.45060  45.4%   6.0  105s
 1610520 1474865   59.24956   56  117   72.31378   39.49949  45.4%   6.0  110s
 1690493 1547891   56.94335   50  124   72.31378   39.57276  45.3%   6.0  115s
 1765747 1615604   42.59099   30  143   72.31378   39.63636  45.2%   6.0  120s
 1841119 1684842   42.65364   32  141   72.31378   39.69217  45.1%   6.0  125s
 1911573 1748985   64.74845   61  115   72.31378   39.74360  45.0%   6.0  130s
 1988021 1819130   47.22934   39  131   72.31378   39.79397  45.0%   6.0  135s
 2063407 1888308   70.40243   91   83   72.31378   39.83650  44.9%   6.0  140s
 2135973 1954135   55.26152   50  125   72.31378   39.88388  44.8%   5.9  145s
 2208123 2020107   41.50534   28  148   72.31378   39.92106  44.8%   5.9  150s
 2280455 2086189   62.58941   60  113   72.31378   39.96475  44.7%   5.9  155s
 2357036 2156184   53.37694   43  134   72.31378   40.00829  44.7%   5.9  160s
 2436500 2229107   54.47595   49  124   72.31378   40.05157  44.6%   5.9  165s
 2510695 2296012   72.24792   71  103   72.31378   40.09193  44.6%   5.9  170s
 2585438 2364656   57.08307   46  134   72.31378   40.12525  44.5%   5.9  175s
 2658971 2431008   46.56429   35  141   72.31378   40.16139  44.5%   5.9  180s
 2737309 2503130   64.56320   62  111   72.31378   40.19836  44.4%   5.9  185s
 2815374 2573299   63.61928   60  115   72.31378   40.23536  44.4%   5.9  190s
 2885828 2638266   44.24839   32  142   72.31378   40.26239  44.3%   5.9  195s
 2962333 2707604   59.28323   59  112   72.31378   40.29453  44.3%   5.9  200s
 3034222 2772996   58.28096   51  121   72.31378   40.32494  44.2%   5.9  205s
 3109590 2841806   48.16879   40  133   72.31378   40.35629  44.2%   5.9  210s
 3185712 2911108   69.10521   96   76   72.31378   40.38770  44.1%   5.9  215s
 3258068 2976458   71.55697   98   73   72.31378   40.41937  44.1%   5.9  220s
 3337125 3048105   45.88012   35  141   72.31378   40.45261  44.1%   5.9  225s
 3415423 3118575   71.66894   75  102   72.31378   40.47896  44.0%   5.9  230s
 3486293 3184554   69.06667   70  105   72.31378   40.50340  44.0%   5.9  235s
 3559146 3251506   51.80410   44  131   72.31378   40.52629  44.0%   5.9  240s
 3631583 3317611   43.99772   30  146   72.31378   40.55008  43.9%   5.9  245s
 3707043 3386515   62.21597   56  116   72.31378   40.57499  43.9%   5.9  250s
 3788486 3460546   61.82674   63  115   72.31378   40.60281  43.9%   5.9  255s
 3861457 3527176   60.97087   55  120   72.31378   40.62751  43.8%   5.9  260s
 3940559 3598754   50.13733   41  138   72.31378   40.65188  43.8%   5.9  265s
 4009515 3662521   63.38638   63  112   72.31378   40.67152  43.8%   5.9  270s
 4083352 3730221   63.34509   70  101   72.31378   40.69193  43.7%   5.9  275s
 4154120 3793879   72.23132   71  110   72.31378   40.71208  43.7%   5.9  280s
 4230929 3863759   46.71321   36  137   72.31378   40.73660  43.7%   5.9  285s
 4299526 3927299   69.84919   82   92   72.31378   40.75368  43.6%   5.9  290s
 4367105 3989162   55.56159   48  126   72.31378   40.77415  43.6%   5.9  295s
 4439758 4055038   50.31154   39  136   72.31378   40.79308  43.6%   5.9  300s

Explored 4440447 nodes (26342577 simplex iterations) in 300.01 seconds (712.19 work units)
Thread count was 8 (of 52 available processors)

Solution count 8: 72.3138 72.3344 72.3793 ... 100

Time limit reached
Best objective 7.231378135709e+01, best bound 4.079307888927e+01, gap 43.5888%

User-callback calls 8910641, time in user-callback 10.17 sec
--------------------------------
solve the problem in original formulation
The obj is 72.31378135708587.
The root upper bound is: 72.39194155814987, lower bound is: 27.38980396553089. The root gap is: 62.1646%. Runtime: 300.00761795043945.
[ 25  26  28  51  54  81  84 117 124 131 141 144 145 146 151 158 159 167 175 181 182 185 186 195 198]
Number of outliers: 25
--------------------------------
The decomposition time is 0.48546081967651844.
Optimal value: 199.9999997645328
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.48375884257256985.
Optimal value: 199.9999997645328
26.785089548199068
72.30944862565438
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 1400 rows, 802 columns and 3800 nonzeros
Model fingerprint: 0x354a4777
Model has 603 quadratic objective terms
Variable types: 202 continuous, 600 integer (600 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+03]
  Objective range  [4e-02, 8e+01]
  QObjective range [3e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [9e-03, 1e+03]
Presolve time: 0.00s
Presolved: 1400 rows, 802 columns, 3800 nonzeros
Presolved model has 603 quadratic objective terms
Variable types: 202 continuous, 600 integer (600 binary)

Root relaxation: objective 2.678508e+01, 2119 iterations, 0.05 seconds (0.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

H    0     0                     112.3365009   26.78508  76.2%     -    0s
     0     0   26.78508    0  332  112.33650   26.78508  76.2%     -    0s
H    0     0                      72.4536627   26.78508  63.0%     -    0s
     0     0   27.23777    0  332   72.45366   27.23777  62.4%     -    0s
H    0     0                      72.3343583   27.23777  62.3%     -    0s
     0     2   29.24930    0  332   72.33436   29.24930  59.6%     -    0s
H   30    28                      72.3137814   29.84405  58.7%  77.5    0s

Cutting planes:
  Learned: 7
  Cover: 2
  Clique: 1

Explored 3168 nodes (92710 simplex iterations) in 3.77 seconds (5.11 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 72.3138 72.3344 72.4537 112.337 

Optimal solution found (tolerance 1.00e-04)
Best objective 7.231378135709e+01, best bound 7.231378135709e+01, gap 0.0000%

User-callback calls 7526, time in user-callback 0.01 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 72.31378135708589.
The root upper bound is: 72.33435830790556, lower bound is: 29.249302419323854. The root gap is: 59.5637%. Runtime: 3.7677268981933594.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 1401 rows, 803 columns and 4203 nonzeros
Model fingerprint: 0x04f56ca3
Model has 603 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 203 continuous, 600 integer (600 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+03]
  QMatrix range    [1e-02, 1e+02]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [4e-02, 8e+01]
  QObjective range [9e-10, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [9e-03, 1e+03]
Presolve time: 0.01s
Presolved: 1401 rows, 803 columns, 4203 nonzeros
Presolved model has 603 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 203 continuous, 600 integer (600 binary)

Root relaxation: objective 7.230307e+01, 2004 iterations, 0.04 seconds (0.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   72.30307    0  230          -   72.30307      -     -    0s
H    0     0                     117.3693589   72.30307  38.4%     -    0s
H    0     0                     117.2726170   72.30307  38.3%     -    0s
     0     0   72.30307    0  282  117.27262   72.30307  38.3%     -    0s
H    0     0                     115.7995631   72.30307  37.6%     -    0s
     0     0   72.30307    0  284  115.79956   72.30307  37.6%     -    0s
     0     0   72.30307    0  296  115.79956   72.30307  37.6%     -    0s
     0     0   72.30316    0  296  115.79956   72.30316  37.6%     -    0s
     0     0   72.30321    0  296  115.79956   72.30321  37.6%     -    0s
     0     0   72.30324    0  296  115.79956   72.30324  37.6%     -    0s
     0     0   72.30327    0  296  115.79956   72.30327  37.6%     -    0s
     0     0   72.30329    0  296  115.79956   72.30329  37.6%     -    0s
     0     0   72.30330    0  296  115.79956   72.30330  37.6%     -    0s
     0     0   72.30331    0  296  115.79956   72.30331  37.6%     -    0s
     0     0   72.30332    0  296  115.79956   72.30332  37.6%     -    0s
H    0     0                      80.5823586   72.30332  10.3%     -    0s
     0     0   72.30332    0  296   80.58236   72.30332  10.3%     -    0s
     0     0   72.30333    0  296   80.58236   72.30333  10.3%     -    0s
     0     0   72.30333    0  296   80.58236   72.30333  10.3%     -    0s
     0     0   72.30333    0  296   80.58236   72.30333  10.3%     -    0s
     0     0   72.30334    0  296   80.58236   72.30334  10.3%     -    0s
     0     0   72.30334    0  296   80.58236   72.30334  10.3%     -    0s
     0     0   72.30334    0  296   80.58236   72.30334  10.3%     -    0s
     0     0   72.30335    0  296   80.58236   72.30335  10.3%     -    0s
     0     0   72.30335    0  296   80.58236   72.30335  10.3%     -    0s
     0     0   72.30336    0  296   80.58236   72.30336  10.3%     -    0s
     0     0   72.30336    0  296   80.58236   72.30336  10.3%     -    0s
     0     0   72.30336    0  296   80.58236   72.30336  10.3%     -    0s
     0     0   72.30337    0  296   80.58236   72.30337  10.3%     -    0s
     0     0   72.30338    0  296   80.58236   72.30338  10.3%     -    0s
     0     0   72.30338    0  296   80.58236   72.30338  10.3%     -    0s
     0     0   72.30339    0  296   80.58236   72.30339  10.3%     -    0s
     0     0   72.30339    0  296   80.58236   72.30339  10.3%     -    0s
     0     0   72.30340    0  296   80.58236   72.30340  10.3%     -    0s
     0     0   72.30340    0  296   80.58236   72.30340  10.3%     -    0s
     0     0   72.30340    0  296   80.58236   72.30340  10.3%     -    0s
     0     0   72.30340    0  296   80.58236   72.30340  10.3%     -    0s
     0     0   72.30341    0  296   80.58236   72.30341  10.3%     -    0s
     0     0   72.30341    0  296   80.58236   72.30341  10.3%     -    0s
     0     0   72.30341    0  296   80.58236   72.30341  10.3%     -    0s
     0     0   72.30342    0  296   80.58236   72.30342  10.3%     -    0s
     0     0   72.30342    0  296   80.58236   72.30342  10.3%     -    0s
     0     0   72.30342    0  296   80.58236   72.30342  10.3%     -    0s
     0     0   72.30343    0  296   80.58236   72.30343  10.3%     -    0s
     0     0   72.30343    0  296   80.58236   72.30343  10.3%     -    1s
H    0     0                      78.8231950   72.30343  8.27%     -    1s
     0     0   72.30343    0  296   78.82319   72.30343  8.27%     -    1s
     0     0   72.30343    0  296   78.82319   72.30343  8.27%     -    1s
     0     0   72.30344    0  296   78.82319   72.30344  8.27%     -    1s
     0     0   72.30344    0  296   78.82319   72.30344  8.27%     -    1s
     0     0   72.30344    0  296   78.82319   72.30344  8.27%     -    1s
     0     0   72.30345    0  296   78.82319   72.30345  8.27%     -    1s
     0     0   72.30345    0  296   78.82319   72.30345  8.27%     -    1s
     0     0   72.30345    0  296   78.82319   72.30345  8.27%     -    1s
     0     0   72.30345    0  296   78.82319   72.30345  8.27%     -    1s
     0     0   72.30346    0  296   78.82319   72.30346  8.27%     -    1s
     0     0   72.30346    0  296   78.82319   72.30346  8.27%     -    1s
     0     0   72.30347    0  296   78.82319   72.30347  8.27%     -    1s
     0     0   72.30347    0  296   78.82319   72.30347  8.27%     -    1s
     0     0   72.30347    0  296   78.82319   72.30347  8.27%     -    1s
     0     0   72.30347    0  296   78.82319   72.30347  8.27%     -    1s
     0     0   72.30348    0  296   78.82319   72.30348  8.27%     -    1s
     0     0   72.30348    0  296   78.82319   72.30348  8.27%     -    1s
     0     0   72.30348    0  296   78.82319   72.30348  8.27%     -    1s
     0     0   72.30349    0  296   78.82319   72.30349  8.27%     -    1s
     0     0   72.30349    0  296   78.82319   72.30349  8.27%     -    1s
     0     0   72.30350    0  296   78.82319   72.30350  8.27%     -    1s
     0     0   72.30350    0  296   78.82319   72.30350  8.27%     -    1s
     0     0   72.30350    0  296   78.82319   72.30350  8.27%     -    1s
     0     0   72.30351    0  296   78.82319   72.30351  8.27%     -    1s
     0     0   72.30352    0  296   78.82319   72.30352  8.27%     -    1s
     0     0   72.30352    0  296   78.82319   72.30352  8.27%     -    1s
     0     0   72.30353    0  296   78.82319   72.30353  8.27%     -    1s
     0     0   72.30353    0  296   78.82319   72.30353  8.27%     -    1s
     0     0   72.30353    0  296   78.82319   72.30353  8.27%     -    1s
     0     0   72.30354    0  296   78.82319   72.30354  8.27%     -    1s
     0     0   72.30354    0  296   78.82319   72.30354  8.27%     -    1s
     0     0   72.30354    0  296   78.82319   72.30354  8.27%     -    1s
     0     0   72.30354    0  296   78.82319   72.30354  8.27%     -    1s
     0     0   72.30355    0  296   78.82319   72.30355  8.27%     -    1s
     0     0   72.30355    0  296   78.82319   72.30355  8.27%     -    1s
     0     0   72.30355    0  296   78.82319   72.30355  8.27%     -    1s
     0     0   72.30355    0  296   78.82319   72.30355  8.27%     -    1s
     0     0   72.30356    0  296   78.82319   72.30356  8.27%     -    1s
     0     0   72.30356    0  296   78.82319   72.30356  8.27%     -    1s
     0     0   72.30356    0  296   78.82319   72.30356  8.27%     -    1s
     0     0   72.30356    0  296   78.82319   72.30356  8.27%     -    1s
     0     0   72.30357    0  296   78.82319   72.30357  8.27%     -    1s
     0     0   72.30357    0  296   78.82319   72.30357  8.27%     -    1s
     0     0   72.30357    0  296   78.82319   72.30357  8.27%     -    1s
     0     0   72.30358    0  296   78.82319   72.30358  8.27%     -    1s
     0     0   72.30358    0  296   78.82319   72.30358  8.27%     -    1s
     0     0   72.30358    0  296   78.82319   72.30358  8.27%     -    1s
     0     0   72.30358    0  296   78.82319   72.30358  8.27%     -    1s
     0     0   72.30359    0  296   78.82319   72.30359  8.27%     -    1s
     0     0   72.30359    0  296   78.82319   72.30359  8.27%     -    1s
     0     0   72.30359    0  296   78.82319   72.30359  8.27%     -    1s
     0     0   72.30359    0  296   78.82319   72.30359  8.27%     -    1s
     0     0   72.30360    0  296   78.82319   72.30360  8.27%     -    1s
     0     0   72.30360    0  296   78.82319   72.30360  8.27%     -    1s
     0     0   72.30360    0  296   78.82319   72.30360  8.27%     -    1s
     0     0   72.30360    0  296   78.82319   72.30360  8.27%     -    1s
     0     0   72.30361    0  296   78.82319   72.30361  8.27%     -    1s
     0     0   72.30361    0  296   78.82319   72.30361  8.27%     -    1s
     0     0   72.30361    0  296   78.82319   72.30361  8.27%     -    1s
     0     0   72.30361    0  296   78.82319   72.30361  8.27%     -    1s
     0     0   72.30362    0  296   78.82319   72.30362  8.27%     -    1s
H    0     0                      72.3801613   72.30362  0.11%     -    3s
H    0     0                      72.3477410   72.30403  0.06%     -    4s
     0     0   72.30773    0  103   72.34774   72.30773  0.06%     -    5s
H    0     0                      72.3477410   72.30773  0.06%     -    5s
     0     0   72.31166    0  101   72.34774   72.31166  0.05%     -    5s
     0     0   72.31166    0   98   72.34774   72.31166  0.05%     -    5s
     0     0   72.31199    0  102   72.34774   72.31199  0.05%     -    5s
     0     0   72.31245    0   99   72.34774   72.31245  0.05%     -    5s
     0     0   72.31254    0   96   72.34774   72.31254  0.05%     -    6s
     0     0   72.31254    0   96   72.34774   72.31254  0.05%     -    6s
     0     0   72.31258    0   94   72.34774   72.31258  0.05%     -    6s
     0     0   72.31263    0   87   72.34774   72.31263  0.05%     -    6s
     0     0   72.31265    0   87   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   91   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   91   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   85   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   88   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   87   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   90   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   85   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   82   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   82   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   87   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   89   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   86   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   82   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   81   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   81   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   83   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   82   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   81   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   86   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   83   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   86   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   82   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   85   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   83   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   83   72.34774   72.31265  0.05%     -    6s
     0     0   72.31265    0   86   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   82   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   86   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   87   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   88   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   90   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   86   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   85   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   88   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   87   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   81   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   83   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   86   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   87   72.34774   72.31265  0.05%     -    7s
     0     0   72.31265    0   85   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   86   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   88   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   86   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   88   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   89   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   89   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   87   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   90   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   92   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   95   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   90   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   83   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   88   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   91   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   88   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   86   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   87   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   87   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   86   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   85   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   89   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   88   72.34774   72.31265  0.05%     -    8s
     0     0   72.31265    0   88   72.34774   72.31265  0.05%     -    9s
     0     0   72.31265    0   86   72.34774   72.31265  0.05%     -    9s
     0     0   72.31265    0   88   72.34774   72.31265  0.05%     -    9s
     0     0   72.31265    0   87   72.34774   72.31265  0.05%     -    9s
     0     0   72.31265    0   87   72.34774   72.31265  0.05%     -    9s
     0     0   72.31265    0   84   72.34774   72.31265  0.05%     -    9s
     0     0   72.31265    0   85   72.34774   72.31265  0.05%     -    9s
     0     0   72.31265    0   86   72.34774   72.31265  0.05%     -    9s
     0     0   72.31266    0   87   72.34774   72.31266  0.05%     -    9s
     0     0   72.31269    0   87   72.34774   72.31269  0.05%     -    9s
     0     0   72.31269    0   84   72.34774   72.31269  0.05%     -    9s
     0     0   72.31273    0   85   72.34774   72.31273  0.05%     -    9s
     0     0   72.31273    0   85   72.34774   72.31273  0.05%     -    9s
     0     0   72.31273    0   83   72.34774   72.31273  0.05%     -    9s
     0     0   72.31274    0   86   72.34774   72.31274  0.05%     -    9s
     0     0   72.31274    0   82   72.34774   72.31274  0.05%     -    9s
     0     0   72.31275    0   84   72.34774   72.31275  0.05%     -    9s
     0     0   72.31275    0   85   72.34774   72.31275  0.05%     -    9s
     0     0   72.31275    0   84   72.34774   72.31275  0.05%     -    9s
     0     0   72.31275    0   86   72.34774   72.31275  0.05%     -    9s
     0     0   72.31276    0   89   72.34774   72.31276  0.05%     -   10s
     0     0   72.31276    0   89   72.34774   72.31276  0.05%     -   10s
     0     0   72.31276    0   88   72.34774   72.31276  0.05%     -   10s
     0     0   72.31277    0   84   72.34774   72.31277  0.05%     -   10s
     0     0   72.31277    0   89   72.34774   72.31277  0.05%     -   10s
     0     0   72.31277    0   87   72.34774   72.31277  0.05%     -   10s
     0     0   72.31277    0   90   72.34774   72.31277  0.05%     -   10s
     0     0   72.31277    0   85   72.34774   72.31277  0.05%     -   10s
     0     0   72.31277    0   84   72.34774   72.31277  0.05%     -   10s
     0     0   72.31277    0   87   72.34774   72.31277  0.05%     -   10s
     0     0   72.31278    0   99   72.34774   72.31278  0.05%     -   10s
H    0     0                      72.3383010   72.31278  0.04%     -   19s
     0     0   72.31278    0   92   72.33830   72.31278  0.04%     -   20s
     0     0   72.31278    0   91   72.33830   72.31278  0.04%     -   20s
H    0     0                      72.3203041   72.31278  0.01%     -   20s
     0     0   72.31278    0   93   72.32030   72.31278  0.01%     -   20s
     0     0   72.31278    0   90   72.32030   72.31278  0.01%     -   20s
     0     0   72.31278    0   88   72.32030   72.31278  0.01%     -   21s
     0     0   72.31278    0   89   72.32030   72.31278  0.01%     -   21s
     0     0   72.31278    0   86   72.32030   72.31278  0.01%     -   21s
     0     0   72.31278    0   93   72.32030   72.31278  0.01%     -   21s
     0     0   72.31278    0   96   72.32030   72.31278  0.01%     -   21s
     0     0   72.31278    0   92   72.32030   72.31278  0.01%     -   21s
     0     0   72.31278    0   93   72.32030   72.31278  0.01%     -   21s
     0     0   72.31278    0   91   72.32030   72.31278  0.01%     -   21s
     0     0   72.31278    0   91   72.32030   72.31278  0.01%     -   21s
     0     0   72.31278    0   90   72.32030   72.31278  0.01%     -   21s
     0     0   72.31278    0   89   72.32030   72.31278  0.01%     -   21s
     0     0   72.31278    0   92   72.32030   72.31278  0.01%     -   22s
     0     0   72.31278    0   86   72.32030   72.31278  0.01%     -   22s
     0     0   72.31278    0   90   72.32030   72.31278  0.01%     -   22s
     0     0   72.31278    0   91   72.32030   72.31278  0.01%     -   22s
     0     0   72.31278    0   87   72.32030   72.31278  0.01%     -   22s
     0     0   72.31278    0   90   72.32030   72.31278  0.01%     -   22s
     0     0   72.31278    0   89   72.32030   72.31278  0.01%     -   22s
     0     0   72.31278    0   92   72.32030   72.31278  0.01%     -   22s
     0     0   72.31278    0   92   72.32030   72.31278  0.01%     -   22s
     0     0   72.31278    0   90   72.32030   72.31278  0.01%     -   22s
     0     0   72.31278    0   89   72.32030   72.31278  0.01%     -   22s
     0     0   72.31278    0   85   72.32030   72.31278  0.01%     -   22s
     0     0   72.31278    0   91   72.32030   72.31278  0.01%     -   22s
     0     0   72.31278    0   88   72.32030   72.31278  0.01%     -   23s
     0     0   72.31278    0   89   72.32030   72.31278  0.01%     -   23s
     0     0   72.31278    0   94   72.32030   72.31278  0.01%     -   23s
     0     0   72.31278    0   99   72.32030   72.31278  0.01%     -   23s
H    0     0                      72.3138057   72.31278  0.00%     -   23s
     0     0   72.31278    0   88   72.31381   72.31278  0.00%     -   23s

Cutting planes:
  Learned: 3
  Cover: 59
  Implied bound: 22
  Clique: 76
  MIR: 8
  RLT: 38
  Relax-and-lift: 7
  BQP: 10
  PSD: 9

Explored 1 nodes (136113 simplex iterations) in 23.89 seconds (25.05 work units)
Thread count was 8 (of 52 available processors)

Solution count 8: 72.3138 72.3477 72.3802 ... 117.369

Optimal solution found (tolerance 1.00e-04)
Best objective 7.231380567573e+01, best bound 7.231278466169e+01, gap 0.0014%

User-callback calls 10429, time in user-callback 0.06 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
72.31380567572674
The root upper bound is: 72.32030408465255, lower bound is: 72.31278466169445. The root gap is: 0.0104%. Runtime: 23.892898082733154.
--------------------------------------------------
    m    n  dataset formulation  ...     end_lb   end_gap  node_count        time
0   2   50  autompg    original  ...  13.477040  0.000000       987.0    0.143679
1   2   50  autompg         opt  ...  13.477040  0.000000       185.0    0.204820
2   2   50  autompg     opt_cut  ...  13.476018  0.000076         1.0    0.427783
3   2   60  autompg    original  ...  15.882434  0.000000     29340.0    1.159530
4   2   60  autompg         opt  ...  15.882434  0.000000       424.0    0.269396
5   2   60  autompg     opt_cut  ...  15.881267  0.000073         1.0    0.537511
6   2   70  autompg    original  ...  17.972364  0.000000     78473.0    3.126956
7   2   70  autompg         opt  ...  17.972364  0.000000       548.0    0.328985
8   2   70  autompg     opt_cut  ...  17.970774  0.000089        19.0    1.467074
9   2   80  autompg    original  ...  20.929447  0.000000    476643.0   15.951053
10  2   80  autompg         opt  ...  20.929447  0.000000       841.0    0.367925
11  2   80  autompg     opt_cut  ...  20.927765  0.000080         1.0    3.429426
12  2   90  autompg    original  ...  24.143764  0.000000   2228170.0   81.510934
13  2   90  autompg         opt  ...  24.143764  0.000000       918.0    0.468860
14  2   90  autompg     opt_cut  ...  24.141946  0.000075         1.0    1.659184
15  2  100  autompg    original  ...  25.330774  0.000000   3689803.0  142.390159
16  2  100  autompg         opt  ...  25.330774  0.000000      2899.0    1.223506
17  2  100  autompg     opt_cut  ...  25.328842  0.000076         1.0    0.927402
18  2  120  autompg    original  ...  28.559842  0.148020   6562358.0  300.003432
19  2  120  autompg         opt  ...  33.521731  0.000000      6372.0    1.858597
20  2  120  autompg     opt_cut  ...  33.520458  0.000038         1.0    0.787283
21  2  150  autompg    original  ...  33.869957  0.297969   5989982.0  300.006846
22  2  150  autompg         opt  ...  48.245685  0.000000      3739.0    2.486141
23  2  150  autompg     opt_cut  ...  48.242579  0.000064         1.0    0.988786
24  2  200  autompg    original  ...  40.793079  0.435888   4440447.0  300.007618
25  2  200  autompg         opt  ...  72.313781  0.000000      3168.0    3.767727
26  2  200  autompg     opt_cut  ...  72.312785  0.000014         1.0   23.892898

[27 rows x 12 columns]
[2, 50, 'diabetes']
[0.00547998 0.01342817 1.         1.         1.        ]
The relaxed obj is 0.03995124527907379.
The larges value of x is 2.6827064505854428
Use new Big-M 5.3654129011708855.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 100 rows, 102 columns and 200 nonzeros
Model fingerprint: 0x4c6040b9
Model has 153 quadratic objective terms
Variable types: 52 continuous, 50 integer (50 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [3e-03, 5e+00]
  QObjective range [8e-02, 5e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 25.0000000
Presolve time: 0.00s
Presolved: 100 rows, 102 columns, 200 nonzeros
Presolved model has 153 quadratic objective terms
Variable types: 52 continuous, 50 integer (50 binary)

Root relaxation: objective 6.634353e+00, 168 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    6.63435    0   40   25.00000    6.63435  73.5%     -    0s
H    0     0                      22.2651567    6.63435  70.2%     -    0s
H    0     0                      18.6871761    6.63435  64.5%     -    0s
H    0     0                      18.6590538    6.63435  64.4%     -    0s
     0     0    7.16184    0   40   18.65905    7.16184  61.6%     -    0s
H    0     0                      18.5257373    7.16184  61.3%     -    0s
     0     2    7.16184    0   40   18.52574    7.16184  61.3%     -    0s

Explored 175326 nodes (696853 simplex iterations) in 3.87 seconds (3.38 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 18.5257 18.6591 22.2652 25 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.852573731846e+01, best bound 1.852573731846e+01, gap 0.0000%

User-callback calls 351498, time in user-callback 0.40 sec
--------------------------------
solve the problem in original formulation
The obj is 18.525737318456294.
The root upper bound is: 18.525737318456294, lower bound is: 7.1618394432714805. The root gap is: 61.3411%. Runtime: 3.872641086578369.
[ 9 21 29 32 36 37 44]
Number of outliers: 7
--------------------------------
The decomposition time is 0.03432022035121918.
Optimal value: 49.999999974913216
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.032274000346660614.
Optimal value: 49.999999974913216
6.634354265149703
18.52469974299388
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 350 rows, 202 columns and 950 nonzeros
Model fingerprint: 0xa0f21592
Model has 153 quadratic objective terms
Variable types: 52 continuous, 150 integer (150 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+03]
  Objective range  [3e-03, 5e+00]
  QObjective range [8e-02, 5e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-02, 1e+03]
Found heuristic solution: objective 30.8293363
Presolve time: 0.00s
Presolved: 350 rows, 202 columns, 950 nonzeros
Presolved model has 153 quadratic objective terms
Variable types: 52 continuous, 150 integer (150 binary)
Found heuristic solution: objective 29.6728333

Root relaxation: objective 6.634353e+00, 617 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    6.63435    0   80   29.67283    6.63435  77.6%     -    0s
H    0     0                      18.5257373    6.63435  64.2%     -    0s
     0     0    6.63435    0   84   18.52574    6.63435  64.2%     -    0s
     0     2    8.41702    0   84   18.52574    8.41702  54.6%     -    0s

Cutting planes:
  Learned: 32
  Cover: 9
  Clique: 4
  Inf proof: 8

Explored 3953 nodes (41238 simplex iterations) in 0.45 seconds (0.42 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 18.5257 29.6728 30.8293 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.852573731846e+01, best bound 1.852573731846e+01, gap 0.0000%

User-callback calls 8231, time in user-callback 0.01 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 18.525737318456294.
The root upper bound is: 18.525737318456294, lower bound is: 8.417017529346573. The root gap is: 54.5658%. Runtime: 0.4516260623931885.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 351 rows, 203 columns and 1053 nonzeros
Model fingerprint: 0x4d6eef33
Model has 153 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 53 continuous, 150 integer (150 binary)
Coefficient statistics:
  Matrix range     [3e-03, 1e+03]
  QMatrix range    [4e-02, 3e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [3e-03, 5e+00]
  QObjective range [3e-10, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-02, 1e+03]
Presolve time: 0.00s
Presolved: 351 rows, 203 columns, 1053 nonzeros
Presolved model has 153 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 53 continuous, 150 integer (150 binary)

Root relaxation: objective 1.852433e+01, 325 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   18.52433    0   28          -   18.52433      -     -    0s
H    0     0                      24.9588297   18.52433  25.8%     -    0s
     0     0   18.52439    0   30   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   30   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   40   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   51   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   54   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   54   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   54   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   54   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   54   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   56   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   60   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   60   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   60   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   60   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   60   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   62   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   66   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
     0     0   18.52439    0   68   24.95883   18.52439  25.8%     -    0s
H    0     0                      19.2153023   18.52439  3.60%     -    0s
     0     0   18.52439    0   68   19.21530   18.52439  3.60%     -    0s
     0     0   18.52439    0   68   19.21530   18.52439  3.60%     -    0s
     0     0   18.52439    0   68   19.21530   18.52439  3.60%     -    0s
     0     0   18.52439    0   68   19.21530   18.52439  3.60%     -    0s
     0     0   18.52439    0   68   19.21530   18.52439  3.60%     -    0s
H    0     0                      19.1688411   18.52497  3.36%     -    0s
     0     2   18.52497    0   68   19.16884   18.52497  3.36%     -    0s
H   32    30                      19.1688411   18.52497  3.36%  96.5    1s
H   33    30                      18.7574480   18.52497  1.24%  95.1    1s
H   72    63                      18.7112807   18.52497  1.00%  55.7    1s
H  430   181                      18.5582660   18.52497  0.18%  35.5    1s
*  430   181              41      18.5582660   18.52497  0.18%  35.5    1s
H  627   106                      18.5454133   18.52517  0.11%  28.0    1s
*  627   106              42      18.5454133   18.52517  0.11%  28.0    1s
H  954     0                      18.5257384   18.52526  0.00%  20.7    1s
*  954     0              41      18.5257384   18.52526  0.00%  20.7    1s

Cutting planes:
  Learned: 50
  Implied bound: 1
  Clique: 2
  MIR: 5
  Relax-and-lift: 1

Explored 1018 nodes (24014 simplex iterations) in 1.57 seconds (1.71 work units)
Thread count was 8 (of 52 available processors)

Solution count 8: 18.5257 18.5454 18.5583 ... 24.9588

Optimal solution found (tolerance 1.00e-04)
Best objective 1.852573838828e+01, best bound 1.852525801847e+01, gap 0.0026%

User-callback calls 3532, time in user-callback 0.01 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
18.52573838827732
The root upper bound is: 19.168841062724052, lower bound is: 18.524972158730645. The root gap is: 3.3589%. Runtime: 1.5692999362945557.
--------------------------------------------------
    m    n   dataset formulation  ...     end_lb   end_gap  node_count        time
0   2   50   autompg    original  ...  13.477040  0.000000       987.0    0.143679
1   2   50   autompg         opt  ...  13.477040  0.000000       185.0    0.204820
2   2   50   autompg     opt_cut  ...  13.476018  0.000076         1.0    0.427783
3   2   60   autompg    original  ...  15.882434  0.000000     29340.0    1.159530
4   2   60   autompg         opt  ...  15.882434  0.000000       424.0    0.269396
5   2   60   autompg     opt_cut  ...  15.881267  0.000073         1.0    0.537511
6   2   70   autompg    original  ...  17.972364  0.000000     78473.0    3.126956
7   2   70   autompg         opt  ...  17.972364  0.000000       548.0    0.328985
8   2   70   autompg     opt_cut  ...  17.970774  0.000089        19.0    1.467074
9   2   80   autompg    original  ...  20.929447  0.000000    476643.0   15.951053
10  2   80   autompg         opt  ...  20.929447  0.000000       841.0    0.367925
11  2   80   autompg     opt_cut  ...  20.927765  0.000080         1.0    3.429426
12  2   90   autompg    original  ...  24.143764  0.000000   2228170.0   81.510934
13  2   90   autompg         opt  ...  24.143764  0.000000       918.0    0.468860
14  2   90   autompg     opt_cut  ...  24.141946  0.000075         1.0    1.659184
15  2  100   autompg    original  ...  25.330774  0.000000   3689803.0  142.390159
16  2  100   autompg         opt  ...  25.330774  0.000000      2899.0    1.223506
17  2  100   autompg     opt_cut  ...  25.328842  0.000076         1.0    0.927402
18  2  120   autompg    original  ...  28.559842  0.148020   6562358.0  300.003432
19  2  120   autompg         opt  ...  33.521731  0.000000      6372.0    1.858597
20  2  120   autompg     opt_cut  ...  33.520458  0.000038         1.0    0.787283
21  2  150   autompg    original  ...  33.869957  0.297969   5989982.0  300.006846
22  2  150   autompg         opt  ...  48.245685  0.000000      3739.0    2.486141
23  2  150   autompg     opt_cut  ...  48.242579  0.000064         1.0    0.988786
24  2  200   autompg    original  ...  40.793079  0.435888   4440447.0  300.007618
25  2  200   autompg         opt  ...  72.313781  0.000000      3168.0    3.767727
26  2  200   autompg     opt_cut  ...  72.312785  0.000014         1.0   23.892898
27  2   50  diabetes    original  ...  18.525737  0.000000    175326.0    3.872641
28  2   50  diabetes         opt  ...  18.525737  0.000000      3953.0    0.451626
29  2   50  diabetes     opt_cut  ...  18.525258  0.000026      1018.0    1.569300

[30 rows x 12 columns]
[2, 60, 'diabetes']
[0.00454755 0.01148618 1.         1.         1.        ]
The relaxed obj is 0.04788400555696626.
The larges value of x is 2.764923000908056
Use new Big-M 5.529846001816112.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 120 rows, 122 columns and 240 nonzeros
Model fingerprint: 0xe7e47d32
Model has 183 quadratic objective terms
Variable types: 62 continuous, 60 integer (60 binary)
Coefficient statistics:
  Matrix range     [1e+00, 6e+00]
  Objective range  [2e-02, 1e+01]
  QObjective range [2e-02, 6e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 30.0000000
Presolve time: 0.00s
Presolved: 120 rows, 122 columns, 240 nonzeros
Presolved model has 183 quadratic objective terms
Variable types: 62 continuous, 60 integer (60 binary)

Root relaxation: objective 7.685383e+00, 204 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    7.68538    0   50   30.00000    7.68538  74.4%     -    0s
H    0     0                      24.1773679    7.68538  68.2%     -    0s
H    0     0                      24.1720292    7.68538  68.2%     -    0s
H    0     0                      22.2191364    7.68538  65.4%     -    0s
H    0     0                      22.1871790    7.68538  65.4%     -    0s
     0     0    8.62396    0   50   22.18718    8.62396  61.1%     -    0s
H    0     0                      22.0682082    8.62396  60.9%     -    0s
     0     2    8.62396    0   50   22.06821    8.62396  60.9%     -    0s
 204444 107366   21.24694   26   39   22.06821   18.86236  14.5%   4.2    5s
 423900 187155   20.63336   29   34   22.06821   19.62927  11.1%   4.1   10s
 644603 242860     cutoff   32        22.06821   20.06891  9.06%   4.0   15s
 864416 277185   21.38186   32   30   22.06821   20.38455  7.63%   4.0   20s
 1087261 292129   21.61962   32   30   22.06821   20.64670  6.44%   4.0   25s
 1304263 287485   21.71105   26   33   22.06821   20.87762  5.40%   4.0   30s
 1527826 261164   21.93981   33   26   22.06821   21.10917  4.35%   4.0   35s
 1738071 213267   21.33052   32   29   22.06821   21.32980  3.35%   3.9   40s
 1946538 144206   21.85917   31   30   22.06821   21.57812  2.22%   3.9   45s
 2147268 44318   21.89736   34   28   22.06821   21.89707  0.78%   3.9   50s

Explored 2200400 nodes (8446497 simplex iterations) in 51.41 seconds (51.65 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 22.0682 24.172 24.1774 30 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.206820819320e+01, best bound 2.206812422294e+01, gap 0.0004%

User-callback calls 4406137, time in user-callback 5.40 sec
--------------------------------
solve the problem in original formulation
The obj is 22.068208193203677.
The root upper bound is: 22.068208193203677, lower bound is: 8.623957192760992. The root gap is: 60.9214%. Runtime: 51.41216993331909.
[ 9 29 32 36 37 38 44]
Number of outliers: 7
--------------------------------
The decomposition time is 0.045274268835783005.
Optimal value: 59.99999951075276
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.04164934158325195.
Optimal value: 59.99999951075276
7.685393782280737
22.067687340024555
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 420 rows, 242 columns and 1140 nonzeros
Model fingerprint: 0xfb9a8d50
Model has 183 quadratic objective terms
Variable types: 62 continuous, 180 integer (180 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+03]
  Objective range  [2e-02, 1e+01]
  QObjective range [2e-02, 6e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-02, 1e+03]
Found heuristic solution: objective 34.9144779
Presolve time: 0.00s
Presolved: 420 rows, 242 columns, 1140 nonzeros
Presolved model has 183 quadratic objective terms
Variable types: 62 continuous, 180 integer (180 binary)

Root relaxation: objective 7.685383e+00, 748 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    7.68538    0  100   34.91448    7.68538  78.0%     -    0s
H    0     0                      22.2429358    7.68538  65.4%     -    0s
H    0     0                      22.0682082    7.68538  65.2%     -    0s
     0     0    8.19440    0  104   22.06821    8.19440  62.9%     -    0s
     0     2    9.07515    0  104   22.06821    9.07515  58.9%     -    0s

Cutting planes:
  Learned: 39
  Cover: 9
  Implied bound: 1
  Clique: 11
  Inf proof: 7

Explored 3261 nodes (50167 simplex iterations) in 0.52 seconds (0.52 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 22.0682 22.2429 34.9145 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.206820819320e+01, best bound 2.206820819320e+01, gap 0.0000%

User-callback calls 6875, time in user-callback 0.01 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 22.068208193203677.
The root upper bound is: 22.068208193203677, lower bound is: 9.075153840100137. The root gap is: 58.8768%. Runtime: 0.5245909690856934.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 421 rows, 243 columns and 1263 nonzeros
Model fingerprint: 0x9684c047
Model has 183 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 63 continuous, 180 integer (180 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+03]
  QMatrix range    [1e-02, 3e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [2e-02, 1e+01]
  QObjective range [6e-09, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-02, 1e+03]
Presolve time: 0.00s
Presolved: 421 rows, 243 columns, 1263 nonzeros
Presolved model has 183 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 63 continuous, 180 integer (180 binary)

Root relaxation: objective 2.206707e+01, 410 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   22.06707    0   26          -   22.06707      -     -    0s
H    0     0                      42.6326838   22.06707  48.2%     -    0s
H    0     0                      31.2514856   22.06707  29.4%     -    0s
     0     0   22.06715    0   30   31.25149   22.06715  29.4%     -    0s
H    0     0                      31.1199142   22.06715  29.1%     -    0s
     0     0   22.06724    0   28   31.11991   22.06724  29.1%     -    0s
     0     0   22.06724    0   28   31.11991   22.06724  29.1%     -    0s
     0     0   22.06725    0   28   31.11991   22.06725  29.1%     -    0s
     0     0   22.06725    0   28   31.11991   22.06725  29.1%     -    0s
     0     0   22.06725    0   28   31.11991   22.06725  29.1%     -    0s
     0     0   22.06726    0   30   31.11991   22.06726  29.1%     -    0s
     0     0   22.06731    0   30   31.11991   22.06731  29.1%     -    0s
     0     0   22.06733    0   30   31.11991   22.06733  29.1%     -    0s
     0     0   22.06733    0   30   31.11991   22.06733  29.1%     -    0s
     0     0   22.06733    0   28   31.11991   22.06733  29.1%     -    0s
     0     0   22.06735    0   30   31.11991   22.06735  29.1%     -    0s
     0     0   22.06739    0   30   31.11991   22.06739  29.1%     -    0s
     0     0   22.06742    0   30   31.11991   22.06742  29.1%     -    0s
     0     0   22.06746    0   30   31.11991   22.06746  29.1%     -    0s
     0     0   22.06746    0   30   31.11991   22.06746  29.1%     -    0s
     0     0   22.06746    0   30   31.11991   22.06746  29.1%     -    0s
     0     0   22.06746    0   30   31.11991   22.06746  29.1%     -    0s
     0     0   22.06746    0   36   31.11991   22.06746  29.1%     -    0s
     0     0   22.06746    0   34   31.11991   22.06746  29.1%     -    0s
     0     0   22.06746    0   34   31.11991   22.06746  29.1%     -    0s
     0     0   22.06746    0   34   31.11991   22.06746  29.1%     -    0s
     0     0   22.06746    0   34   31.11991   22.06746  29.1%     -    0s
     0     0   22.06746    0   34   31.11991   22.06746  29.1%     -    0s
     0     0   22.06746    0   34   31.11991   22.06746  29.1%     -    0s
     0     0   22.06748    0   34   31.11991   22.06748  29.1%     -    0s
     0     0   22.06749    0   34   31.11991   22.06749  29.1%     -    0s
     0     0   22.06750    0   34   31.11991   22.06750  29.1%     -    0s
     0     0   22.06752    0   34   31.11991   22.06752  29.1%     -    0s
     0     0   22.06752    0   34   31.11991   22.06752  29.1%     -    0s
     0     0   22.06753    0   34   31.11991   22.06753  29.1%     -    0s
     0     0   22.06753    0   34   31.11991   22.06753  29.1%     -    0s
     0     0   22.06753    0   34   31.11991   22.06753  29.1%     -    0s
     0     0   22.06753    0   34   31.11991   22.06753  29.1%     -    0s
     0     0   22.06754    0   32   31.11991   22.06754  29.1%     -    0s
     0     0   22.06754    0   32   31.11991   22.06754  29.1%     -    0s
     0     0   22.06755    0   32   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   34   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   32   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   33   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   32   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   32   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   32   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   32   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   32   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   40   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   38   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   38   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   39   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   40   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   40   31.11991   22.06755  29.1%     -    0s
     0     0   22.06755    0   40   31.11991   22.06755  29.1%     -    0s
     0     0   22.06756    0   40   31.11991   22.06756  29.1%     -    0s
     0     0   22.06757    0   40   31.11991   22.06757  29.1%     -    0s
     0     0   22.06757    0   40   31.11991   22.06757  29.1%     -    0s
     0     0   22.06758    0   40   31.11991   22.06758  29.1%     -    0s
     0     0   22.06758    0   40   31.11991   22.06758  29.1%     -    0s
     0     0   22.06759    0   41   31.11991   22.06759  29.1%     -    0s
     0     0   22.06759    0   41   31.11991   22.06759  29.1%     -    0s
     0     0   22.06759    0   41   31.11991   22.06759  29.1%     -    0s
     0     0   22.06759    0   42   31.11991   22.06759  29.1%     -    0s
     0     0   22.06759    0   40   31.11991   22.06759  29.1%     -    0s
     0     0   22.06759    0   40   31.11991   22.06759  29.1%     -    0s
     0     0   22.06759    0   40   31.11991   22.06759  29.1%     -    0s
     0     0   22.06759    0   40   31.11991   22.06759  29.1%     -    0s
     0     0   22.06759    0   40   31.11991   22.06759  29.1%     -    0s
     0     0   22.06759    0   40   31.11991   22.06759  29.1%     -    0s
     0     0   22.06759    0   40   31.11991   22.06759  29.1%     -    0s
     0     0   22.06759    0   42   31.11991   22.06759  29.1%     -    0s
     0     0   22.06759    0   46   31.11991   22.06759  29.1%     -    0s
     0     0   22.06759    0   46   31.11991   22.06759  29.1%     -    0s
     0     0   22.06760    0   46   31.11991   22.06760  29.1%     -    0s
     0     0   22.06761    0   46   31.11991   22.06761  29.1%     -    0s
     0     0   22.06761    0   46   31.11991   22.06761  29.1%     -    0s
     0     0   22.06762    0   46   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   46   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   46   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   46   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   46   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   46   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   46   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   44   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   48   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   46   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   46   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   46   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   48   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   48   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   46   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   42   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   46   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   44   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   40   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   44   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   44   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   44   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   40   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   44   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   44   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   46   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   44   31.11991   22.06762  29.1%     -    0s
     0     0   22.06762    0   44   31.11991   22.06762  29.1%     -    0s
H    0     0                      25.1164484   22.06762  12.1%     -    0s
H    0     0                      22.0682083   22.06762  0.00%     -    1s

Cutting planes:
  Learned: 13
  Clique: 1
  MIR: 2

Explored 1 nodes (3334 simplex iterations) in 1.40 seconds (0.84 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 22.0682 25.1164 31.1199 ... 42.6327

Optimal solution found (tolerance 1.00e-04)
Best objective 2.206820830739e+01, best bound 2.206765364960e+01, gap 0.0025%

User-callback calls 1673, time in user-callback 0.01 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
22.06820830738721
The root upper bound is: 31.11991422160408, lower bound is: 22.067623015463248. The root gap is: 29.0884%. Runtime: 1.3997600078582764.
--------------------------------------------------
    m    n   dataset formulation  ...     end_lb   end_gap  node_count        time
0   2   50   autompg    original  ...  13.477040  0.000000       987.0    0.143679
1   2   50   autompg         opt  ...  13.477040  0.000000       185.0    0.204820
2   2   50   autompg     opt_cut  ...  13.476018  0.000076         1.0    0.427783
3   2   60   autompg    original  ...  15.882434  0.000000     29340.0    1.159530
4   2   60   autompg         opt  ...  15.882434  0.000000       424.0    0.269396
5   2   60   autompg     opt_cut  ...  15.881267  0.000073         1.0    0.537511
6   2   70   autompg    original  ...  17.972364  0.000000     78473.0    3.126956
7   2   70   autompg         opt  ...  17.972364  0.000000       548.0    0.328985
8   2   70   autompg     opt_cut  ...  17.970774  0.000089        19.0    1.467074
9   2   80   autompg    original  ...  20.929447  0.000000    476643.0   15.951053
10  2   80   autompg         opt  ...  20.929447  0.000000       841.0    0.367925
11  2   80   autompg     opt_cut  ...  20.927765  0.000080         1.0    3.429426
12  2   90   autompg    original  ...  24.143764  0.000000   2228170.0   81.510934
13  2   90   autompg         opt  ...  24.143764  0.000000       918.0    0.468860
14  2   90   autompg     opt_cut  ...  24.141946  0.000075         1.0    1.659184
15  2  100   autompg    original  ...  25.330774  0.000000   3689803.0  142.390159
16  2  100   autompg         opt  ...  25.330774  0.000000      2899.0    1.223506
17  2  100   autompg     opt_cut  ...  25.328842  0.000076         1.0    0.927402
18  2  120   autompg    original  ...  28.559842  0.148020   6562358.0  300.003432
19  2  120   autompg         opt  ...  33.521731  0.000000      6372.0    1.858597
20  2  120   autompg     opt_cut  ...  33.520458  0.000038         1.0    0.787283
21  2  150   autompg    original  ...  33.869957  0.297969   5989982.0  300.006846
22  2  150   autompg         opt  ...  48.245685  0.000000      3739.0    2.486141
23  2  150   autompg     opt_cut  ...  48.242579  0.000064         1.0    0.988786
24  2  200   autompg    original  ...  40.793079  0.435888   4440447.0  300.007618
25  2  200   autompg         opt  ...  72.313781  0.000000      3168.0    3.767727
26  2  200   autompg     opt_cut  ...  72.312785  0.000014         1.0   23.892898
27  2   50  diabetes    original  ...  18.525737  0.000000    175326.0    3.872641
28  2   50  diabetes         opt  ...  18.525737  0.000000      3953.0    0.451626
29  2   50  diabetes     opt_cut  ...  18.525258  0.000026      1018.0    1.569300
30  2   60  diabetes    original  ...  22.068124  0.000004   2200400.0   51.412170
31  2   60  diabetes         opt  ...  22.068208  0.000000      3261.0    0.524591
32  2   60  diabetes     opt_cut  ...  22.067654  0.000025         1.0    1.399760

[33 rows x 12 columns]
[2, 70, 'diabetes']
[0.00394696 0.00965191 1.         1.         1.        ]
The relaxed obj is 0.055246175211152604.
The larges value of x is 2.9166667002001514
Use new Big-M 5.833333400400303.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 140 rows, 142 columns and 280 nonzeros
Model fingerprint: 0xc573a2aa
Model has 213 quadratic objective terms
Variable types: 72 continuous, 70 integer (70 binary)
Coefficient statistics:
  Matrix range     [1e+00, 6e+00]
  Objective range  [1e-03, 1e+01]
  QObjective range [6e-03, 7e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 35.0000000
Presolve time: 0.00s
Presolved: 140 rows, 142 columns, 280 nonzeros
Presolved model has 213 quadratic objective terms
Variable types: 72 continuous, 70 integer (70 binary)

Root relaxation: objective 8.435504e+00, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    8.43550    0   58   35.00000    8.43550  75.9%     -    0s
H    0     0                      28.4462462    8.43550  70.3%     -    0s
H    0     0                      25.4484621    8.43550  66.9%     -    0s
H    0     0                      25.3476690    8.43550  66.7%     -    0s
     0     0    9.12281    0   58   25.34767    9.12281  64.0%     -    0s
H    0     0                      25.1585078    9.12281  63.7%     -    0s
H    0     0                      25.1487802    9.12281  63.7%     -    0s
     0     2    9.12281    0   58   25.14878    9.12281  63.7%     -    0s
H   33    40                      25.1486235   11.01429  56.2%  11.5    0s
H   35    40                      25.1484129   11.01429  56.2%  11.7    0s
H   85    96                      25.1472680   12.14341  51.7%  10.9    0s
 149660 97825   23.06664   33   34   25.14727   19.67104  21.8%   5.2    5s
 342455 209450   21.20348   28   44   25.14727   20.55533  18.3%   5.0   10s
 528648 309303   24.95953   33   35   25.14727   21.01785  16.4%   4.9   15s
 720524 404962   22.72080   28   44   25.14727   21.34630  15.1%   4.9   20s
 906823 492126   23.09823   32   34   25.14727   21.58578  14.2%   4.9   25s
 1098207 575823   24.35769   34   32   25.14727   21.78536  13.4%   4.8   30s
 1282299 651741     cutoff   34        25.14727   21.94456  12.7%   4.8   35s
 1475864 728909   24.91768   39   27   25.14727   22.08968  12.2%   4.8   40s
 1668109 801739   24.56735   35   31   25.14727   22.21731  11.7%   4.8   45s
 1875196 874712   24.78798   33   36   25.14727   22.34110  11.2%   4.7   50s
 2058749 934708   23.83709   35   38   25.14727   22.43717  10.8%   4.7   55s
 2249238 994935   23.61531   35   31   25.14727   22.53124  10.4%   4.7   60s
 2446531 1054086   24.78865   35   36   25.14727   22.62163  10.0%   4.7   65s
 2641939 1108396   24.52522   32   36   25.14727   22.70112  9.73%   4.7   70s
 2826759 1157377   24.80376   35   32   25.14727   22.77381  9.44%   4.7   75s
 3001081 1200783   24.62134   36   30   25.14727   22.83880  9.18%   4.7   80s
 3186342 1244344   24.26195   31   36   25.14727   22.90333  8.92%   4.6   85s
 3375525 1287532   24.11041   27   40   25.14727   22.96643  8.67%   4.6   90s
 3560023 1326694   24.81208   35   31   25.14727   23.02444  8.44%   4.6   95s
 3750320 1364115   24.44215   35   37   25.14727   23.08105  8.22%   4.6  100s
 3938519 1397926   24.05697   34   32   25.14727   23.13531  8.00%   4.6  105s
 4124128 1428724   24.44182   34   37   25.14727   23.18673  7.80%   4.6  110s
 4308474 1456723   24.31359   35   30   25.14727   23.23615  7.60%   4.6  115s
 4491471 1482815     cutoff   36        25.14727   23.28289  7.41%   4.6  120s
 4687534 1507541   24.92288   31   34   25.14727   23.33080  7.22%   4.6  125s
 4874757 1529505     cutoff   36        25.14727   23.37485  7.05%   4.6  130s
 5058898 1548046   23.76270   31   38   25.14727   23.41740  6.88%   4.5  135s
 5239565 1564217   24.48843   32   34   25.14727   23.45763  6.72%   4.5  140s
 5425135 1578108   24.39394   34   36   25.14727   23.49810  6.56%   4.5  145s
 5611212 1589549   24.51647   35   33   25.14727   23.53752  6.40%   4.5  150s
 5798023 1598832     cutoff   37        25.14727   23.57659  6.25%   4.5  155s
 5980114 1606092   23.99602   31   38   25.14727   23.61359  6.10%   4.5  160s
 6168000 1611025   24.94537   37   29   25.14727   23.65111  5.95%   4.5  165s
 6360447 1613413   23.68924   33   33   25.14727   23.68896  5.80%   4.5  170s
 6546173 1613811   24.22053   30   36   25.14727   23.72523  5.65%   4.5  175s
 6731986 1611871   24.91320   35   36   25.14727   23.76114  5.51%   4.5  180s
 6912573 1607695   25.05098   31   39   25.14727   23.79542  5.38%   4.5  185s
 7096898 1600949   23.83034   30   41   25.14727   23.83007  5.24%   4.5  190s
 7283878 1591739   24.53789   35   30   25.14727   23.86504  5.10%   4.5  195s
 7471845 1580538   24.70298   35   30   25.14727   23.89993  4.96%   4.4  200s
 7650206 1567499   25.04576   33   38   25.14727   23.93284  4.83%   4.4  205s
 7821285 1552741   24.36449   36   29   25.14727   23.96409  4.70%   4.4  210s
 8001095 1534591   25.11983   29   36   25.14727   23.99727  4.57%   4.4  215s
 8194195 1511950   24.97583   35   33   25.14727   24.03304  4.43%   4.4  220s
 8389371 1485698   24.38004   31   36   25.14727   24.06920  4.29%   4.4  225s
 8595438 1454746   24.37050   34   33   25.14727   24.10715  4.14%   4.4  230s
 8786160 1423788   25.00923   37   30   25.14727   24.14195  4.00%   4.4  235s
 8981449 1389542   24.47128   36   33   25.14727   24.17716  3.86%   4.4  240s
 9175795 1352895     cutoff   36        25.14727   24.21180  3.72%   4.4  245s
 9354531 1316623   25.11700   36   31   25.14727   24.24414  3.59%   4.4  250s
 9546204 1275360   24.63050   29   38   25.14727   24.27854  3.45%   4.4  255s
 9739581 1228121   24.62150   35   30   25.14727   24.31492  3.31%   4.4  260s
 9942428 1172679   24.62700   32   39   25.14727   24.35621  3.15%   4.3  265s
 10138496 1115950   24.63422   35   30   25.14727   24.39611  2.99%   4.3  270s
 10328409 1059105   24.43569   33   33   25.14727   24.43564  2.83%   4.3  275s
 10523345 998427   24.99959   34   34   25.14727   24.47678  2.67%   4.3  280s
 10717334 935446   24.51824   31   38   25.14727   24.51816  2.50%   4.3  285s
 10906675 871252   24.79735   38   29   25.14727   24.55941  2.34%   4.3  290s
 11095200 804110   24.60171   29   42   25.14727   24.60168  2.17%   4.3  295s
 11279107 735273   24.89636   33   36   25.14727   24.64446  2.00%   4.3  300s

Explored 11280078 nodes (48358163 simplex iterations) in 300.01 seconds (338.36 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 25.1473 25.1585 25.3477 ... 35

Time limit reached
Best objective 2.514726803770e+01, best bound 2.464467954252e+01, gap 1.9986%

User-callback calls 22587086, time in user-callback 27.19 sec
--------------------------------
solve the problem in original formulation
The obj is 25.147268037704414.
The root upper bound is: 25.148780192118757, lower bound is: 9.122813366894956. The root gap is: 63.7246%. Runtime: 300.0065529346466.
[ 9 23 29 32 36 37 38 44 57]
Number of outliers: 9
--------------------------------
The decomposition time is 0.05350680463016033.
Optimal value: 69.99999989488389
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.05072248354554176.
Optimal value: 69.99999989488389
8.435505330058781
25.140220171220022
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 490 rows, 282 columns and 1330 nonzeros
Model fingerprint: 0x733163ef
Model has 213 quadratic objective terms
Variable types: 72 continuous, 210 integer (210 binary)
Coefficient statistics:
  Matrix range     [3e-03, 1e+03]
  Objective range  [1e-03, 1e+01]
  QObjective range [6e-03, 7e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-02, 1e+03]
Found heuristic solution: objective 42.5488320
Presolve time: 0.00s
Presolved: 490 rows, 282 columns, 1330 nonzeros
Presolved model has 213 quadratic objective terms
Variable types: 72 continuous, 210 integer (210 binary)
Found heuristic solution: objective 41.1525405

Root relaxation: objective 8.435504e+00, 912 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    8.43550    0  116   41.15254    8.43550  79.5%     -    0s
H    0     0                      25.2534070    8.43550  66.6%     -    0s
     0     0    9.36021    0  120   25.25341    9.36021  62.9%     -    0s
H    0     0                      25.1585078    9.36021  62.8%     -    0s
H    0     0                      25.1472680   10.10900  59.8%     -    0s
     0     2   10.10900    0  120   25.14727   10.10900  59.8%     -    0s

Cutting planes:
  Learned: 55
  Cover: 24
  Clique: 17
  Inf proof: 12

Explored 3459 nodes (63498 simplex iterations) in 0.88 seconds (0.74 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 25.1473 25.1585 25.2534 42.5488 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.514726803770e+01, best bound 2.514726803770e+01, gap 0.0000%

User-callback calls 7380, time in user-callback 0.01 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 25.14726803770441.
The root upper bound is: 25.14726803770441, lower bound is: 10.109002126606116. The root gap is: 59.8008%. Runtime: 0.8841822147369385.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 491 rows, 283 columns and 1473 nonzeros
Model fingerprint: 0xf09bece1
Model has 213 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 73 continuous, 210 integer (210 binary)
Coefficient statistics:
  Matrix range     [1e-03, 1e+03]
  QMatrix range    [3e-03, 4e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [1e-03, 1e+01]
  QObjective range [1e-09, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-02, 1e+03]
Presolve time: 0.00s
Presolved: 491 rows, 283 columns, 1473 nonzeros
Presolved model has 213 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 73 continuous, 210 integer (210 binary)

Root relaxation: objective 2.512248e+01, 717 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   25.12248    0  112          -   25.12248      -     -    0s
H    0     0                      51.4485280   25.12248  51.2%     -    0s
H    0     0                      33.5555636   25.12248  25.1%     -    0s
     0     0   25.12665    0  114   33.55556   25.12665  25.1%     -    0s
     0     0   25.12665    0  114   33.55556   25.12665  25.1%     -    0s
     0     0   25.12714    0  108   33.55556   25.12714  25.1%     -    0s
     0     0   25.12716    0  110   33.55556   25.12716  25.1%     -    0s
     0     0   25.12743    0  113   33.55556   25.12743  25.1%     -    0s
     0     0   25.12752    0  113   33.55556   25.12752  25.1%     -    0s
     0     0   25.12759    0  113   33.55556   25.12759  25.1%     -    0s
     0     0   25.12763    0  113   33.55556   25.12763  25.1%     -    0s
     0     0   25.12768    0  113   33.55556   25.12768  25.1%     -    0s
     0     0   25.12772    0  113   33.55556   25.12772  25.1%     -    0s
     0     0   25.12776    0  113   33.55556   25.12776  25.1%     -    0s
     0     0   25.12779    0  113   33.55556   25.12779  25.1%     -    0s
     0     0   25.12781    0  113   33.55556   25.12781  25.1%     -    0s
     0     0   25.12781    0  113   33.55556   25.12781  25.1%     -    0s
     0     0   25.12782    0  113   33.55556   25.12782  25.1%     -    0s
     0     0   25.12783    0  113   33.55556   25.12783  25.1%     -    0s
     0     0   25.12786    0  113   33.55556   25.12786  25.1%     -    0s
     0     0   25.12792    0  113   33.55556   25.12792  25.1%     -    0s
     0     0   25.12794    0  113   33.55556   25.12794  25.1%     -    0s
     0     0   25.12802    0  113   33.55556   25.12802  25.1%     -    0s
     0     0   25.12808    0  113   33.55556   25.12808  25.1%     -    0s
     0     0   25.12822    0  114   33.55556   25.12822  25.1%     -    0s
     0     0   25.12824    0  113   33.55556   25.12824  25.1%     -    0s
     0     0   25.12827    0  113   33.55556   25.12827  25.1%     -    0s
     0     0   25.12832    0  113   33.55556   25.12832  25.1%     -    0s
     0     0   25.12837    0  113   33.55556   25.12837  25.1%     -    0s
     0     0   25.12839    0  113   33.55556   25.12839  25.1%     -    0s
     0     0   25.12842    0  113   33.55556   25.12842  25.1%     -    0s
     0     0   25.12846    0  111   33.55556   25.12846  25.1%     -    0s
     0     0   25.12851    0  115   33.55556   25.12851  25.1%     -    0s
     0     0   25.12853    0  115   33.55556   25.12853  25.1%     -    0s
     0     0   25.12858    0  115   33.55556   25.12858  25.1%     -    0s
     0     0   25.12864    0  115   33.55556   25.12864  25.1%     -    0s
     0     0   25.12874    0  115   33.55556   25.12874  25.1%     -    0s
     0     0   25.12882    0  115   33.55556   25.12882  25.1%     -    0s
     0     0   25.12889    0  115   33.55556   25.12889  25.1%     -    0s
     0     0   25.12889    0  117   33.55556   25.12889  25.1%     -    0s
     0     0   25.12891    0  117   33.55556   25.12891  25.1%     -    0s
     0     0   25.12896    0  115   33.55556   25.12896  25.1%     -    0s
     0     0   25.12900    0  115   33.55556   25.12900  25.1%     -    0s
     0     0   25.12903    0  113   33.55556   25.12903  25.1%     -    0s
     0     0   25.12907    0  113   33.55556   25.12907  25.1%     -    0s
     0     0   25.12909    0  113   33.55556   25.12909  25.1%     -    0s
     0     0   25.12911    0  113   33.55556   25.12911  25.1%     -    0s
     0     0   25.12915    0  111   33.55556   25.12915  25.1%     -    0s
     0     0   25.12919    0  113   33.55556   25.12919  25.1%     -    0s
     0     0   25.12923    0  113   33.55556   25.12923  25.1%     -    0s
     0     0   25.12929    0  113   33.55556   25.12929  25.1%     -    0s
     0     0   25.12938    0  113   33.55556   25.12938  25.1%     -    0s
     0     0   25.12941    0  113   33.55556   25.12941  25.1%     -    0s
     0     0   25.12943    0  113   33.55556   25.12943  25.1%     -    0s
     0     0   25.12943    0  116   33.55556   25.12943  25.1%     -    0s
     0     0   25.12943    0  107   33.55556   25.12943  25.1%     -    0s
     0     0   25.12947    0  107   33.55556   25.12947  25.1%     -    0s
     0     0   25.12948    0  109   33.55556   25.12948  25.1%     -    0s
     0     0   25.12949    0  111   33.55556   25.12949  25.1%     -    0s
     0     0   25.12949    0  109   33.55556   25.12949  25.1%     -    0s
     0     0   25.12949    0  111   33.55556   25.12949  25.1%     -    0s
     0     0   25.12949    0  113   33.55556   25.12949  25.1%     -    0s
     0     0   25.12954    0  111   33.55556   25.12954  25.1%     -    0s
     0     0   25.12955    0  111   33.55556   25.12955  25.1%     -    0s
     0     0   25.12961    0  111   33.55556   25.12961  25.1%     -    0s
     0     0   25.12965    0  111   33.55556   25.12965  25.1%     -    0s
     0     0   25.12965    0  102   33.55556   25.12965  25.1%     -    0s
     0     0   25.12974    0  104   33.55556   25.12974  25.1%     -    0s
     0     0   25.12986    0  100   33.55556   25.12986  25.1%     -    0s
     0     0   25.12986    0   96   33.55556   25.12986  25.1%     -    0s
     0     0   25.12986    0   90   33.55556   25.12986  25.1%     -    0s
     0     0   25.13002    0   92   33.55556   25.13002  25.1%     -    0s
     0     0   25.13007    0   94   33.55556   25.13007  25.1%     -    0s
     0     0   25.13020    0   96   33.55556   25.13020  25.1%     -    0s
     0     0   25.13024    0   98   33.55556   25.13024  25.1%     -    0s
     0     0   25.13029    0   94   33.55556   25.13029  25.1%     -    0s
     0     0   25.13029    0   98   33.55556   25.13029  25.1%     -    0s
     0     0   25.13032    0   98   33.55556   25.13032  25.1%     -    0s
     0     0   25.13035    0   98   33.55556   25.13035  25.1%     -    0s
     0     0   25.13037    0   98   33.55556   25.13037  25.1%     -    0s
     0     0   25.13040    0   98   33.55556   25.13040  25.1%     -    0s
     0     0   25.13041    0   98   33.55556   25.13041  25.1%     -    0s
     0     0   25.13041    0  100   33.55556   25.13041  25.1%     -    0s
     0     0   25.13042    0  102   33.55556   25.13042  25.1%     -    0s
     0     0   25.13045    0   98   33.55556   25.13045  25.1%     -    0s
     0     0   25.13048    0   98   33.55556   25.13048  25.1%     -    0s
     0     0   25.13048    0   98   33.55556   25.13048  25.1%     -    0s
     0     0   25.13055    0   98   33.55556   25.13055  25.1%     -    0s
     0     0   25.13057    0  100   33.55556   25.13057  25.1%     -    0s
     0     0   25.13059    0   96   33.55556   25.13059  25.1%     -    0s
     0     0   25.13064    0   97   33.55556   25.13064  25.1%     -    0s
     0     0   25.13064    0   97   33.55556   25.13064  25.1%     -    0s
     0     0   25.13066    0   97   33.55556   25.13066  25.1%     -    0s
     0     0   25.13066    0   97   33.55556   25.13066  25.1%     -    0s
     0     0   25.13069    0   97   33.55556   25.13069  25.1%     -    0s
     0     0   25.13072    0   97   33.55556   25.13072  25.1%     -    0s
     0     0   25.13073    0   99   33.55556   25.13073  25.1%     -    0s
     0     0   25.13076    0   97   33.55556   25.13076  25.1%     -    0s
     0     0   25.13080    0   98   33.55556   25.13080  25.1%     -    0s
     0     0   25.13083    0   98   33.55556   25.13083  25.1%     -    0s
     0     0   25.13086    0  100   33.55556   25.13086  25.1%     -    0s
     0     0   25.13086    0   92   33.55556   25.13086  25.1%     -    0s
     0     0   25.13086    0   94   33.55556   25.13086  25.1%     -    0s
     0     0   25.13086    0   97   33.55556   25.13086  25.1%     -    0s
     0     0   25.13086    0   97   33.55556   25.13086  25.1%     -    0s
H    0     0                      26.6027896   25.13086  5.53%     -    0s
H    0     0                      25.1472773   25.13086  0.07%     -    0s
     0     0   25.14157    0   50   25.14728   25.14157  0.02%     -    0s
     0     0   25.14161    0   50   25.14728   25.14161  0.02%     -    0s
     0     0   25.14161    0   50   25.14728   25.14161  0.02%     -    0s
H    0     0                      25.1472687   25.14161  0.02%     -    1s
     0     2   25.14161    0   50   25.14727   25.14161  0.02%     -    1s

Cutting planes:
  Learned: 1
  Cover: 1
  Clique: 6
  MIR: 1

Explored 202 nodes (11708 simplex iterations) in 1.42 seconds (1.01 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 25.1473 26.6028 33.5556 51.4485 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.514726874764e+01, best bound 2.514607480310e+01, gap 0.0047%

User-callback calls 1640, time in user-callback 0.01 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
25.147268747636623
The root upper bound is: 25.14726874763662, lower bound is: 25.1416149573236. The root gap is: 0.0225%. Runtime: 1.4235060214996338.
--------------------------------------------------
    m    n   dataset formulation  ...     end_lb   end_gap  node_count        time
0   2   50   autompg    original  ...  13.477040  0.000000       987.0    0.143679
1   2   50   autompg         opt  ...  13.477040  0.000000       185.0    0.204820
2   2   50   autompg     opt_cut  ...  13.476018  0.000076         1.0    0.427783
3   2   60   autompg    original  ...  15.882434  0.000000     29340.0    1.159530
4   2   60   autompg         opt  ...  15.882434  0.000000       424.0    0.269396
5   2   60   autompg     opt_cut  ...  15.881267  0.000073         1.0    0.537511
6   2   70   autompg    original  ...  17.972364  0.000000     78473.0    3.126956
7   2   70   autompg         opt  ...  17.972364  0.000000       548.0    0.328985
8   2   70   autompg     opt_cut  ...  17.970774  0.000089        19.0    1.467074
9   2   80   autompg    original  ...  20.929447  0.000000    476643.0   15.951053
10  2   80   autompg         opt  ...  20.929447  0.000000       841.0    0.367925
11  2   80   autompg     opt_cut  ...  20.927765  0.000080         1.0    3.429426
12  2   90   autompg    original  ...  24.143764  0.000000   2228170.0   81.510934
13  2   90   autompg         opt  ...  24.143764  0.000000       918.0    0.468860
14  2   90   autompg     opt_cut  ...  24.141946  0.000075         1.0    1.659184
15  2  100   autompg    original  ...  25.330774  0.000000   3689803.0  142.390159
16  2  100   autompg         opt  ...  25.330774  0.000000      2899.0    1.223506
17  2  100   autompg     opt_cut  ...  25.328842  0.000076         1.0    0.927402
18  2  120   autompg    original  ...  28.559842  0.148020   6562358.0  300.003432
19  2  120   autompg         opt  ...  33.521731  0.000000      6372.0    1.858597
20  2  120   autompg     opt_cut  ...  33.520458  0.000038         1.0    0.787283
21  2  150   autompg    original  ...  33.869957  0.297969   5989982.0  300.006846
22  2  150   autompg         opt  ...  48.245685  0.000000      3739.0    2.486141
23  2  150   autompg     opt_cut  ...  48.242579  0.000064         1.0    0.988786
24  2  200   autompg    original  ...  40.793079  0.435888   4440447.0  300.007618
25  2  200   autompg         opt  ...  72.313781  0.000000      3168.0    3.767727
26  2  200   autompg     opt_cut  ...  72.312785  0.000014         1.0   23.892898
27  2   50  diabetes    original  ...  18.525737  0.000000    175326.0    3.872641
28  2   50  diabetes         opt  ...  18.525737  0.000000      3953.0    0.451626
29  2   50  diabetes     opt_cut  ...  18.525258  0.000026      1018.0    1.569300
30  2   60  diabetes    original  ...  22.068124  0.000004   2200400.0   51.412170
31  2   60  diabetes         opt  ...  22.068208  0.000000      3261.0    0.524591
32  2   60  diabetes     opt_cut  ...  22.067654  0.000025         1.0    1.399760
33  2   70  diabetes    original  ...  24.644680  0.019986  11280078.0  300.006553
34  2   70  diabetes         opt  ...  25.147268  0.000000      3459.0    0.884182
35  2   70  diabetes     opt_cut  ...  25.146075  0.000047       202.0    1.423506

[36 rows x 12 columns]
[2, 80, 'diabetes']
[0.00343923 0.00860531 1.         1.         1.        ]
The relaxed obj is 0.06435569151653198.
The larges value of x is 2.858254719148013
Use new Big-M 5.716509438296026.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 160 rows, 162 columns and 320 nonzeros
Model fingerprint: 0x6fdd0dd2
Model has 243 quadratic objective terms
Variable types: 82 continuous, 80 integer (80 binary)
Coefficient statistics:
  Matrix range     [1e+00, 6e+00]
  Objective range  [9e-03, 1e+01]
  QObjective range [3e-02, 8e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 40.0000000
Presolve time: 0.00s
Presolved: 160 rows, 162 columns, 320 nonzeros
Presolved model has 243 quadratic objective terms
Variable types: 82 continuous, 80 integer (80 binary)

Root relaxation: objective 1.005501e+01, 272 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   10.05501    0   66   40.00000   10.05501  74.9%     -    0s
H    0     0                      33.0558769   10.05501  69.6%     -    0s
H    0     0                      32.3153267   10.05501  68.9%     -    0s
H    0     0                      30.2928818   10.05501  66.8%     -    0s
H    0     0                      30.2743082   10.05501  66.8%     -    0s
     0     0   10.12315    0   66   30.27431   10.12315  66.6%     -    0s
H    0     0                      30.0998859   10.12315  66.4%     -    0s
     0     2   10.12315    0   66   30.09989   10.12315  66.4%     -    0s
H   79    96                      30.0796148   13.40875  55.4%   8.5    0s
 151436 111422   27.81704   34   45   30.07961   21.24758  29.4%   5.4    5s
 328555 237450   29.80353   45   32   30.07961   22.15772  26.3%   5.3   10s
 507621 362923   27.65892   41   35   30.07961   22.65991  24.7%   5.3   15s
 685935 484578   26.42426   29   54   30.07961   22.98638  23.6%   5.2   20s
 865380 606259   23.25170   26   56   30.07961   23.24001  22.7%   5.2   25s
 1052521 730113   29.93400   47   30   30.07961   23.46089  22.0%   5.2   30s
 1231124 849029   29.13967   49   27   30.07961   23.62565  21.5%   5.1   35s
 1406261 963621   27.56489   34   42   30.07961   23.76846  21.0%   5.1   40s
 1583702 1078714   28.22704   37   44   30.07961   23.89358  20.6%   5.1   45s
 1762311 1192379   25.27120   32   52   30.07961   24.00769  20.2%   5.1   50s
 1944481 1308314   25.88635   34   43   30.07961   24.11038  19.8%   5.1   55s
 2126067 1422968   26.65683   28   53   30.07961   24.20604  19.5%   5.1   60s
 2305167 1535627   25.30851   30   51   30.07961   24.29035  19.2%   5.1   65s
 2478578 1642758   28.39653   39   37   30.07961   24.36781  19.0%   5.1   70s
 2656580 1752762   29.19647   40   36   30.07961   24.43896  18.8%   5.1   75s
 2837379 1863905   27.86686   37   40   30.07961   24.50990  18.5%   5.1   80s
 3019469 1976023   29.04891   39   42   30.07961   24.57598  18.3%   5.0   85s
 3202006 2085731     cutoff   44        30.07961   24.63894  18.1%   5.0   90s
 3377759 2191556   28.91861   44   38   30.07961   24.69548  17.9%   5.0   95s
 3553637 2297314   27.46652   36   43   30.07961   24.74882  17.7%   5.0  100s
 3738599 2407645   29.49833   41   36   30.07961   24.80169  17.5%   5.0  105s
 3918404 2514257   29.81872   46   31   30.07961   24.85045  17.4%   5.0  110s
 4096391 2619920   28.49572   34   44   30.07961   24.89775  17.2%   5.0  115s
 4263532 2717682   28.93477   37   45   30.07961   24.94023  17.1%   5.0  120s
 4429070 2814228   26.71302   34   42   30.07961   24.98100  17.0%   5.0  125s
 4600746 2913963   29.80455   43   39   30.07961   25.02096  16.8%   5.0  130s
 4779458 3018711   26.07978   34   44   30.07961   25.06086  16.7%   5.0  135s
 4957158 3121640   30.03347   39   36   30.07961   25.09934  16.6%   5.0  140s
 5128121 3220087   25.13616   28   48   30.07961   25.13489  16.4%   5.0  145s
 5296518 3315506   30.06135   38   41   30.07961   25.16807  16.3%   5.0  150s
 5469186 3413786   26.04824   33   44   30.07961   25.20153  16.2%   5.0  155s
 5652570 3518017   25.65806   31   51   30.07961   25.23637  16.1%   5.0  160s
 5834879 3620581   27.84605   30   56   30.07961   25.27005  16.0%   5.0  165s
 6002091 3713709   26.51272   34   47   30.07961   25.29965  15.9%   5.0  170s
 6172871 3809346   28.55854   41   37   30.07961   25.32885  15.8%   5.0  175s
 6344276 3904889   29.56668   33   47   30.07961   25.35710  15.7%   5.0  180s
 6521544 4003428   29.38028   44   33   30.07961   25.38537  15.6%   5.0  185s
 6694552 4099534   29.01171   37   42   30.07961   25.41336  15.5%   5.0  190s
 6860190 4191172   26.48146   33   43   30.07961   25.43862  15.4%   4.9  195s
 7022367 4279825   27.91881   37   43   30.07961   25.46310  15.3%   4.9  200s
 7185368 4368323   25.48785   32   46   30.07961   25.48712  15.3%   4.9  205s
 7347243 4455120   28.93520   37   41   30.07961   25.50988  15.2%   4.9  210s
 7500461 4539098   29.80461   37   43   30.07961   25.53131  15.1%   4.9  215s
 7658366 4624302   29.30478   36   46   30.07961   25.55257  15.1%   4.9  220s
 7823531 4713096   26.02489   33   45   30.07961   25.57505  15.0%   4.9  225s
 7980466 4798111   29.21846   39   40   30.07961   25.59582  14.9%   4.9  230s
 8137015 4881047   28.14604   37   41   30.07961   25.61584  14.8%   4.9  235s
 8295774 4964995   28.10918   35   45   30.07961   25.63561  14.8%   4.9  240s
 8452534 5047758   28.69240   38   44   30.07961   25.65497  14.7%   4.9  245s
 8611902 5131252   26.07643   30   53   30.07961   25.67437  14.6%   4.9  250s
 8769545 5214398   29.43528   40   40   30.07961   25.69293  14.6%   4.9  255s
 8930902 5300469   28.09944   37   40   30.07961   25.71128  14.5%   4.9  260s
 9088458 5382699   27.51962   36   46   30.07961   25.72950  14.5%   4.9  265s
 9251474 5468059   26.73671   34   47   30.07961   25.74751  14.4%   4.9  270s
 9412536 5551979   30.05911   41   35   30.07961   25.76545  14.3%   4.9  275s
 9574282 5635847   27.43986   36   43   30.07961   25.78322  14.3%   4.9  280s
 9733268 5717411   28.40064   39   45   30.07961   25.80030  14.2%   4.9  285s
 9900062 5803419   28.65387   37   41   30.07961   25.81765  14.2%   4.9  290s
 10050658 5880848   25.83366   33   43   30.07961   25.83317  14.1%   4.9  295s

Explored 10210416 nodes (50020138 simplex iterations) in 300.01 seconds (390.71 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 30.0796 30.0999 30.2743 ... 40

Time limit reached
Best objective 3.007961477986e+01, best bound 2.584961346365e+01, gap 14.0627%

User-callback calls 20450763, time in user-callback 24.33 sec
--------------------------------
solve the problem in original formulation
The obj is 30.079614779862922.
The root upper bound is: 30.099885869106494, lower bound is: 10.123150819433349. The root gap is: 66.3681%. Runtime: 300.007493019104.
[ 9 23 29 32 36 37 38 44 57 71 78]
Number of outliers: 11
--------------------------------
The decomposition time is 0.07921920903027058.
Optimal value: 79.9999999591949
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.07178868353366852.
Optimal value: 79.9999999591949
10.055024323355251
30.078777601332476
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 560 rows, 322 columns and 1520 nonzeros
Model fingerprint: 0xf07c721c
Model has 243 quadratic objective terms
Variable types: 82 continuous, 240 integer (240 binary)
Coefficient statistics:
  Matrix range     [2e-02, 1e+03]
  Objective range  [9e-03, 1e+01]
  QObjective range [3e-02, 8e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-02, 1e+03]
Found heuristic solution: objective 49.9886130
Presolve time: 0.00s
Presolved: 560 rows, 322 columns, 1520 nonzeros
Presolved model has 243 quadratic objective terms
Variable types: 82 continuous, 240 integer (240 binary)

Root relaxation: objective 1.005501e+01, 1027 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   10.05501    0  132   49.98861   10.05501  79.9%     -    0s
H    0     0                      30.1450392   10.05501  66.6%     -    0s
     0     0   11.45574    0  138   30.14504   11.45574  62.0%     -    0s
H    0     0                      30.1150205   11.45574  62.0%     -    0s
H    0     0                      30.0796148   11.45574  61.9%     -    0s
     0     2   11.45574    0  138   30.07961   11.45574  61.9%     -    0s

Cutting planes:
  Learned: 48
  Cover: 13
  Clique: 18
  Inf proof: 10

Explored 3410 nodes (55658 simplex iterations) in 1.00 seconds (0.75 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 30.0796 30.115 30.145 

Optimal solution found (tolerance 1.00e-04)
Best objective 3.007961477986e+01, best bound 3.007961477986e+01, gap 0.0000%

User-callback calls 7226, time in user-callback 0.01 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 30.079614779862922.
The root upper bound is: 30.079614779862922, lower bound is: 11.455740483515793. The root gap is: 61.9153%. Runtime: 0.999763011932373.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 561 rows, 323 columns and 1683 nonzeros
Model fingerprint: 0xfd2807ed
Model has 243 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 83 continuous, 240 integer (240 binary)
Coefficient statistics:
  Matrix range     [9e-03, 1e+03]
  QMatrix range    [2e-02, 4e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [9e-03, 1e+01]
  QObjective range [4e-10, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-02, 1e+03]
Presolve time: 0.00s
Presolved: 561 rows, 323 columns, 1683 nonzeros
Presolved model has 243 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 83 continuous, 240 integer (240 binary)

Root relaxation: objective 3.007874e+01, 751 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   30.07874    0   30          -   30.07874      -     -    0s
H    0     0                      60.5525985   30.07874  50.3%     -    0s
H    0     0                      31.2296348   30.07874  3.69%     -    0s
     0     0   30.07874    0   34   31.22963   30.07874  3.69%     -    0s
H    0     0                      30.5806081   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   32   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07874    0   34   30.58061   30.07874  1.64%     -    0s
     0     0   30.07875    0   34   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   34   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07875    0   30   30.58061   30.07875  1.64%     -    0s
     0     0   30.07876    0   30   30.58061   30.07876  1.64%     -    0s
     0     0   30.07876    0   30   30.58061   30.07876  1.64%     -    0s
     0     0   30.07876    0   30   30.58061   30.07876  1.64%     -    0s
     0     0   30.07876    0   30   30.58061   30.07876  1.64%     -    0s
     0     0   30.07876    0   30   30.58061   30.07876  1.64%     -    0s
     0     0   30.07876    0   30   30.58061   30.07876  1.64%     -    0s
     0     0   30.07876    0   30   30.58061   30.07876  1.64%     -    0s
     0     0   30.07876    0   30   30.58061   30.07876  1.64%     -    0s
     0     0   30.07877    0   30   30.58061   30.07877  1.64%     -    0s
     0     0   30.07877    0   30   30.58061   30.07877  1.64%     -    0s
     0     0   30.07877    0   30   30.58061   30.07877  1.64%     -    0s
     0     0   30.07877    0   30   30.58061   30.07877  1.64%     -    0s
     0     0   30.07877    0   30   30.58061   30.07877  1.64%     -    0s
     0     0   30.07877    0   30   30.58061   30.07877  1.64%     -    0s
     0     0   30.07877    0   30   30.58061   30.07877  1.64%     -    0s
     0     0   30.07877    0   30   30.58061   30.07877  1.64%     -    0s
     0     0   30.07877    0   30   30.58061   30.07877  1.64%     -    0s
     0     0   30.07877    0   30   30.58061   30.07877  1.64%     -    0s
     0     0   30.07877    0   30   30.58061   30.07877  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   30   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   32   30.58061   30.07878  1.64%     -    0s
     0     0   30.07878    0   34   30.58061   30.07878  1.64%     -    0s
H    0     0                      30.0796235   30.07878  0.00%     -    0s

Cutting planes:
  Learned: 10
  MIR: 4

Explored 1 nodes (3493 simplex iterations) in 0.79 seconds (0.40 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 30.0796 30.5806 31.2296 60.5526 

Optimal solution found (tolerance 1.00e-04)
Best objective 3.007962347223e+01, best bound 3.007877910784e+01, gap 0.0028%

User-callback calls 952, time in user-callback 0.00 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
30.079623472227173
The root upper bound is: 30.58060810756595, lower bound is: 30.078779107837796. The root gap is: 1.641%. Runtime: 0.7884368896484375.
--------------------------------------------------
    m    n   dataset formulation  ...     end_lb   end_gap  node_count        time
0   2   50   autompg    original  ...  13.477040  0.000000       987.0    0.143679
1   2   50   autompg         opt  ...  13.477040  0.000000       185.0    0.204820
2   2   50   autompg     opt_cut  ...  13.476018  0.000076         1.0    0.427783
3   2   60   autompg    original  ...  15.882434  0.000000     29340.0    1.159530
4   2   60   autompg         opt  ...  15.882434  0.000000       424.0    0.269396
5   2   60   autompg     opt_cut  ...  15.881267  0.000073         1.0    0.537511
6   2   70   autompg    original  ...  17.972364  0.000000     78473.0    3.126956
7   2   70   autompg         opt  ...  17.972364  0.000000       548.0    0.328985
8   2   70   autompg     opt_cut  ...  17.970774  0.000089        19.0    1.467074
9   2   80   autompg    original  ...  20.929447  0.000000    476643.0   15.951053
10  2   80   autompg         opt  ...  20.929447  0.000000       841.0    0.367925
11  2   80   autompg     opt_cut  ...  20.927765  0.000080         1.0    3.429426
12  2   90   autompg    original  ...  24.143764  0.000000   2228170.0   81.510934
13  2   90   autompg         opt  ...  24.143764  0.000000       918.0    0.468860
14  2   90   autompg     opt_cut  ...  24.141946  0.000075         1.0    1.659184
15  2  100   autompg    original  ...  25.330774  0.000000   3689803.0  142.390159
16  2  100   autompg         opt  ...  25.330774  0.000000      2899.0    1.223506
17  2  100   autompg     opt_cut  ...  25.328842  0.000076         1.0    0.927402
18  2  120   autompg    original  ...  28.559842  0.148020   6562358.0  300.003432
19  2  120   autompg         opt  ...  33.521731  0.000000      6372.0    1.858597
20  2  120   autompg     opt_cut  ...  33.520458  0.000038         1.0    0.787283
21  2  150   autompg    original  ...  33.869957  0.297969   5989982.0  300.006846
22  2  150   autompg         opt  ...  48.245685  0.000000      3739.0    2.486141
23  2  150   autompg     opt_cut  ...  48.242579  0.000064         1.0    0.988786
24  2  200   autompg    original  ...  40.793079  0.435888   4440447.0  300.007618
25  2  200   autompg         opt  ...  72.313781  0.000000      3168.0    3.767727
26  2  200   autompg     opt_cut  ...  72.312785  0.000014         1.0   23.892898
27  2   50  diabetes    original  ...  18.525737  0.000000    175326.0    3.872641
28  2   50  diabetes         opt  ...  18.525737  0.000000      3953.0    0.451626
29  2   50  diabetes     opt_cut  ...  18.525258  0.000026      1018.0    1.569300
30  2   60  diabetes    original  ...  22.068124  0.000004   2200400.0   51.412170
31  2   60  diabetes         opt  ...  22.068208  0.000000      3261.0    0.524591
32  2   60  diabetes     opt_cut  ...  22.067654  0.000025         1.0    1.399760
33  2   70  diabetes    original  ...  24.644680  0.019986  11280078.0  300.006553
34  2   70  diabetes         opt  ...  25.147268  0.000000      3459.0    0.884182
35  2   70  diabetes     opt_cut  ...  25.146075  0.000047       202.0    1.423506
36  2   80  diabetes    original  ...  25.849613  0.140627  10210416.0  300.007493
37  2   80  diabetes         opt  ...  30.079615  0.000000      3410.0    0.999763
38  2   80  diabetes     opt_cut  ...  30.078779  0.000028         1.0    0.788437

[39 rows x 12 columns]
[2, 90, 'diabetes']
[0.00326236 0.0066468  1.         1.         1.        ]
The relaxed obj is 0.07228696676280322.
The larges value of x is 2.931248726815542
Use new Big-M 5.862497453631084.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 180 rows, 182 columns and 360 nonzeros
Model fingerprint: 0xb026e9e5
Model has 273 quadratic objective terms
Variable types: 92 continuous, 90 integer (90 binary)
Coefficient statistics:
  Matrix range     [1e+00, 6e+00]
  Objective range  [5e-03, 1e+01]
  QObjective range [1e-02, 9e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 45.0000000
Presolve time: 0.00s
Presolved: 180 rows, 182 columns, 360 nonzeros
Presolved model has 273 quadratic objective terms
Variable types: 92 continuous, 90 integer (90 binary)

Root relaxation: objective 1.103013e+01, 290 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   11.03013    0   74   45.00000   11.03013  75.5%     -    0s
H    0     0                      37.1774761   11.03013  70.3%     -    0s
H    0     0                      36.2746705   11.03013  69.6%     -    0s
H    0     0                      33.9012181   11.03013  67.5%     -    0s
H    0     0                      33.5653243   11.03013  67.1%     -    0s
     0     0   11.17994    0   74   33.56532   11.17994  66.7%     -    0s
H    0     0                      33.3956501   11.17994  66.5%     -    0s
     0     2   11.17994    0   74   33.39565   11.17994  66.5%     -    1s
H   32    40                      33.3924301   13.82622  58.6%  11.1    1s
H  263   307                      33.3914633   14.70170  56.0%   7.4    1s
 50196 38795   29.33111   37   54   33.39146   21.02233  37.0%   5.7    5s
 124745 97342   28.15261   41   49   33.39146   22.14104  33.7%   5.5   10s
 242110 187183   33.34776   42   50   33.39146   22.95155  31.3%   5.4   15s
 387080 298332   26.16516   36   60   33.39146   23.47263  29.7%   5.4   20s
 530321 407890   32.51735   49   38   33.39146   23.82462  28.7%   5.3   25s
 683465 523769   30.75746   43   47   33.39146   24.11123  27.8%   5.3   30s
 827225 630170   32.83706   50   42   33.39146   24.32485  27.2%   5.3   35s
 972445 738756   26.56529   37   51   33.39146   24.50768  26.6%   5.3   40s
 1116180 845341   30.65021   47   44   33.39146   24.65778  26.2%   5.2   45s
 1270568 959011   31.15143   49   43   33.39146   24.79951  25.7%   5.2   50s
 1417948 1067390   29.26317   41   53   33.39146   24.91635  25.4%   5.2   55s
 1562514 1173763   30.30410   40   52   33.39146   25.01674  25.1%   5.2   60s
 1711155 1282436   27.32912   35   54   33.39146   25.11270  24.8%   5.2   65s
 1858241 1388582   32.46621   40   54   33.39146   25.19837  24.5%   5.2   70s
 2002315 1491352   32.77894   50   43   33.39146   25.27608  24.3%   5.2   75s
 2150647 1598761   31.96751   50   42   33.39146   25.35225  24.1%   5.2   80s
 2300429 1706729     cutoff   40        33.39146   25.42452  23.9%   5.2   85s
 2444967 1810645   27.57333   39   51   33.39146   25.49055  23.7%   5.2   90s
 2588682 1913434   28.22784   33   65   33.39146   25.55021  23.5%   5.2   95s
 2734432 2017627   26.41651   35   53   33.39146   25.60752  23.3%   5.2  100s
 2888558 2127510   30.88107   43   50   33.39146   25.66569  23.1%   5.1  105s
 3035768 2233103   28.63863   37   50   33.39146   25.71985  23.0%   5.1  110s
 3178915 2334162   31.41821   43   53   33.39146   25.76921  22.8%   5.1  115s
 3320914 2434337   33.15522   61   33   33.39146   25.81467  22.7%   5.1  120s
 3471225 2540926   32.78177   35   56   33.39146   25.86114  22.6%   5.1  125s
 3619357 2645474   30.14834   38   52   33.39146   25.90460  22.4%   5.1  130s
 3766411 2747880   32.85025   54   41   33.39146   25.94644  22.3%   5.1  135s
 3911817 2849263   28.56807   36   58   33.39146   25.98708  22.2%   5.1  140s
 4062973 2953699   29.16698   34   60   33.39146   26.02742  22.1%   5.1  145s
 4206980 3053525   32.14801   39   47   33.39146   26.06302  21.9%   5.1  150s
 4354011 3156248   32.97319   46   47   33.39146   26.09902  21.8%   5.1  155s
 4500978 3257244   27.95523   35   60   33.39146   26.13391  21.7%   5.1  160s
 4656952 3365494   29.38316   41   46   33.39146   26.16947  21.6%   5.1  165s
 4800386 3464239   31.60881   48   47   33.39146   26.20075  21.5%   5.1  170s
 4946400 3564923   32.76564   47   49   33.39146   26.23249  21.4%   5.1  175s
 5098795 3669081   30.16935   36   58   33.39146   26.26396  21.3%   5.1  180s
 5246791 3772387   27.28724   35   59   33.39146   26.29414  21.3%   5.1  185s
 5387410 3868239     cutoff   55        33.39146   26.32130  21.2%   5.1  190s
 5530605 3965453   30.34502   42   51   33.39146   26.34759  21.1%   5.1  195s
 5684905 4071287   28.85405   34   59   33.39146   26.37645  21.0%   5.1  200s
 5829528 4169054   31.12488   37   56   33.39146   26.40206  20.9%   5.1  205s
 5972880 4266707   28.83426   41   49   33.39146   26.42745  20.9%   5.1  210s
 6119010 4366711   28.48631   40   54   33.39146   26.45223  20.8%   5.1  215s
 6271433 4470686   30.56317   41   54   33.39146   26.47812  20.7%   5.1  220s
 6412098 4566299   32.80962   50   46   33.39146   26.50080  20.6%   5.1  225s
 6552839 4661388     cutoff   43        33.39146   26.52267  20.6%   5.1  230s
 6703836 4762885   32.23778   45   43   33.39146   26.54622  20.5%   5.1  235s
 6848352 4860484   30.79520   44   50   33.39146   26.56758  20.4%   5.1  240s
 6992497 4959215   30.67285   44   48   33.39146   26.58919  20.4%   5.1  245s
 7140294 5059432   29.15802   36   56   33.39146   26.61055  20.3%   5.1  250s
 7285368 5157121   30.90516   46   42   33.39146   26.63113  20.2%   5.1  255s
 7433009 5256260   29.65045   43   44   33.39146   26.65173  20.2%   5.1  260s
 7575303 5351305   31.00562   42   49   33.39146   26.67163  20.1%   5.1  265s
 7720369 5449366   29.58737   39   57   33.39146   26.69107  20.1%   5.1  270s
 7864410 5545453   26.94399   34   57   33.39146   26.70996  20.0%   5.1  275s
 8013621 5644621   30.56248   40   55   33.39146   26.72929  20.0%   5.1  280s
 8160909 5743847   28.60890   35   59   33.39146   26.74834  19.9%   5.1  285s
 8304409 5839446   32.60956   52   45   33.39146   26.76614  19.8%   5.1  290s
 8448953 5935713     cutoff   52        33.39146   26.78401  19.8%   5.1  295s
 8592855 6032446   30.71417   45   51   33.39146   26.80178  19.7%   5.1  300s

Explored 8594053 nodes (43527826 simplex iterations) in 300.01 seconds (399.82 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 33.3915 33.3957 36.2747 ... 45

Time limit reached
Best objective 3.339146331368e+01, best bound 2.680195763698e+01, gap 19.7341%

User-callback calls 17216310, time in user-callback 22.15 sec
--------------------------------
solve the problem in original formulation
The obj is 33.39146331368022.
The root upper bound is: 33.39565007812715, lower bound is: 11.179938055301225. The root gap is: 66.5228%. Runtime: 300.0080931186676.
[ 9 23 29 32 36 37 38 44 57 71 78]
Number of outliers: 11
--------------------------------
The decomposition time is 0.08888888731598854.
Optimal value: 89.99999978567918
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.09519712813198566.
Optimal value: 89.99999978567918
11.030133148900575
33.39021951323275
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 630 rows, 362 columns and 1710 nonzeros
Model fingerprint: 0x544834d7
Model has 273 quadratic objective terms
Variable types: 92 continuous, 270 integer (270 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+03]
  Objective range  [5e-03, 1e+01]
  QObjective range [1e-02, 9e+01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-02, 1e+03]
Found heuristic solution: objective 55.3359984
Presolve time: 0.00s
Presolved: 630 rows, 362 columns, 1710 nonzeros
Presolved model has 273 quadratic objective terms
Variable types: 92 continuous, 270 integer (270 binary)
Found heuristic solution: objective 53.5014622

Root relaxation: objective 1.103013e+01, 1132 iterations, 0.02 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   11.03013    0  148   53.50146   11.03013  79.4%     -    0s
H    0     0                      33.3956501   11.03013  67.0%     -    0s
     0     0   12.45326    0  156   33.39565   12.45326  62.7%     -    0s
H    0     0                      33.3914633   12.45326  62.7%     -    0s
     0     2   12.45326    0  156   33.39146   12.45326  62.7%     -    0s

Cutting planes:
  Learned: 63
  Cover: 78
  Clique: 8
  Inf proof: 42

Explored 11158 nodes (177844 simplex iterations) in 2.06 seconds (2.33 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 33.3915 33.3957 53.5015 55.336 

Optimal solution found (tolerance 1.00e-04)
Best objective 3.339146331368e+01, best bound 3.339146331368e+01, gap 0.0000%

User-callback calls 22965, time in user-callback 0.03 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 33.39146331368022.
The root upper bound is: 33.39146331368022, lower bound is: 12.453255899788232. The root gap is: 62.7053%. Runtime: 2.0621659755706787.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 631 rows, 363 columns and 1893 nonzeros
Model fingerprint: 0x0b4ed53c
Model has 273 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 93 continuous, 270 integer (270 binary)
Coefficient statistics:
  Matrix range     [5e-03, 1e+03]
  QMatrix range    [6e-03, 5e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [5e-03, 1e+01]
  QObjective range [2e-09, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-02, 1e+03]
Presolve time: 0.00s
Presolved: 631 rows, 363 columns, 1893 nonzeros
Presolved model has 273 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 93 continuous, 270 integer (270 binary)

Root relaxation: objective 3.339021e+01, 893 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   33.39021    0   30          -   33.39021      -     -    0s
H    0     0                      61.9758656   33.39021  46.1%     -    0s
H    0     0                      61.9758507   33.39021  46.1%     -    0s
     0     0   33.39021    0   34   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   32   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   33   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   33   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   33   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39021    0   35   61.97585   33.39021  46.1%     -    0s
     0     0   33.39022    0   35   61.97585   33.39022  46.1%     -    0s
     0     0   33.39022    0   35   61.97585   33.39022  46.1%     -    0s
     0     0   33.39022    0   35   61.97585   33.39022  46.1%     -    0s
     0     0   33.39022    0   35   61.97585   33.39022  46.1%     -    0s
     0     0   33.39022    0   35   61.97585   33.39022  46.1%     -    0s
     0     0   33.39022    0   35   61.97585   33.39022  46.1%     -    0s
     0     0   33.39023    0   35   61.97585   33.39023  46.1%     -    0s
     0     0   33.39023    0   35   61.97585   33.39023  46.1%     -    0s
     0     0   33.39023    0   35   61.97585   33.39023  46.1%     -    0s
     0     0   33.39023    0   35   61.97585   33.39023  46.1%     -    0s
     0     0   33.39023    0   35   61.97585   33.39023  46.1%     -    0s
     0     0   33.39023    0   35   61.97585   33.39023  46.1%     -    0s
     0     0   33.39023    0   35   61.97585   33.39023  46.1%     -    0s
     0     0   33.39023    0   35   61.97585   33.39023  46.1%     -    0s
     0     0   33.39023    0   35   61.97585   33.39023  46.1%     -    0s
     0     0   33.39023    0   35   61.97585   33.39023  46.1%     -    0s
     0     0   33.39023    0   35   61.97585   33.39023  46.1%     -    0s
     0     0   33.39023    0   35   61.97585   33.39023  46.1%     -    0s
     0     0   33.39023    0   35   61.97585   33.39023  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39024    0   35   61.97585   33.39024  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39025    0   35   61.97585   33.39025  46.1%     -    0s
     0     0   33.39026    0   35   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   35   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   35   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   35   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   35   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   35   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   35   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   35   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   35   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   35   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   43   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   43   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   43   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   43   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   43   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   43   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   43   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   43   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   43   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   43   61.97585   33.39026  46.1%     -    0s
     0     0   33.39026    0   43   61.97585   33.39026  46.1%     -    0s
H    0     0                      33.8407174   33.39026  1.33%     -    0s
     0     2   33.39026    0   43   33.84072   33.39026  1.33%     -    1s
H   30    24                      33.8407173   33.39026  1.33%  95.3    1s
H   35    24                      33.3956502   33.39026  0.02%   101    2s
H 1612    23                      33.3914675   33.39027  0.00%  18.3    3s
* 1612    23              24      33.3914675   33.39027  0.00%  18.3    3s

Cutting planes:
  Learned: 26
  Gomory: 1
  Cover: 1
  Clique: 3
  MIR: 9
  StrongCG: 1

Explored 1671 nodes (32856 simplex iterations) in 3.32 seconds (2.61 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 33.3915 33.3957 33.8407 61.9759 

Optimal solution found (tolerance 1.00e-04)
Best objective 3.339146750402e+01, best bound 3.339027372934e+01, gap 0.0036%

User-callback calls 5252, time in user-callback 0.02 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
33.39146750401995
The root upper bound is: 33.84071735386143, lower bound is: 33.3902612875405. The root gap is: 1.3311%. Runtime: 3.3216989040374756.
--------------------------------------------------
    m    n   dataset formulation  ...     end_lb   end_gap  node_count        time
0   2   50   autompg    original  ...  13.477040  0.000000       987.0    0.143679
1   2   50   autompg         opt  ...  13.477040  0.000000       185.0    0.204820
2   2   50   autompg     opt_cut  ...  13.476018  0.000076         1.0    0.427783
3   2   60   autompg    original  ...  15.882434  0.000000     29340.0    1.159530
4   2   60   autompg         opt  ...  15.882434  0.000000       424.0    0.269396
5   2   60   autompg     opt_cut  ...  15.881267  0.000073         1.0    0.537511
6   2   70   autompg    original  ...  17.972364  0.000000     78473.0    3.126956
7   2   70   autompg         opt  ...  17.972364  0.000000       548.0    0.328985
8   2   70   autompg     opt_cut  ...  17.970774  0.000089        19.0    1.467074
9   2   80   autompg    original  ...  20.929447  0.000000    476643.0   15.951053
10  2   80   autompg         opt  ...  20.929447  0.000000       841.0    0.367925
11  2   80   autompg     opt_cut  ...  20.927765  0.000080         1.0    3.429426
12  2   90   autompg    original  ...  24.143764  0.000000   2228170.0   81.510934
13  2   90   autompg         opt  ...  24.143764  0.000000       918.0    0.468860
14  2   90   autompg     opt_cut  ...  24.141946  0.000075         1.0    1.659184
15  2  100   autompg    original  ...  25.330774  0.000000   3689803.0  142.390159
16  2  100   autompg         opt  ...  25.330774  0.000000      2899.0    1.223506
17  2  100   autompg     opt_cut  ...  25.328842  0.000076         1.0    0.927402
18  2  120   autompg    original  ...  28.559842  0.148020   6562358.0  300.003432
19  2  120   autompg         opt  ...  33.521731  0.000000      6372.0    1.858597
20  2  120   autompg     opt_cut  ...  33.520458  0.000038         1.0    0.787283
21  2  150   autompg    original  ...  33.869957  0.297969   5989982.0  300.006846
22  2  150   autompg         opt  ...  48.245685  0.000000      3739.0    2.486141
23  2  150   autompg     opt_cut  ...  48.242579  0.000064         1.0    0.988786
24  2  200   autompg    original  ...  40.793079  0.435888   4440447.0  300.007618
25  2  200   autompg         opt  ...  72.313781  0.000000      3168.0    3.767727
26  2  200   autompg     opt_cut  ...  72.312785  0.000014         1.0   23.892898
27  2   50  diabetes    original  ...  18.525737  0.000000    175326.0    3.872641
28  2   50  diabetes         opt  ...  18.525737  0.000000      3953.0    0.451626
29  2   50  diabetes     opt_cut  ...  18.525258  0.000026      1018.0    1.569300
30  2   60  diabetes    original  ...  22.068124  0.000004   2200400.0   51.412170
31  2   60  diabetes         opt  ...  22.068208  0.000000      3261.0    0.524591
32  2   60  diabetes     opt_cut  ...  22.067654  0.000025         1.0    1.399760
33  2   70  diabetes    original  ...  24.644680  0.019986  11280078.0  300.006553
34  2   70  diabetes         opt  ...  25.147268  0.000000      3459.0    0.884182
35  2   70  diabetes     opt_cut  ...  25.146075  0.000047       202.0    1.423506
36  2   80  diabetes    original  ...  25.849613  0.140627  10210416.0  300.007493
37  2   80  diabetes         opt  ...  30.079615  0.000000      3410.0    0.999763
38  2   80  diabetes     opt_cut  ...  30.078779  0.000028         1.0    0.788437
39  2   90  diabetes    original  ...  26.801958  0.197341   8594053.0  300.008093
40  2   90  diabetes         opt  ...  33.391463  0.000000     11158.0    2.062166
41  2   90  diabetes     opt_cut  ...  33.390274  0.000036      1671.0    3.321699

[42 rows x 12 columns]
[2, 100, 'diabetes']
[0.00291899 0.00608296 1.         1.         1.        ]
The relaxed obj is 0.08029358179863522.
The larges value of x is 2.9591129075045015
Use new Big-M 5.918225815009003.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 200 rows, 202 columns and 400 nonzeros
Model fingerprint: 0x519c4dfe
Model has 303 quadratic objective terms
Variable types: 102 continuous, 100 integer (100 binary)
Coefficient statistics:
  Matrix range     [1e+00, 6e+00]
  Objective range  [6e-03, 1e+01]
  QObjective range [3e-02, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 50.0000000
Presolve time: 0.00s
Presolved: 200 rows, 202 columns, 400 nonzeros
Presolved model has 303 quadratic objective terms
Variable types: 102 continuous, 100 integer (100 binary)

Root relaxation: objective 1.211639e+01, 316 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   12.11639    0   84   50.00000   12.11639  75.8%     -    0s
H    0     0                      40.5640137   12.11639  70.1%     -    0s
H    0     0                      37.0195867   12.11639  67.3%     -    0s
H    0     0                      36.6627060   12.11639  67.0%     -    0s
     0     0   12.57238    0   84   36.66271   12.57238  65.7%     -    0s
H    0     0                      36.4767537   12.57238  65.5%     -    0s
     0     2   12.57238    0   84   36.47675   12.57238  65.5%     -    1s
 80793 64112   27.52647   31   70   36.47675   22.93386  37.1%   5.6    5s
 213263 171350   34.25441   52   47   36.47675   24.21698  33.6%   5.5   10s
 341492 271123   31.90982   46   51   36.47675   24.79074  32.0%   5.4   15s
 469387 372757   35.26617   52   40   36.47675   25.15721  31.0%   5.3   20s
 604689 478183   29.05773   35   60   36.47675   25.46324  30.2%   5.3   25s
 733993 579469   28.67102   29   68   36.47675   25.68830  29.6%   5.3   30s
 863679 679320   30.63399   40   56   36.47675   25.87311  29.1%   5.3   35s
 994852 781713   30.12006   37   66   36.47675   26.03845  28.6%   5.2   40s
 1126526 883465   30.97872   37   63   36.47675   26.17101  28.3%   5.2   45s
 1259614 986990   26.67180   30   63   36.47675   26.29366  27.9%   5.2   50s
 1389296 1087493   33.11795   37   56   36.47675   26.40175  27.6%   5.2   55s
 1524496 1192053   34.99789   47   52   36.47675   26.50435  27.3%   5.2   60s
 1655593 1292512   36.04731   49   50   36.47675   26.59818  27.1%   5.2   65s
 1787382 1393478   29.15902   33   65   36.47675   26.68410  26.8%   5.2   70s
 1925402 1498976   28.06133   30   72   36.47675   26.76327  26.6%   5.2   75s
 2054678 1598123   29.05684   33   64   36.47675   26.83328  26.4%   5.2   80s
 2186347 1697662   32.73232   41   59   36.47675   26.90180  26.2%   5.2   85s
 2319102 1799115   30.67965   33   69   36.47675   26.96652  26.1%   5.2   90s
 2458722 1904438   36.45957   52   49   36.47675   27.03355  25.9%   5.2   95s
 2596780 2008332   31.72600   39   57   36.47675   27.09570  25.7%   5.1  100s
 2729899 2109520   29.56267   35   65   36.47675   27.15017  25.6%   5.1  105s
 2865892 2212565   29.86306   37   64   36.47675   27.20230  25.4%   5.1  110s
 2993146 2308449   36.37284   47   51   36.47675   27.24802  25.3%   5.1  115s
 3123487 2406853   36.42115   59   41   36.47675   27.29367  25.2%   5.1  120s
 3258781 2508952   33.83323   47   52   36.47675   27.33931  25.1%   5.1  125s
 3388846 2606580   33.82544   42   54   36.47675   27.38108  24.9%   5.1  130s
 3519353 2705426   29.98351   39   59   36.47675   27.42217  24.8%   5.1  135s
 3654574 2807300   28.02992   32   71   36.47675   27.46217  24.7%   5.1  140s
 3784450 2904936   31.17142   36   65   36.47675   27.49951  24.6%   5.1  145s
 3917855 3004747   32.39074   41   59   36.47675   27.53700  24.5%   5.1  150s
 4056357 3107406   33.10698   45   55   36.47675   27.57474  24.4%   5.1  155s
 4188050 3205212   32.00813   42   53   36.47675   27.61029  24.3%   5.1  160s
 4320832 3304197   30.95361   30   69   36.47675   27.64468  24.2%   5.1  165s
 4454955 3404523   32.94449   43   55   36.47675   27.67729  24.1%   5.1  170s
 4580861 3498376   29.61933   37   59   36.47675   27.70674  24.0%   5.1  175s
 4712728 3595973   31.50193   39   60   36.47675   27.73724  24.0%   5.1  180s
 4850165 3698619   32.88587   46   56   36.47675   27.76859  23.9%   5.1  185s
 4982373 3797545   34.84445   41   60   36.47675   27.79570  23.8%   5.1  190s
 5110515 3893007   35.41467   51   42   36.47675   27.82264  23.7%   5.1  195s
 5248694 3994430   34.95126   50   48   36.47675   27.85100  23.6%   5.1  200s
 5378919 4090801   28.84937   35   60   36.47675   27.87658  23.6%   5.1  205s
 5510123 4187023   35.31299   51   51   36.47675   27.90238  23.5%   5.1  210s
 5639944 4281843   27.93037   33   67   36.47675   27.92810  23.4%   5.1  215s
 5772839 4380215   32.38271   42   55   36.47675   27.95343  23.4%   5.1  220s
 5902366 4476694   36.21989   45   47   36.47675   27.97653  23.3%   5.1  225s
 6034041 4573701   31.00896   36   63   36.47675   27.99973  23.2%   5.1  230s
 6170797 4675007   34.34977   40   61   36.47675   28.02370  23.2%   5.1  235s
 6301449 4771242   36.20420   58   42   36.47675   28.04667  23.1%   5.1  240s
 6432265 4868537   29.48484   31   70   36.47675   28.06827  23.1%   5.1  245s
 6570341 4970466   30.59652   35   68   36.47675   28.09118  23.0%   5.1  250s
 6703884 5068895   31.34894   37   60   36.47675   28.11327  22.9%   5.1  255s
 6837824 5167053   33.31459   42   59   36.47675   28.13424  22.9%   5.1  260s
 6974053 5266412   31.77979   37   64   36.47675   28.15580  22.8%   5.1  265s
 7101023 5359444   35.55185   50   49   36.47675   28.17503  22.8%   5.1  270s
 7232477 5454427   35.01873   46   54   36.47675   28.19544  22.7%   5.1  275s
 7369585 5554807   33.16420   29   70   36.47675   28.21532  22.6%   5.1  280s
 7504033 5653713   30.85356   38   58   36.47675   28.23483  22.6%   5.1  285s
 7638039 5751908   28.99056   34   67   36.47675   28.25393  22.5%   5.1  290s
 7774613 5850995   32.18145   43   57   36.47675   28.27281  22.5%   5.1  295s
 7902813 5944657   35.61154   46   54   36.47675   28.28963  22.4%   5.1  300s

Explored 7903825 nodes (39925194 simplex iterations) in 300.01 seconds (435.44 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 36.4768 40.564 50 

Time limit reached
Best objective 3.647675372231e+01, best bound 2.828980633457e+01, gap 22.4443%

User-callback calls 15837543, time in user-callback 20.40 sec
--------------------------------
solve the problem in original formulation
The obj is 36.47675372230879.
The root upper bound is: 36.47675372230879, lower bound is: 12.572377396413668. The root gap is: 65.5332%. Runtime: 300.00763392448425.
[ 9 23 29 32 36 37 38 44 71 78 97]
Number of outliers: 11
--------------------------------
The decomposition time is 0.11745459772646427.
Optimal value: 99.99999982309198
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.11094975285232067.
Optimal value: 99.99999982309198
12.11640242909727
36.47026604635357
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 700 rows, 402 columns and 1900 nonzeros
Model fingerprint: 0x49013241
Model has 303 quadratic objective terms
Variable types: 102 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+03]
  Objective range  [6e-03, 1e+01]
  QObjective range [3e-02, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-02, 1e+03]
Found heuristic solution: objective 59.0766344
Presolve time: 0.00s
Presolved: 700 rows, 402 columns, 1900 nonzeros
Presolved model has 303 quadratic objective terms
Variable types: 102 continuous, 300 integer (300 binary)

Root relaxation: objective 1.211639e+01, 1274 iterations, 0.02 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   12.11639    0  168   59.07663   12.11639  79.5%     -    0s
H    0     0                      37.4006179   12.11639  67.6%     -    0s
H    0     0                      36.4767537   12.11639  66.8%     -    0s
     0     0   14.03879    0  175   36.47675   14.03879  61.5%     -    0s
     0     2   14.03879    0  175   36.47675   14.03879  61.5%     -    0s

Cutting planes:
  Learned: 17
  Clique: 6
  Inf proof: 2

Explored 5681 nodes (122281 simplex iterations) in 2.64 seconds (3.09 work units)
Thread count was 8 (of 52 available processors)

Solution count 3: 36.4768 37.4006 59.0766 

Optimal solution found (tolerance 1.00e-04)
Best objective 3.647675372231e+01, best bound 3.647675372231e+01, gap 0.0000%

User-callback calls 12505, time in user-callback 0.02 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 36.47675372230879.
The root upper bound is: 36.47675372230879, lower bound is: 14.038794880141502. The root gap is: 61.513%. Runtime: 2.645228862762451.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 701 rows, 403 columns and 2103 nonzeros
Model fingerprint: 0x585ecaff
Model has 303 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 103 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+03]
  QMatrix range    [1e-02, 5e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [6e-03, 1e+01]
  QObjective range [1e-09, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-02, 1e+03]
Presolve time: 0.01s
Presolved: 701 rows, 403 columns, 2103 nonzeros
Presolved model has 303 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 103 continuous, 300 integer (300 binary)

Root relaxation: objective 3.646973e+01, 827 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   36.46973    0   40          -   36.46973      -     -    0s
H    0     0                      76.9678218   36.46973  52.6%     -    0s
H    0     0                      76.9678118   36.46973  52.6%     -    0s
     0     0   36.46979    0   48   76.96781   36.46979  52.6%     -    0s
     0     0   36.46979    0   48   76.96781   36.46979  52.6%     -    0s
     0     0   36.46979    0   57   76.96781   36.46979  52.6%     -    0s
     0     0   36.46979    0   59   76.96781   36.46979  52.6%     -    0s
     0     0   36.46980    0   53   76.96781   36.46980  52.6%     -    0s
     0     0   36.46980    0   52   76.96781   36.46980  52.6%     -    0s
     0     0   36.46980    0   60   76.96781   36.46980  52.6%     -    0s
     0     0   36.46980    0   58   76.96781   36.46980  52.6%     -    0s
     0     0   36.46980    0   56   76.96781   36.46980  52.6%     -    0s
     0     0   36.46980    0   56   76.96781   36.46980  52.6%     -    0s
     0     0   36.46980    0   56   76.96781   36.46980  52.6%     -    0s
     0     0   36.46980    0   56   76.96781   36.46980  52.6%     -    0s
     0     0   36.46981    0   56   76.96781   36.46981  52.6%     -    0s
     0     0   36.46981    0   56   76.96781   36.46981  52.6%     -    0s
     0     0   36.46982    0   56   76.96781   36.46982  52.6%     -    0s
     0     0   36.46982    0   56   76.96781   36.46982  52.6%     -    0s
     0     0   36.46982    0   56   76.96781   36.46982  52.6%     -    0s
     0     0   36.46982    0   56   76.96781   36.46982  52.6%     -    0s
     0     0   36.46983    0   56   76.96781   36.46983  52.6%     -    0s
     0     0   36.46983    0   54   76.96781   36.46983  52.6%     -    0s
     0     0   36.46984    0   52   76.96781   36.46984  52.6%     -    0s
     0     0   36.46984    0   52   76.96781   36.46984  52.6%     -    0s
     0     0   36.46984    0   52   76.96781   36.46984  52.6%     -    0s
     0     0   36.46984    0   52   76.96781   36.46984  52.6%     -    0s
     0     0   36.46985    0   52   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   52   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   54   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   56   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   60   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   58   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   58   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   58   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   58   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   58   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   58   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   58   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   62   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   58   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   56   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   56   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   56   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   56   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   56   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   56   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   56   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   56   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   56   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   50   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   50   76.96781   36.46985  52.6%     -    0s
     0     0   36.46985    0   50   76.96781   36.46985  52.6%     -    0s
     0     0   36.47549    0   50   76.96781   36.47549  52.6%     -    0s
     0     0   36.47549    0   50   76.96781   36.47549  52.6%     -    0s
     0     0   36.47549    0   50   76.96781   36.47549  52.6%     -    0s
     0     0   36.47549    0   50   76.96781   36.47549  52.6%     -    0s
     0     0   36.47549    0   50   76.96781   36.47549  52.6%     -    0s
     0     0   36.47549    0   50   76.96781   36.47549  52.6%     -    0s
     0     0   36.47549    0   50   76.96781   36.47549  52.6%     -    0s
     0     0   36.47549    0   50   76.96781   36.47549  52.6%     -    0s
     0     0   36.47549    0   50   76.96781   36.47549  52.6%     -    0s
     0     0   36.47549    0   50   76.96781   36.47549  52.6%     -    0s
     0     0   36.47549    0   50   76.96781   36.47549  52.6%     -    0s
     0     0   36.47566    0   50   76.96781   36.47566  52.6%     -    0s
     0     0   36.47566    0   50   76.96781   36.47566  52.6%     -    0s
     0     0   36.47566    0   50   76.96781   36.47566  52.6%     -    0s
     0     0   36.47566    0   52   76.96781   36.47566  52.6%     -    0s
     0     0   36.47566    0   52   76.96781   36.47566  52.6%     -    0s
     0     0   36.47566    0   54   76.96781   36.47566  52.6%     -    0s
     0     0   36.47566    0   54   76.96781   36.47566  52.6%     -    0s
     0     0   36.47566    0   54   76.96781   36.47566  52.6%     -    0s
     0     0   36.47580    0   54   76.96781   36.47580  52.6%     -    0s
     0     0   36.47580    0   54   76.96781   36.47580  52.6%     -    0s
     0     0   36.47581    0   54   76.96781   36.47581  52.6%     -    0s
     0     0   36.47581    0   54   76.96781   36.47581  52.6%     -    0s
     0     0   36.47581    0   68   76.96781   36.47581  52.6%     -    0s
     0     0   36.47581    0   68   76.96781   36.47581  52.6%     -    0s
     0     0   36.47581    0   68   76.96781   36.47581  52.6%     -    0s
     0     0   36.47581    0   68   76.96781   36.47581  52.6%     -    0s
     0     0   36.47581    0   68   76.96781   36.47581  52.6%     -    0s
     0     0   36.47585    0   68   76.96781   36.47585  52.6%     -    0s
     0     0   36.47589    0   68   76.96781   36.47589  52.6%     -    0s
     0     0   36.47590    0   68   76.96781   36.47590  52.6%     -    0s
     0     0   36.47590    0   68   76.96781   36.47590  52.6%     -    0s
     0     0   36.47590    0   68   76.96781   36.47590  52.6%     -    0s
     0     0   36.47590    0   68   76.96781   36.47590  52.6%     -    0s
     0     0   36.47590    0   68   76.96781   36.47590  52.6%     -    0s
     0     0   36.47590    0   68   76.96781   36.47590  52.6%     -    0s
     0     0   36.47590    0   68   76.96781   36.47590  52.6%     -    0s
     0     0   36.47590    0   68   76.96781   36.47590  52.6%     -    0s
     0     0   36.47590    0   68   76.96781   36.47590  52.6%     -    0s
     0     0   36.47590    0   68   76.96781   36.47590  52.6%     -    0s
     0     0   36.47590    0   68   76.96781   36.47590  52.6%     -    0s
     0     0   36.47595    0   68   76.96781   36.47595  52.6%     -    0s
     0     0   36.47595    0   68   76.96781   36.47595  52.6%     -    0s
     0     0   36.47595    0   68   76.96781   36.47595  52.6%     -    0s
     0     0   36.47595    0   68   76.96781   36.47595  52.6%     -    0s
     0     0   36.47596    0   68   76.96781   36.47596  52.6%     -    0s
     0     0   36.47596    0   68   76.96781   36.47596  52.6%     -    0s
     0     0   36.47596    0   68   76.96781   36.47596  52.6%     -    0s
     0     0   36.47596    0   68   76.96781   36.47596  52.6%     -    0s
     0     0   36.47596    0   68   76.96781   36.47596  52.6%     -    0s
     0     0   36.47596    0   68   76.96781   36.47596  52.6%     -    0s
     0     0   36.47596    0   66   76.96781   36.47596  52.6%     -    0s
H    0     0                      37.6724454   36.47596  3.18%     -    1s
     0     2   36.47596    0   66   37.67245   36.47596  3.18%     -    1s
H   30    18                      37.0522149   36.47596  1.56%   126    2s
H   36    18                      36.8628753   36.47596  1.05%   109    2s
H  593   154                      36.4767721   36.47596  0.00%  29.9    3s
*  593   154              31      36.4767721   36.47596  0.00%  29.9    3s

Cutting planes:
  Learned: 40
  MIR: 8
  Inf proof: 1
  Relax-and-lift: 2

Explored 643 nodes (23312 simplex iterations) in 3.20 seconds (2.54 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 36.4768 36.8629 37.0522 ... 76.9678

Optimal solution found (tolerance 1.00e-04)
Best objective 3.647677213638e+01, best bound 3.647595660327e+01, gap 0.0022%

User-callback calls 3556, time in user-callback 0.02 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
36.47677213638097
The root upper bound is: 37.67244542126912, lower bound is: 36.47595660327148. The root gap is: 3.176%. Runtime: 3.19978404045105.
--------------------------------------------------
    m    n   dataset formulation  ...     end_lb   end_gap  node_count        time
0   2   50   autompg    original  ...  13.477040  0.000000       987.0    0.143679
1   2   50   autompg         opt  ...  13.477040  0.000000       185.0    0.204820
2   2   50   autompg     opt_cut  ...  13.476018  0.000076         1.0    0.427783
3   2   60   autompg    original  ...  15.882434  0.000000     29340.0    1.159530
4   2   60   autompg         opt  ...  15.882434  0.000000       424.0    0.269396
5   2   60   autompg     opt_cut  ...  15.881267  0.000073         1.0    0.537511
6   2   70   autompg    original  ...  17.972364  0.000000     78473.0    3.126956
7   2   70   autompg         opt  ...  17.972364  0.000000       548.0    0.328985
8   2   70   autompg     opt_cut  ...  17.970774  0.000089        19.0    1.467074
9   2   80   autompg    original  ...  20.929447  0.000000    476643.0   15.951053
10  2   80   autompg         opt  ...  20.929447  0.000000       841.0    0.367925
11  2   80   autompg     opt_cut  ...  20.927765  0.000080         1.0    3.429426
12  2   90   autompg    original  ...  24.143764  0.000000   2228170.0   81.510934
13  2   90   autompg         opt  ...  24.143764  0.000000       918.0    0.468860
14  2   90   autompg     opt_cut  ...  24.141946  0.000075         1.0    1.659184
15  2  100   autompg    original  ...  25.330774  0.000000   3689803.0  142.390159
16  2  100   autompg         opt  ...  25.330774  0.000000      2899.0    1.223506
17  2  100   autompg     opt_cut  ...  25.328842  0.000076         1.0    0.927402
18  2  120   autompg    original  ...  28.559842  0.148020   6562358.0  300.003432
19  2  120   autompg         opt  ...  33.521731  0.000000      6372.0    1.858597
20  2  120   autompg     opt_cut  ...  33.520458  0.000038         1.0    0.787283
21  2  150   autompg    original  ...  33.869957  0.297969   5989982.0  300.006846
22  2  150   autompg         opt  ...  48.245685  0.000000      3739.0    2.486141
23  2  150   autompg     opt_cut  ...  48.242579  0.000064         1.0    0.988786
24  2  200   autompg    original  ...  40.793079  0.435888   4440447.0  300.007618
25  2  200   autompg         opt  ...  72.313781  0.000000      3168.0    3.767727
26  2  200   autompg     opt_cut  ...  72.312785  0.000014         1.0   23.892898
27  2   50  diabetes    original  ...  18.525737  0.000000    175326.0    3.872641
28  2   50  diabetes         opt  ...  18.525737  0.000000      3953.0    0.451626
29  2   50  diabetes     opt_cut  ...  18.525258  0.000026      1018.0    1.569300
30  2   60  diabetes    original  ...  22.068124  0.000004   2200400.0   51.412170
31  2   60  diabetes         opt  ...  22.068208  0.000000      3261.0    0.524591
32  2   60  diabetes     opt_cut  ...  22.067654  0.000025         1.0    1.399760
33  2   70  diabetes    original  ...  24.644680  0.019986  11280078.0  300.006553
34  2   70  diabetes         opt  ...  25.147268  0.000000      3459.0    0.884182
35  2   70  diabetes     opt_cut  ...  25.146075  0.000047       202.0    1.423506
36  2   80  diabetes    original  ...  25.849613  0.140627  10210416.0  300.007493
37  2   80  diabetes         opt  ...  30.079615  0.000000      3410.0    0.999763
38  2   80  diabetes     opt_cut  ...  30.078779  0.000028         1.0    0.788437
39  2   90  diabetes    original  ...  26.801958  0.197341   8594053.0  300.008093
40  2   90  diabetes         opt  ...  33.391463  0.000000     11158.0    2.062166
41  2   90  diabetes     opt_cut  ...  33.390274  0.000036      1671.0    3.321699
42  2  100  diabetes    original  ...  28.289806  0.224443   7903825.0  300.007634
43  2  100  diabetes         opt  ...  36.476754  0.000000      5681.0    2.645229
44  2  100  diabetes     opt_cut  ...  36.475957  0.000022       643.0    3.199784

[45 rows x 12 columns]
[2, 120, 'diabetes']
[0.0024381  0.00508062 1.         1.         1.        ]
The relaxed obj is 0.09757902864610912.
The larges value of x is 2.6956880472321503
Use new Big-M 5.3913760944643006.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 240 rows, 242 columns and 480 nonzeros
Model fingerprint: 0x7ccb3951
Model has 363 quadratic objective terms
Variable types: 122 continuous, 120 integer (120 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [4e-03, 1e+01]
  QObjective range [5e-02, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 60.0000000
Presolve time: 0.00s
Presolved: 240 rows, 242 columns, 480 nonzeros
Presolved model has 363 quadratic objective terms
Variable types: 122 continuous, 120 integer (120 binary)

Root relaxation: objective 1.613719e+01, 399 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   16.13719    0   97   60.00000   16.13719  73.1%     -    0s
H    0     0                      50.7321713   16.13719  68.2%     -    0s
H    0     0                      49.7951417   16.13719  67.6%     -    0s
H    0     0                      47.1403386   16.13719  65.8%     -    0s
H    0     0                      47.0076776   16.13719  65.7%     -    0s
     0     0   16.13719    0   97   47.00768   16.13719  65.7%     -    0s
H    0     0                      46.9428226   16.13719  65.6%     -    0s
H    0     0                      46.8093824   16.13719  65.5%     -    0s
     0     2   16.13719    0   97   46.80938   16.13719  65.5%     -    0s
 36689 31107   29.22318   24   95   46.80938   25.08079  46.4%   6.2    5s
 103215 88106   44.69931   53   62   46.80938   26.79043  42.8%   6.1   10s
 178105 152199   34.18752   37   79   46.80938   27.57399  41.1%   6.0   15s
 262640 223401   45.91211   63   48   46.80938   28.07139  40.0%   5.9   20s
 364294 310970   37.01996   42   79   46.80938   28.50669  39.1%   5.9   25s
 476533 405857   38.77099   44   76   46.80938   28.86583  38.3%   5.8   30s
 581141 494110   34.81258   37   83   46.80938   29.12702  37.8%   5.8   35s
 689080 586172   43.18193   50   62   46.80938   29.32693  37.3%   5.8   40s
 792398 673746   35.11951   36   83   46.80938   29.49742  37.0%   5.8   45s
 898376 762882   46.71681   56   63   46.80938   29.65581  36.6%   5.7   50s
 1009909 856865   32.26907   36   75   46.80938   29.79332  36.4%   5.7   55s
 1111168 942559   45.62948   48   64   46.80938   29.89945  36.1%   5.7   60s
 1224146 1038877   42.71599   58   53   46.80938   30.01697  35.9%   5.7   65s
 1322633 1122772   40.91485   46   74   46.80938   30.10109  35.7%   5.7   70s
 1436027 1217314   43.62938   51   59   46.80938   30.20375  35.5%   5.7   75s
 1532823 1299248   41.57915   49   71   46.80938   30.27905  35.3%   5.7   80s
 1641774 1392122   40.44376   46   70   46.80938   30.35883  35.1%   5.7   85s
 1746033 1479576   34.59144   36   83   46.80938   30.43149  35.0%   5.7   90s
 1851621 1570070   40.85370   45   73   46.80938   30.49545  34.9%   5.7   95s
 1962001 1662767   33.54877   35   88   46.80938   30.56832  34.7%   5.7  100s
 2077146 1760301   33.59009   36   77   46.80938   30.63235  34.6%   5.7  105s
 2182554 1849868   45.99484   63   56   46.80938   30.68870  34.4%   5.7  110s
 2291759 1941467   42.88976   52   63   46.80938   30.74662  34.3%   5.7  115s
 2397116 2030015   41.13972   49   62   46.80938   30.79822  34.2%   5.7  120s
 2499741 2116203   32.83035   33   80   46.80938   30.84561  34.1%   5.6  125s
 2610816 2209699   35.85957   36   87   46.80938   30.89467  34.0%   5.6  130s
 2715211 2296917   46.53022   66   51   46.80938   30.94194  33.9%   5.6  135s
 2824046 2389016   34.43735   36   79   46.80938   30.98833  33.8%   5.6  140s
 2924903 2475128   43.76676   61   50   46.80938   31.02511  33.7%   5.6  145s
 3032928 2565870   32.36177   27   86   46.80938   31.06515  33.6%   5.6  150s
 3137745 2653506   33.23029   34   81   46.80938   31.10505  33.5%   5.6  155s
 3238563 2739391   38.42961   42   71   46.80938   31.13928  33.5%   5.6  160s
 3347638 2831636   35.06617   38   83   46.80938   31.17994  33.4%   5.6  165s
 3450584 2918397     cutoff   56        46.80938   31.21395  33.3%   5.6  170s
 3560912 3011356   40.41565   42   75   46.80938   31.24920  33.2%   5.6  175s
 3664685 3099475   46.31550   69   50   46.80938   31.27969  33.2%   5.6  180s
 3774310 3191518   36.54914   37   79   46.80938   31.31541  33.1%   5.6  185s
 3877744 3278548   36.86417   43   69   46.80938   31.34518  33.0%   5.6  190s
 3989138 3371740   32.88851   29   91   46.80938   31.37985  33.0%   5.6  195s
 4094523 3459917   37.46532   38   79   46.80938   31.40955  32.9%   5.6  200s
 4204649 3552240   41.10144   46   78   46.80938   31.43988  32.8%   5.6  205s
 4303528 3635643   42.63863   53   59   46.80938   31.46592  32.8%   5.6  210s
 4407127 3722430   37.62865   44   76   46.80938   31.49277  32.7%   5.6  215s
 4520192 3816978   31.52571   30   91   46.80938   31.52128  32.7%   5.6  220s
 4624882 3904894   37.42129   40   81   46.80938   31.54719  32.6%   5.6  225s
 4734616 3996306   36.68047   36   75   46.80938   31.57379  32.5%   5.6  230s
 4839678 4084001   46.48569   55   59   46.80938   31.59960  32.5%   5.6  235s
 4949643 4175992   33.04775   34   86   46.80938   31.62495  32.4%   5.6  240s
 5053406 4263058   45.24055   67   45   46.80938   31.64737  32.4%   5.6  245s
 5163959 4356735   35.46907   36   84   46.80938   31.67138  32.3%   5.6  250s
 5266983 4443551   38.10411   41   71   46.80938   31.69338  32.3%   5.6  255s
 5376570 4535112   40.42266   40   72   46.80938   31.71795  32.2%   5.6  260s
 5479210 4621616   41.94627   46   75   46.80938   31.73793  32.2%   5.6  265s
 5587551 4711310   39.22511   49   62   46.80938   31.76030  32.1%   5.6  270s
 5696915 4803731   45.11838   69   45   46.80938   31.78327  32.1%   5.6  275s
 5801866 4896328   40.05745   51   61   46.80938   31.80412  32.1%   5.6  280s
 5911250 4983039   35.66600   39   81   46.80938   31.82520  32.0%   5.6  285s
 6016410 5071374   45.18924   63   49   46.80938   31.84478  32.0%   5.6  290s
 6128668 5165920   39.00190   44   71   46.80938   31.86396  31.9%   5.6  295s
 6235364 5254726   35.62683   34   88   46.80938   31.88314  31.9%   5.6  300s

Explored 6236067 nodes (34672897 simplex iterations) in 300.01 seconds (464.86 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 46.8094 46.9428 49.7951 ... 60

Time limit reached
Best objective 4.680938238231e+01, best bound 3.188313724960e+01, gap 31.8873%

User-callback calls 12504331, time in user-callback 15.07 sec
--------------------------------
solve the problem in original formulation
The obj is 46.80938238230787.
The root upper bound is: 46.80938238230787, lower bound is: 16.13718888578574. The root gap is: 65.5257%. Runtime: 300.0066361427307.
[  9  29  32  36  37  38  44  71  78  97 102 112 113 114 116 117]
Number of outliers: 16
--------------------------------
The decomposition time is 0.16908062621951103.
Optimal value: 119.99999987507502
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.1501652430742979.
Optimal value: 119.99999987507502
16.137192463418337
46.80883379859378
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 840 rows, 482 columns and 2280 nonzeros
Model fingerprint: 0x65836058
Model has 363 quadratic objective terms
Variable types: 122 continuous, 360 integer (360 binary)
Coefficient statistics:
  Matrix range     [3e-02, 1e+03]
  Objective range  [4e-03, 1e+01]
  QObjective range [5e-02, 1e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-03, 1e+03]
Found heuristic solution: objective 76.1380564
Presolve time: 0.00s
Presolved: 840 rows, 482 columns, 2280 nonzeros
Presolved model has 363 quadratic objective terms
Variable types: 122 continuous, 360 integer (360 binary)
Found heuristic solution: objective 74.5692661

Root relaxation: objective 1.613719e+01, 1173 iterations, 0.02 seconds (0.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   16.13719    0  194   74.56927   16.13719  78.4%     -    0s
H    0     0                      46.8093824   16.13719  65.5%     -    0s
     0     0   17.93848    0  194   46.80938   17.93848  61.7%     -    0s
     0     0   17.93848    0  194   46.80938   17.93848  61.7%     -    0s
     0     2   18.63837    0  194   46.80938   18.63837  60.2%     -    0s

Cutting planes:
  Learned: 9
  Cover: 1
  Clique: 5
  Inf proof: 2

Explored 5164 nodes (100469 simplex iterations) in 3.97 seconds (3.55 work units)
Thread count was 8 (of 52 available processors)

Solution count 2: 46.8094 74.5693 

Optimal solution found (tolerance 1.00e-04)
Best objective 4.680938238231e+01, best bound 4.680938238231e+01, gap 0.0000%

User-callback calls 11725, time in user-callback 0.03 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 46.80938238230785.
The root upper bound is: 46.80938238230785, lower bound is: 18.63837362551424. The root gap is: 60.1824%. Runtime: 3.9671170711517334.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 841 rows, 483 columns and 2523 nonzeros
Model fingerprint: 0x1c18bc8b
Model has 363 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 123 continuous, 360 integer (360 binary)
Coefficient statistics:
  Matrix range     [4e-03, 1e+03]
  QMatrix range    [3e-02, 6e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [4e-03, 1e+01]
  QObjective range [8e-10, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-03, 1e+03]
Presolve time: 0.01s
Presolved: 841 rows, 483 columns, 2523 nonzeros
Presolved model has 363 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 123 continuous, 360 integer (360 binary)

Root relaxation: objective 4.680870e+01, 1282 iterations, 0.02 seconds (0.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   46.80870    0  154          -   46.80870      -     -    0s
H    0     0                      82.8127192   46.80870  43.5%     -    0s
H    0     0                      82.8127167   46.80870  43.5%     -    0s
     0     0   46.80870    0  158   82.81272   46.80870  43.5%     -    0s
     0     0   46.80870    0  160   82.81272   46.80870  43.5%     -    0s
     0     0   46.80870    0  160   82.81272   46.80870  43.5%     -    0s
     0     0   46.80870    0  160   82.81272   46.80870  43.5%     -    0s
     0     0   46.80870    0  160   82.81272   46.80870  43.5%     -    0s
     0     0   46.80870    0  160   82.81272   46.80870  43.5%     -    0s
     0     0   46.80870    0  160   82.81272   46.80870  43.5%     -    0s
     0     0   46.80870    0  160   82.81272   46.80870  43.5%     -    0s
     0     0   46.80871    0  160   82.81272   46.80871  43.5%     -    0s
     0     0   46.80871    0  160   82.81272   46.80871  43.5%     -    0s
     0     0   46.80871    0  160   82.81272   46.80871  43.5%     -    0s
     0     0   46.80871    0  160   82.81272   46.80871  43.5%     -    0s
     0     0   46.80871    0  160   82.81272   46.80871  43.5%     -    0s
     0     0   46.80871    0  160   82.81272   46.80871  43.5%     -    0s
     0     0   46.80871    0  160   82.81272   46.80871  43.5%     -    0s
     0     0   46.80871    0  160   82.81272   46.80871  43.5%     -    0s
     0     0   46.80871    0  160   82.81272   46.80871  43.5%     -    0s
     0     0   46.80871    0  160   82.81272   46.80871  43.5%     -    0s
     0     0   46.80871    0  160   82.81272   46.80871  43.5%     -    0s
     0     0   46.80871    0  160   82.81272   46.80871  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  161   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  161   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  160   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  153   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  154   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  154   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  154   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  154   82.81272   46.80872  43.5%     -    0s
     0     0   46.80872    0  154   82.81272   46.80872  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
     0     0   46.80873    0  154   82.81272   46.80873  43.5%     -    0s
H    0     0                      79.5689968   46.80873  41.2%     -    0s
     0     0   46.80873    0  154   79.56900   46.80873  41.2%     -    0s
     0     0   46.80873    0  154   79.56900   46.80873  41.2%     -    0s
     0     0   46.80873    0  154   79.56900   46.80873  41.2%     -    0s
     0     0   46.80873    0  154   79.56900   46.80873  41.2%     -    0s
     0     0   46.80873    0  154   79.56900   46.80873  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80874    0  154   79.56900   46.80874  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
H    0     0                      79.5689963   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
     0     0   46.80875    0  154   79.56900   46.80875  41.2%     -    0s
H    0     0                      46.8093834   46.80875  0.00%     -    1s

Cutting planes:
  Learned: 21
  MIR: 24
  Relax-and-lift: 1

Explored 1 nodes (3207 simplex iterations) in 1.31 seconds (1.00 work units)
Thread count was 8 (of 52 available processors)

Solution count 4: 46.8094 79.569 79.569 82.8127 

Optimal solution found (tolerance 1.00e-04)
Best objective 4.680938340594e+01, best bound 4.680875109403e+01, gap 0.0014%

User-callback calls 1356, time in user-callback 0.01 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
46.80938340593678
The root upper bound is: 79.56899631600682, lower bound is: 46.80875109402997. The root gap is: 41.1721%. Runtime: 1.3162438869476318.
--------------------------------------------------
    m    n   dataset formulation  ...     end_lb   end_gap  node_count        time
0   2   50   autompg    original  ...  13.477040  0.000000       987.0    0.143679
1   2   50   autompg         opt  ...  13.477040  0.000000       185.0    0.204820
2   2   50   autompg     opt_cut  ...  13.476018  0.000076         1.0    0.427783
3   2   60   autompg    original  ...  15.882434  0.000000     29340.0    1.159530
4   2   60   autompg         opt  ...  15.882434  0.000000       424.0    0.269396
5   2   60   autompg     opt_cut  ...  15.881267  0.000073         1.0    0.537511
6   2   70   autompg    original  ...  17.972364  0.000000     78473.0    3.126956
7   2   70   autompg         opt  ...  17.972364  0.000000       548.0    0.328985
8   2   70   autompg     opt_cut  ...  17.970774  0.000089        19.0    1.467074
9   2   80   autompg    original  ...  20.929447  0.000000    476643.0   15.951053
10  2   80   autompg         opt  ...  20.929447  0.000000       841.0    0.367925
11  2   80   autompg     opt_cut  ...  20.927765  0.000080         1.0    3.429426
12  2   90   autompg    original  ...  24.143764  0.000000   2228170.0   81.510934
13  2   90   autompg         opt  ...  24.143764  0.000000       918.0    0.468860
14  2   90   autompg     opt_cut  ...  24.141946  0.000075         1.0    1.659184
15  2  100   autompg    original  ...  25.330774  0.000000   3689803.0  142.390159
16  2  100   autompg         opt  ...  25.330774  0.000000      2899.0    1.223506
17  2  100   autompg     opt_cut  ...  25.328842  0.000076         1.0    0.927402
18  2  120   autompg    original  ...  28.559842  0.148020   6562358.0  300.003432
19  2  120   autompg         opt  ...  33.521731  0.000000      6372.0    1.858597
20  2  120   autompg     opt_cut  ...  33.520458  0.000038         1.0    0.787283
21  2  150   autompg    original  ...  33.869957  0.297969   5989982.0  300.006846
22  2  150   autompg         opt  ...  48.245685  0.000000      3739.0    2.486141
23  2  150   autompg     opt_cut  ...  48.242579  0.000064         1.0    0.988786
24  2  200   autompg    original  ...  40.793079  0.435888   4440447.0  300.007618
25  2  200   autompg         opt  ...  72.313781  0.000000      3168.0    3.767727
26  2  200   autompg     opt_cut  ...  72.312785  0.000014         1.0   23.892898
27  2   50  diabetes    original  ...  18.525737  0.000000    175326.0    3.872641
28  2   50  diabetes         opt  ...  18.525737  0.000000      3953.0    0.451626
29  2   50  diabetes     opt_cut  ...  18.525258  0.000026      1018.0    1.569300
30  2   60  diabetes    original  ...  22.068124  0.000004   2200400.0   51.412170
31  2   60  diabetes         opt  ...  22.068208  0.000000      3261.0    0.524591
32  2   60  diabetes     opt_cut  ...  22.067654  0.000025         1.0    1.399760
33  2   70  diabetes    original  ...  24.644680  0.019986  11280078.0  300.006553
34  2   70  diabetes         opt  ...  25.147268  0.000000      3459.0    0.884182
35  2   70  diabetes     opt_cut  ...  25.146075  0.000047       202.0    1.423506
36  2   80  diabetes    original  ...  25.849613  0.140627  10210416.0  300.007493
37  2   80  diabetes         opt  ...  30.079615  0.000000      3410.0    0.999763
38  2   80  diabetes     opt_cut  ...  30.078779  0.000028         1.0    0.788437
39  2   90  diabetes    original  ...  26.801958  0.197341   8594053.0  300.008093
40  2   90  diabetes         opt  ...  33.391463  0.000000     11158.0    2.062166
41  2   90  diabetes     opt_cut  ...  33.390274  0.000036      1671.0    3.321699
42  2  100  diabetes    original  ...  28.289806  0.224443   7903825.0  300.007634
43  2  100  diabetes         opt  ...  36.476754  0.000000      5681.0    2.645229
44  2  100  diabetes     opt_cut  ...  36.475957  0.000022       643.0    3.199784
45  2  120  diabetes    original  ...  31.883137  0.318873   6236067.0  300.006636
46  2  120  diabetes         opt  ...  46.809382  0.000000      5164.0    3.967117
47  2  120  diabetes     opt_cut  ...  46.808751  0.000014         1.0    1.316244

[48 rows x 12 columns]
[2, 150, 'diabetes']
[0.00195736 0.00406352 1.         1.         1.        ]
The relaxed obj is 0.12301672417187604.
The larges value of x is 2.5267604574321094
Use new Big-M 5.053520914864219.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 300 rows, 302 columns and 600 nonzeros
Model fingerprint: 0xb7f0fa75
Model has 453 quadratic objective terms
Variable types: 152 continuous, 150 integer (150 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [3e-02, 2e+01]
  QObjective range [2e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 75.0000000
Presolve time: 0.01s
Presolved: 300 rows, 302 columns, 600 nonzeros
Presolved model has 453 quadratic objective terms
Variable types: 152 continuous, 150 integer (150 binary)

Root relaxation: objective 2.141138e+01, 497 iterations, 0.00 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   21.41138    0  128   75.00000   21.41138  71.5%     -    0s
H    0     0                      63.6080710   21.41138  66.3%     -    0s
H    0     0                      63.3083146   21.41138  66.2%     -    0s
H    0     0                      59.8172561   21.41138  64.2%     -    0s
H    0     0                      59.6895709   21.41138  64.1%     -    0s
     0     0   21.41138    0  128   59.68957   21.41138  64.1%     -    0s
H    0     0                      59.3987680   21.41138  64.0%     -    0s
     0     2   21.41138    0  128   59.39877   21.41138  64.0%     -    0s
H 1125  1087                      59.3916059   25.31132  57.4%   6.8    0s
 35665 31963   45.50730   41   97   59.39161   29.36672  50.6%   6.3    5s
 79322 70606   40.40485   31  118   59.39161   30.79704  48.1%   6.2   10s
 129639 115854   47.12101   40  102   59.39161   31.63454  46.7%   6.2   15s
 216112 192481   51.67782   56   79   59.39161   32.44514  45.4%   6.1   20s
 299300 265416   45.49102   43  105   59.39161   32.94732  44.5%   6.0   25s
 387590 344557   56.02555   66   74   59.39161   33.29133  43.9%   6.0   30s
 468609 417015   57.67249   61   83   59.39161   33.55597  43.5%   6.0   35s
 560688 499260   43.88725   38  100   59.39161   33.81040  43.1%   6.0   40s
 645860 575179   47.98681   51   88   59.39161   34.02159  42.7%   6.0   45s
 732097 652795   35.24229   25  113   59.39161   34.17549  42.5%   6.0   50s
 822702 733520   35.95874   28  118   59.39161   34.32874  42.2%   6.0   55s
 905436 806932   42.06400   38  107   59.39161   34.45986  42.0%   5.9   60s
 994829 886474   54.27315   58   77   59.39161   34.57458  41.8%   5.9   65s
 1077792 960611   46.07175   41   98   59.39161   34.66928  41.6%   5.9   70s
 1165154 1038759   35.85890   27  120   59.39161   34.77087  41.5%   5.9   75s
 1251922 1115579   37.67909   34  104   59.39161   34.86346  41.3%   5.9   80s
 1344881 1197208   43.19354   37  101   59.39161   34.95965  41.1%   5.9   85s
 1432847 1274823   47.50818   47   96   59.39161   35.04379  41.0%   5.9   90s
 1517803 1349967   43.15664   38  103   59.39161   35.11862  40.9%   5.9   95s
 1604146 1426666   51.55566   45   95   59.39161   35.18841  40.8%   5.9  100s
 1683361 1497504   49.52589   49   92   59.39161   35.24589  40.7%   5.9  105s
 1772859 1577186   51.13453   52   82   59.39161   35.31208  40.5%   5.9  110s
 1857125 1651929   45.19632   39  102   59.39161   35.37448  40.4%   5.9  115s
 1950303 1733991   46.35160   42  100   59.39161   35.44070  40.3%   5.9  120s
 2042416 1813901   43.99276   43  100   59.39161   35.50197  40.2%   5.9  125s
 2131508 1893572   46.87828   46   98   59.39161   35.55791  40.1%   5.9  130s
 2218826 1972296   57.33764   80   61   59.39161   35.60191  40.1%   5.8  135s
 2300050 2045091   54.77796   53   87   59.39161   35.64208  40.0%   5.8  140s
 2392831 2126564   40.13378   26  118   59.39161   35.69290  39.9%   5.8  145s
 2479166 2202865   44.17885   42  103   59.39161   35.74003  39.8%   5.8  150s
 2571659 2284603   46.25521   40  103   59.39161   35.78613  39.7%   5.8  155s
 2655792 2359113   41.71071   35  100   59.39161   35.82553  39.7%   5.8  160s
 2745918 2439211   45.25530   39  102   59.39161   35.86779  39.6%   5.8  165s
 2832153 2515325   37.33619   33  112   59.39161   35.90741  39.5%   5.8  170s
 2925079 2596849   59.11643   65   75   59.39161   35.95055  39.5%   5.8  175s
 3017657 2678599   47.75018   45   99   59.39161   35.98988  39.4%   5.8  180s
 3105062 2755078   58.52467   71   74   59.39161   36.02832  39.3%   5.8  185s
 3197135 2835336   54.37371   60   85   59.39161   36.06825  39.3%   5.8  190s
 3280363 2908624   46.95536   44   99   59.39161   36.09619  39.2%   5.8  195s
 3372521 2990236   45.15111   33  112   59.39161   36.13200  39.2%   5.8  200s
 3462206 3068984   51.89612   51   92   59.39161   36.16923  39.1%   5.8  205s
 3552932 3148335   36.91495   28  113   59.39161   36.19998  39.0%   5.8  210s
 3638639 3224794   43.45548   37  104   59.39161   36.22800  39.0%   5.8  215s
 3731812 3306645   50.12958   52   88   59.39161   36.26200  38.9%   5.8  220s
 3826860 3389594   46.27409   48   91   59.39161   36.29421  38.9%   5.8  225s
 3911886 3465366   52.88681   56   86   59.39161   36.32153  38.8%   5.8  230s
 4006595 3547820   44.92112   44  101   59.39161   36.35270  38.8%   5.8  235s
 4088634 3620582   43.08436   35  110   59.39161   36.37514  38.8%   5.8  240s
 4187088 3705918   42.33601   36  103   59.39161   36.40777  38.7%   5.8  245s
 4275340 3783231   38.73499   31  114   59.39161   36.43369  38.7%   5.8  250s
 4364967 3863391   53.25051   52   91   59.39161   36.45744  38.6%   5.8  255s
 4452042 3939530   48.08295   42  100   59.39161   36.48304  38.6%   5.8  260s
 4544722 4021408   55.26416   67   74   59.39161   36.50809  38.5%   5.8  265s
 4630983 4097074   53.24809   57   84   59.39161   36.53017  38.5%   5.8  270s
 4724748 4180052   44.03805   36  102   59.39161   36.55639  38.4%   5.8  275s
 4813903 4258984   44.78229   41  100   59.39161   36.57674  38.4%   5.8  280s
 4899916 4334389   44.39495   38  103   59.39161   36.59813  38.4%   5.8  285s
 4993210 4416492   50.09151   48   96   59.39161   36.62419  38.3%   5.8  290s
 5076338 4490360   47.08495   47   96   59.39161   36.64354  38.3%   5.8  295s
 5166845 4571104   53.65993   63   81   59.39161   36.66150  38.3%   5.8  300s

Explored 5167644 nodes (29750369 simplex iterations) in 300.01 seconds (567.13 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 59.3916 59.3988 59.8173 ... 75

Time limit reached
Best objective 5.939160594934e+01, best bound 3.666162849797e+01, gap 38.2714%

User-callback calls 10364674, time in user-callback 13.17 sec
--------------------------------
solve the problem in original formulation
The obj is 59.3916059493381.
The root upper bound is: 59.39876797098508, lower bound is: 21.411375627213502. The root gap is: 63.9532%. Runtime: 300.007080078125.
[  9  29  32  36  37  57  71  97 102 112 113 116 117 129 130 135 137 138 139 141 145]
Number of outliers: 21
--------------------------------
The decomposition time is 0.24879755079746246.
Optimal value: 149.99999960986037
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.23712323233485222.
Optimal value: 149.99999960986037
21.41138886967562
59.38321291890301
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 1050 rows, 602 columns and 2850 nonzeros
Model fingerprint: 0x101db93a
Model has 453 quadratic objective terms
Variable types: 152 continuous, 450 integer (450 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+03]
  Objective range  [3e-02, 2e+01]
  QObjective range [2e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-02, 1e+03]
Presolve time: 0.00s
Presolved: 1050 rows, 602 columns, 2850 nonzeros
Presolved model has 453 quadratic objective terms
Variable types: 152 continuous, 450 integer (450 binary)

Root relaxation: objective 2.141138e+01, 1390 iterations, 0.03 seconds (0.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   21.41138    0  256          -   21.41138      -     -    0s
H    0     0                      60.0300971   21.41138  64.3%     -    0s
H    0     0                      59.3916059   21.41138  63.9%     -    0s
     0     0   22.68015    0  258   59.39161   22.68015  61.8%     -    0s
     0     2   23.02995    0  258   59.39161   23.02995  61.2%     -    0s

Cutting planes:
  Learned: 8
  Cover: 1
  Clique: 3

Explored 5981 nodes (136208 simplex iterations) in 4.54 seconds (5.09 work units)
Thread count was 8 (of 52 available processors)

Solution count 2: 59.3916 60.0301 

Optimal solution found (tolerance 1.00e-04)
Best objective 5.939160594934e+01, best bound 5.939160594934e+01, gap 0.0000%

User-callback calls 13474, time in user-callback 0.02 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 59.39160594933811.
The root upper bound is: 59.39160594933811, lower bound is: 23.029947436109335. The root gap is: 61.2236%. Runtime: 4.5364830493927.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 1051 rows, 603 columns and 3153 nonzeros
Model fingerprint: 0x1fba5382
Model has 453 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 153 continuous, 450 integer (450 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+03]
  QMatrix range    [1e-02, 8e+01]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [3e-02, 2e+01]
  QObjective range [2e-09, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-02, 1e+03]
Presolve time: 0.01s
Presolved: 1051 rows, 603 columns, 3153 nonzeros
Presolved model has 453 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 153 continuous, 450 integer (450 binary)

Root relaxation: objective 5.936729e+01, 1655 iterations, 0.03 seconds (0.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   59.36729    0  178          -   59.36729      -     -    0s
H    0     0                     137.9900148   59.36729  57.0%     -    0s
     0     0   59.36937    0  121  137.99001   59.36937  57.0%     -    0s
     0     0   59.36950    0  126  137.99001   59.36950  57.0%     -    0s
     0     0   59.37096    0  126  137.99001   59.37096  57.0%     -    0s
     0     0   59.37096    0  126  137.99001   59.37096  57.0%     -    0s
     0     0   59.37221    0  100  137.99001   59.37221  57.0%     -    0s
H    0     0                     136.0425618   59.37221  56.4%     -    0s
     0     0   59.37221    0  103  136.04256   59.37221  56.4%     -    0s
     0     0   59.37252    0   96  136.04256   59.37252  56.4%     -    0s
     0     0   59.37280    0  102  136.04256   59.37280  56.4%     -    0s
     0     0   59.37287    0  100  136.04256   59.37287  56.4%     -    0s
     0     0   59.37310    0  100  136.04256   59.37310  56.4%     -    0s
     0     0   59.37320    0  104  136.04256   59.37320  56.4%     -    0s
     0     0   59.37323    0   96  136.04256   59.37323  56.4%     -    0s
     0     0   59.37345    0  105  136.04256   59.37345  56.4%     -    0s
     0     0   59.37345    0  100  136.04256   59.37345  56.4%     -    0s
     0     0   59.37347    0   97  136.04256   59.37347  56.4%     -    0s
     0     0   59.37367    0   99  136.04256   59.37367  56.4%     -    0s
     0     0   59.37367    0  102  136.04256   59.37367  56.4%     -    0s
     0     0   59.37372    0   99  136.04256   59.37372  56.4%     -    0s
     0     0   59.37383    0   94  136.04256   59.37383  56.4%     -    1s
     0     0   59.37385    0  108  136.04256   59.37385  56.4%     -    1s
     0     0   59.37405    0  103  136.04256   59.37405  56.4%     -    1s
     0     0   59.37408    0   94  136.04256   59.37408  56.4%     -    1s
     0     0   59.37408    0   97  136.04256   59.37408  56.4%     -    1s
     0     0   59.37423    0  102  136.04256   59.37423  56.4%     -    1s
     0     0   59.37434    0   98  136.04256   59.37434  56.4%     -    1s
     0     0   59.37445    0  102  136.04256   59.37445  56.4%     -    1s
     0     0   59.37445    0   92  136.04256   59.37445  56.4%     -    1s
     0     0   59.37445    0  100  136.04256   59.37445  56.4%     -    1s
     0     0   59.37445    0  100  136.04256   59.37445  56.4%     -    1s
     0     0   59.37445    0   96  136.04256   59.37445  56.4%     -    1s
     0     0   59.37450    0  102  136.04256   59.37450  56.4%     -    1s
     0     0   59.37456    0   98  136.04256   59.37456  56.4%     -    1s
     0     0   59.37458    0  112  136.04256   59.37458  56.4%     -    1s
     0     0   59.37458    0  100  136.04256   59.37458  56.4%     -    1s
     0     0   59.37458    0  107  136.04256   59.37458  56.4%     -    2s
     0     0   59.37458    0  113  136.04256   59.37458  56.4%     -    2s
     0     0   59.37458    0  108  136.04256   59.37458  56.4%     -    2s
     0     0   59.37458    0  102  136.04256   59.37458  56.4%     -    2s
     0     0   59.37458    0  107  136.04256   59.37458  56.4%     -    2s
     0     0   59.37460    0  102  136.04256   59.37460  56.4%     -    2s
     0     0   59.37466    0  100  136.04256   59.37466  56.4%     -    2s
     0     0   59.37475    0   92  136.04256   59.37475  56.4%     -    2s
     0     0   59.37476    0  101  136.04256   59.37476  56.4%     -    2s
     0     0   59.37492    0   96  136.04256   59.37492  56.4%     -    3s
     0     0   59.37492    0  105  136.04256   59.37492  56.4%     -    3s
     0     0   59.37497    0   99  136.04256   59.37497  56.4%     -    3s
     0     0   59.37497    0  108  136.04256   59.37497  56.4%     -    3s
     0     0   59.37510    0   97  136.04256   59.37510  56.4%     -    3s
     0     0   59.37510    0   98  136.04256   59.37510  56.4%     -    3s
     0     0   59.37515    0  107  136.04256   59.37515  56.4%     -    3s
     0     0   59.37515    0  100  136.04256   59.37515  56.4%     -    3s
     0     0   59.37515    0  104  136.04256   59.37515  56.4%     -    3s
     0     0   59.37515    0   89  136.04256   59.37515  56.4%     -    3s
     0     0   59.37518    0  102  136.04256   59.37518  56.4%     -    4s
     0     0   59.37518    0   93  136.04256   59.37518  56.4%     -    4s
     0     0   59.37518    0  106  136.04256   59.37518  56.4%     -    4s
     0     0   59.37518    0  100  136.04256   59.37518  56.4%     -    4s
     0     0   59.37521    0   96  136.04256   59.37521  56.4%     -    4s
     0     0   59.37525    0   98  136.04256   59.37525  56.4%     -    4s
     0     0   59.37532    0  100  136.04256   59.37532  56.4%     -    4s
     0     0   59.37532    0   92  136.04256   59.37532  56.4%     -    4s
     0     0   59.37532    0  108  136.04256   59.37532  56.4%     -    4s
     0     0   59.37538    0  104  136.04256   59.37538  56.4%     -    4s
     0     0   59.37538    0   98  136.04256   59.37538  56.4%     -    5s
     0     0   59.37538    0  103  136.04256   59.37538  56.4%     -    5s
     0     0   59.37538    0   90  136.04256   59.37538  56.4%     -    5s
     0     0   59.37538    0  102  136.04256   59.37538  56.4%     -    5s
     0     0   59.37543    0  113  136.04256   59.37543  56.4%     -    5s
     0     0   59.37543    0  109  136.04256   59.37543  56.4%     -    5s
     0     0   59.37543    0  105  136.04256   59.37543  56.4%     -    5s
     0     0   59.37544    0   97  136.04256   59.37544  56.4%     -    5s
     0     0   59.37547    0  106  136.04256   59.37547  56.4%     -    5s
     0     0   59.37547    0  105  136.04256   59.37547  56.4%     -    5s
     0     0   59.37549    0  100  136.04256   59.37549  56.4%     -    5s
     0     0   59.37550    0   95  136.04256   59.37550  56.4%     -    6s
     0     0   59.37552    0  107  136.04256   59.37552  56.4%     -    6s
     0     0   59.37558    0   96  136.04256   59.37558  56.4%     -    6s
     0     0   59.37558    0   98  136.04256   59.37558  56.4%     -    6s
     0     0   59.37558    0   98  136.04256   59.37558  56.4%     -    6s
     0     0   59.37558    0  110  136.04256   59.37558  56.4%     -    6s
     0     0   59.37558    0  104  136.04256   59.37558  56.4%     -    6s
     0     0   59.37558    0  106  136.04256   59.37558  56.4%     -    6s
     0     0   59.37558    0  105  136.04256   59.37558  56.4%     -    6s
     0     0   59.37558    0   94  136.04256   59.37558  56.4%     -    6s
     0     0   59.37558    0  106  136.04256   59.37558  56.4%     -    7s
     0     0   59.37558    0   97  136.04256   59.37558  56.4%     -    7s
     0     0   59.37558    0  104  136.04256   59.37558  56.4%     -    7s
     0     0   59.37558    0  105  136.04256   59.37558  56.4%     -    7s
     0     0   59.37558    0   92  136.04256   59.37558  56.4%     -    7s
     0     0   59.37558    0  109  136.04256   59.37558  56.4%     -    7s
     0     0   59.37558    0   98  136.04256   59.37558  56.4%     -    7s
     0     0   59.37558    0  102  136.04256   59.37558  56.4%     -    7s
     0     0   59.37559    0   97  136.04256   59.37559  56.4%     -    7s
     0     0   59.37559    0  108  136.04256   59.37559  56.4%     -    7s
     0     0   59.37566    0  100  136.04256   59.37566  56.4%     -    7s
     0     0   59.37566    0  104  136.04256   59.37566  56.4%     -    7s
     0     0   59.37566    0  102  136.04256   59.37566  56.4%     -    7s
     0     0   59.37568    0  106  136.04256   59.37568  56.4%     -    7s
     0     0   59.37571    0  106  136.04256   59.37571  56.4%     -    8s
     0     0   59.37571    0  103  136.04256   59.37571  56.4%     -    8s
     0     0   59.37571    0   92  136.04256   59.37571  56.4%     -    8s
     0     0   59.37571    0  101  136.04256   59.37571  56.4%     -    8s
     0     0   59.37571    0   99  136.04256   59.37571  56.4%     -    8s
H    0     0                      76.9241709   59.37571  22.8%     -    8s
H    0     0                      60.8845139   59.37571  2.48%     -   12s
H    0     0                      59.3987700   59.37571  0.04%     -   20s
     0     0   59.38710    0   96   59.39877   59.38710  0.02%     -   31s
     0     0   59.38779    0   95   59.39877   59.38779  0.02%     -   31s
     0     0   59.38783    0   96   59.39877   59.38783  0.02%     -   31s
     0     0   59.38797    0   96   59.39877   59.38797  0.02%     -   31s
     0     0   59.38797    0   96   59.39877   59.38797  0.02%     -   31s
H    0     0                      59.3987680   59.38797  0.02%     -   31s
H    0     0                      59.3987680   59.38797  0.02%     -   32s
     0     2   59.38798    0   96   59.39877   59.38798  0.02%     -   32s
     3     6 infeasible    2        59.39877   59.38801  0.02%   0.0   38s
    69    27   59.39456   10    6   59.39877   59.38880  0.02%   0.0   40s
H   79    27                      59.3987680   59.38880  0.02%   0.0   40s
*  362    54              18      59.3916146   59.38894  0.00%   0.0   40s

Cutting planes:
  Learned: 12
  Cover: 46
  Implied bound: 1
  Clique: 118
  MIR: 12
  RLT: 14
  Relax-and-lift: 2
  BQP: 54
  PSD: 39

Explored 387 nodes (203777 simplex iterations) in 40.81 seconds (39.87 work units)
Thread count was 8 (of 52 available processors)

Solution count 6: 59.3916 59.3988 60.8845 ... 137.99

Optimal solution found (tolerance 1.00e-04)
Best objective 5.939161461151e+01, best bound 5.938894162213e+01, gap 0.0045%

User-callback calls 22831, time in user-callback 0.12 sec
/gpfs/projects/p32811/QP_indicator/experiments/Run_opt_formulation_cut_job1.py:103: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  model_ori.setObjective(res@res/2 + mu_g*beta_ori.T@beta_ori + lam.T@z_ori, GRB.MINIMIZE)
--------------------------------------------------
Solve the problem in the proposed formulation with cut
59.39161461150588
The root upper bound is: 59.39876799976203, lower bound is: 59.38797454529628. The root gap is: 0.0182%. Runtime: 40.80697703361511.
--------------------------------------------------
    m    n   dataset formulation  ...     end_lb   end_gap  node_count        time
0   2   50   autompg    original  ...  13.477040  0.000000       987.0    0.143679
1   2   50   autompg         opt  ...  13.477040  0.000000       185.0    0.204820
2   2   50   autompg     opt_cut  ...  13.476018  0.000076         1.0    0.427783
3   2   60   autompg    original  ...  15.882434  0.000000     29340.0    1.159530
4   2   60   autompg         opt  ...  15.882434  0.000000       424.0    0.269396
5   2   60   autompg     opt_cut  ...  15.881267  0.000073         1.0    0.537511
6   2   70   autompg    original  ...  17.972364  0.000000     78473.0    3.126956
7   2   70   autompg         opt  ...  17.972364  0.000000       548.0    0.328985
8   2   70   autompg     opt_cut  ...  17.970774  0.000089        19.0    1.467074
9   2   80   autompg    original  ...  20.929447  0.000000    476643.0   15.951053
10  2   80   autompg         opt  ...  20.929447  0.000000       841.0    0.367925
11  2   80   autompg     opt_cut  ...  20.927765  0.000080         1.0    3.429426
12  2   90   autompg    original  ...  24.143764  0.000000   2228170.0   81.510934
13  2   90   autompg         opt  ...  24.143764  0.000000       918.0    0.468860
14  2   90   autompg     opt_cut  ...  24.141946  0.000075         1.0    1.659184
15  2  100   autompg    original  ...  25.330774  0.000000   3689803.0  142.390159
16  2  100   autompg         opt  ...  25.330774  0.000000      2899.0    1.223506
17  2  100   autompg     opt_cut  ...  25.328842  0.000076         1.0    0.927402
18  2  120   autompg    original  ...  28.559842  0.148020   6562358.0  300.003432
19  2  120   autompg         opt  ...  33.521731  0.000000      6372.0    1.858597
20  2  120   autompg     opt_cut  ...  33.520458  0.000038         1.0    0.787283
21  2  150   autompg    original  ...  33.869957  0.297969   5989982.0  300.006846
22  2  150   autompg         opt  ...  48.245685  0.000000      3739.0    2.486141
23  2  150   autompg     opt_cut  ...  48.242579  0.000064         1.0    0.988786
24  2  200   autompg    original  ...  40.793079  0.435888   4440447.0  300.007618
25  2  200   autompg         opt  ...  72.313781  0.000000      3168.0    3.767727
26  2  200   autompg     opt_cut  ...  72.312785  0.000014         1.0   23.892898
27  2   50  diabetes    original  ...  18.525737  0.000000    175326.0    3.872641
28  2   50  diabetes         opt  ...  18.525737  0.000000      3953.0    0.451626
29  2   50  diabetes     opt_cut  ...  18.525258  0.000026      1018.0    1.569300
30  2   60  diabetes    original  ...  22.068124  0.000004   2200400.0   51.412170
31  2   60  diabetes         opt  ...  22.068208  0.000000      3261.0    0.524591
32  2   60  diabetes     opt_cut  ...  22.067654  0.000025         1.0    1.399760
33  2   70  diabetes    original  ...  24.644680  0.019986  11280078.0  300.006553
34  2   70  diabetes         opt  ...  25.147268  0.000000      3459.0    0.884182
35  2   70  diabetes     opt_cut  ...  25.146075  0.000047       202.0    1.423506
36  2   80  diabetes    original  ...  25.849613  0.140627  10210416.0  300.007493
37  2   80  diabetes         opt  ...  30.079615  0.000000      3410.0    0.999763
38  2   80  diabetes     opt_cut  ...  30.078779  0.000028         1.0    0.788437
39  2   90  diabetes    original  ...  26.801958  0.197341   8594053.0  300.008093
40  2   90  diabetes         opt  ...  33.391463  0.000000     11158.0    2.062166
41  2   90  diabetes     opt_cut  ...  33.390274  0.000036      1671.0    3.321699
42  2  100  diabetes    original  ...  28.289806  0.224443   7903825.0  300.007634
43  2  100  diabetes         opt  ...  36.476754  0.000000      5681.0    2.645229
44  2  100  diabetes     opt_cut  ...  36.475957  0.000022       643.0    3.199784
45  2  120  diabetes    original  ...  31.883137  0.318873   6236067.0  300.006636
46  2  120  diabetes         opt  ...  46.809382  0.000000      5164.0    3.967117
47  2  120  diabetes     opt_cut  ...  46.808751  0.000014         1.0    1.316244
48  2  150  diabetes    original  ...  36.661628  0.382714   5167644.0  300.007080
49  2  150  diabetes         opt  ...  59.391606  0.000000      5981.0    4.536483
50  2  150  diabetes     opt_cut  ...  59.388942  0.000045       387.0   40.806977

[51 rows x 12 columns]
[2, 200, 'diabetes']
[0.00155409 0.00275084 1.         1.         1.        ]
The relaxed obj is 0.16381510180728753.
The larges value of x is 2.559327317026951
Use new Big-M 5.118654634053902.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 400 rows, 402 columns and 800 nonzeros
Model fingerprint: 0xcb467333
Model has 603 quadratic objective terms
Variable types: 202 continuous, 200 integer (200 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+00]
  Objective range  [4e-02, 3e+01]
  QObjective range [6e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [0e+00, 0e+00]
Found heuristic solution: objective 100.0000000
Presolve time: 0.00s
Presolved: 400 rows, 402 columns, 800 nonzeros
Presolved model has 603 quadratic objective terms
Variable types: 202 continuous, 200 integer (200 binary)

Root relaxation: objective 2.821978e+01, 659 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   28.21978    0  169  100.00000   28.21978  71.8%     -    0s
H    0     0                      84.6727818   28.21978  66.7%     -    0s
H    0     0                      84.0228542   28.21978  66.4%     -    0s
H    0     0                      78.8588512   28.21978  64.2%     -    0s
H    0     0                      78.8379447   28.21978  64.2%     -    0s
     0     0   28.21978    0  169   78.83794   28.21978  64.2%     -    0s
H    0     0                      78.2052811   28.21978  63.9%     -    0s
     0     2   28.21978    0  169   78.20528   28.21978  63.9%     -    0s
 51671 46963   56.81615   50  136   78.20528   36.23425  53.7%   7.0    5s
 120490 109555   59.92629   47  139   78.20528   38.12910  51.2%   6.7   10s
 195870 177365   76.02130   86   93   78.20528   39.08898  50.0%   6.7   15s
 271304 244096   46.72660   32  149   78.20528   39.69666  49.2%   6.6   20s
 342656 308734   66.77868   54  127   78.20528   40.02816  48.8%   6.6   25s
 414839 374532   56.70136   43  142   78.20528   40.31328  48.5%   6.6   30s
 480145 434048   55.84580   50  131   78.20528   40.50321  48.2%   6.6   35s
 553616 500582   60.04455   56  131   78.20528   40.72674  47.9%   6.6   40s
 621315 562303   73.85616   77  105   78.20528   40.90764  47.7%   6.6   45s
 690442 625311   45.46397   31  152   78.20528   41.04641  47.5%   6.6   50s
 766352 692693   57.70267   43  147   78.20528   41.20946  47.3%   6.6   55s
 832977 753084   66.06272   57  128   78.20528   41.34145  47.1%   6.5   60s
 903012 817552   43.05688   23  158   78.20528   41.44285  47.0%   6.5   65s
 972322 878745   74.35574   81  104   78.20528   41.55662  46.9%   6.5   70s
 1045929 945401   57.31976   51  129   78.20528   41.67229  46.7%   6.5   75s
 1119748 1012314   47.37316   34  154   78.20528   41.77296  46.6%   6.5   80s
 1179632 1067718   75.41434   78  105   78.20528   41.83187  46.5%   6.5   85s
 1252855 1133777   50.25012   40  142   78.20528   41.91346  46.4%   6.5   90s
 1318264 1193198   77.95035   81  103   78.20528   41.98684  46.3%   6.5   95s
 1389005 1258184   61.55918   54  135   78.20528   42.05396  46.2%   6.5  100s
 1461395 1323716   50.41630   38  142   78.20528   42.12721  46.1%   6.5  105s
 1527334 1383344   65.09049   59  128   78.20528   42.19137  46.1%   6.5  110s
 1603066 1451279   61.13093   46  140   78.20528   42.27003  45.9%   6.5  115s
 1673058 1514152   68.05083   69  111   78.20528   42.33461  45.9%   6.5  120s
 1747635 1580840   67.18441   55  132   78.20528   42.40083  45.8%   6.5  125s
 1820868 1646622   76.30339   91   93   78.20528   42.46075  45.7%   6.5  130s
 1885828 1706350   75.63801  104   76   78.20528   42.50518  45.6%   6.5  135s
 1957442 1770279   47.11811   37  151   78.20528   42.56250  45.6%   6.5  140s
 2026844 1832803   53.78988   45  138   78.20528   42.60921  45.5%   6.5  145s
 2096903 1896300   50.40010   38  140   78.20528   42.66429  45.4%   6.5  150s
 2169186 1961559   68.86681   64  124   78.20528   42.71378  45.4%   6.5  155s
 2235833 2021901   77.02570   88   95   78.20528   42.75467  45.3%   6.5  160s
 2307962 2086798   75.27244   88   94   78.20528   42.79831  45.3%   6.5  165s
 2379918 2152299   58.15286   55  129   78.20528   42.83588  45.2%   6.5  170s
 2448863 2214078   76.01493   94   88   78.20528   42.88206  45.2%   6.5  175s
 2515239 2274427   57.79132   36  151   78.20528   42.91583  45.1%   6.5  180s
 2578503 2331405   67.17397   64  115   78.20528   42.95214  45.1%   6.5  185s
 2645236 2391830   74.63633   85  101   78.20528   42.98994  45.0%   6.5  190s
 2710599 2451284   60.36138   52  132   78.20528   43.02304  45.0%   6.5  195s
 2774896 2508695   76.59489   86   97   78.20528   43.05880  44.9%   6.5  200s
 2842066 2569858   71.76015   68  118   78.20528   43.08891  44.9%   6.4  205s
 2909649 2630989   46.82317   35  149   78.20528   43.12014  44.9%   6.4  210s
 2972077 2686997   44.99999   32  152   78.20528   43.15204  44.8%   6.4  215s
 3039016 2747279   55.30655   44  139   78.20528   43.18222  44.8%   6.4  220s
 3108582 2809899   58.62407   45  138   78.20528   43.21542  44.7%   6.4  225s
 3168784 2865155   54.72934   43  140   78.20528   43.23999  44.7%   6.4  230s
 3230175 2922219   73.20705   81  101   78.20528   43.26015  44.7%   6.4  235s
 3292174 2977840   70.58906   72  110   78.20528   43.28555  44.7%   6.4  240s
 3357898 3037488   52.99244   39  148   78.20528   43.31132  44.6%   6.4  245s
 3429369 3101202   74.69560   91   92   78.20528   43.34234  44.6%   6.4  250s
 3492634 3157788   58.98602   48  140   78.20528   43.36767  44.5%   6.4  255s
 3560562 3218889   77.78578   71  113   78.20528   43.39541  44.5%   6.4  260s
 3627078 3279099   71.61080   68  115   78.20528   43.42176  44.5%   6.4  265s
 3692065 3337637   74.48580   72  117   78.20528   43.44832  44.4%   6.4  270s
 3754028 3395060   74.81114   82  105   78.20528   43.46455  44.4%   6.4  275s
 3824578 3458284   49.99374   37  149   78.20528   43.49229  44.4%   6.4  280s
 3888561 3515840   52.77750   45  139   78.20528   43.51846  44.4%   6.4  285s
 3957166 3577354   75.89749   85   99   78.20528   43.54288  44.3%   6.4  290s
 4030595 3642510   71.00352   67  113   78.20528   43.57208  44.3%   6.4  295s
 4093630 3698734   53.51791   42  146   78.20528   43.59455  44.3%   6.4  300s

Explored 4094093 nodes (26284837 simplex iterations) in 300.00 seconds (745.90 work units)
Thread count was 8 (of 52 available processors)

Solution count 5: 78.2053 78.8379 84.0229 ... 100

Time limit reached
Best objective 7.820528109713e+01, best bound 4.359495448648e+01, gap 44.2557%

User-callback calls 8217255, time in user-callback 9.73 sec
--------------------------------
solve the problem in original formulation
The obj is 78.20528109713308.
The root upper bound is: 78.20528109713308, lower bound is: 28.219777834926433. The root gap is: 63.9158%. Runtime: 300.00593614578247.
[  9  29  32  36  37  71  75  78  97 102 112 113 114 116 117 129 130 135 137 138 139 141 145 150 152 156 168 170 172 184 190]
Number of outliers: 31
--------------------------------
The decomposition time is 0.47929924726486206.
Optimal value: 199.99999937144096
The best pair is: [[0, 1]]
------------------------
The decomposition time is 0.4752335511147976.
Optimal value: 199.99999937144096
28.21978247085019
78.20424627039128
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 1400 rows, 802 columns and 3800 nonzeros
Model fingerprint: 0x4418049b
Model has 603 quadratic objective terms
Variable types: 202 continuous, 600 integer (600 binary)
Coefficient statistics:
  Matrix range     [3e-02, 1e+03]
  Objective range  [4e-02, 3e+01]
  QObjective range [6e-02, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-03, 1e+03]
Found heuristic solution: objective 131.0429713
Presolve time: 0.01s
Presolved: 1400 rows, 802 columns, 3800 nonzeros
Presolved model has 603 quadratic objective terms
Variable types: 202 continuous, 600 integer (600 binary)

Root relaxation: objective 2.821978e+01, 1971 iterations, 0.05 seconds (0.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   28.21978    0  338  131.04297   28.21978  78.5%     -    0s
H    0     0                      78.2052811   28.21978  63.9%     -    0s
     0     0   29.96915    0  338   78.20528   29.96915  61.7%     -    0s
     0     0   29.98575    0  338   78.20528   29.98575  61.7%     -    0s
     0     2   30.62455    0  338   78.20528   30.62455  60.8%     -    0s
  3957  1200     cutoff   27        78.20528   37.20773  52.4%  34.0    5s

Cutting planes:
  Learned: 7
  Clique: 4
  Inf proof: 2

Explored 7793 nodes (217798 simplex iterations) in 7.39 seconds (10.54 work units)
Thread count was 8 (of 52 available processors)

Solution count 2: 78.2053 131.043 

Optimal solution found (tolerance 1.00e-04)
Best objective 7.820528109713e+01, best bound 7.820528109713e+01, gap 0.0000%

User-callback calls 18568, time in user-callback 0.03 sec
--------------------------------------------------
Solve the optimal solution in the proposed formulation
The obj is 78.20528109713308.
The root upper bound is: 78.20528109713308, lower bound is: 30.624553672321802. The root gap is: 60.8408%. Runtime: 7.395298004150391.
--------------------------------------------------
- adding 1th pair.
Set parameter Threads to value 8
Set parameter TimeLimit to value 300
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 52 physical cores, 52 logical processors, using up to 8 threads

Optimize a model with 1401 rows, 803 columns and 4203 nonzeros
Model fingerprint: 0x294cbe48
Model has 603 quadratic objective terms
Model has 1 quadratic constraint
Variable types: 203 continuous, 600 integer (600 binary)
Coefficient statistics:
  Matrix range     [3e-02, 1e+03]
  QMatrix range    [3e-02, 1e+02]
  QLMatrix range   [1e+00, 1e+00]
  Objective range  [4e-02, 3e+01]
  QObjective range [3e-09, 2e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-03, 1e+03]
Presolve time: 0.01s
Presolved: 1401 rows, 803 columns, 4203 nonzeros
Presolved model has 603 quadratic objective terms
Presolved model has 1 quadratic constraint(s)
Variable types: 203 continuous, 600 integer (600 binary)

Root relaxation: objective 7.820378e+01, 2072 iterations, 0.05 seconds (0.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   78.20378    0  256          -   78.20378      -     -    0s
H    0     0                     139.5583510   78.20378  44.0%     -    0s
     0     0   78.20386    0  262  139.55835   78.20386  44.0%     -    0s
     0     0   78.20386    0  264  139.55835   78.20386  44.0%     -    0s
     0     0   78.20386    0  266  139.55835   78.20386  44.0%     -    0s
     0     0   78.20386    0  266  139.55835   78.20386  44.0%     -    0s
     0     0   78.20386    0  270  139.55835   78.20386  44.0%     -    0s
     0     0   78.20387    0  270  139.55835   78.20387  44.0%     -    0s
     0     0   78.20388    0  270  139.55835   78.20388  44.0%     -    0s
     0     0   78.20389    0  270  139.55835   78.20389  44.0%     -    0s
     0     0   78.20389    0  270  139.55835   78.20389  44.0%     -    0s
     0     0   78.20389    0  270  139.55835   78.20389  44.0%     -    0s
     0     0   78.20390    0  270  139.55835   78.20390  44.0%     -    0s
     0     0   78.20391    0  270  139.55835   78.20391  44.0%     -    0s
     0     0   78.20391    0  270  139.55835   78.20391  44.0%     -    0s
     0     0   78.20392    0  270  139.55835   78.20392  44.0%     -    0s
     0     0   78.20392    0  270  139.55835   78.20392  44.0%     -    0s
     0     0   78.20392    0  270  139.55835   78.20392  44.0%     -    0s
     0     0   78.20393    0  270  139.55835   78.20393  44.0%     -    0s
     0     0   78.20393    0  270  139.55835   78.20393  44.0%     -    0s
     0     0   78.20394    0  270  139.55835   78.20394  44.0%     -    0s
     0     0   78.20395    0  270  139.55835   78.20395  44.0%     -    0s
     0     0   78.20395    0  270  139.55835   78.20395  44.0%     -    0s
     0     0   78.20395    0  270  139.55835   78.20395  44.0%     -    0s
     0     0   78.20395    0  270  139.55835   78.20395  44.0%     -    0s
     0     0   78.20396    0  270  139.55835   78.20396  44.0%     -    0s
     0     0   78.20396    0  270  139.55835   78.20396  44.0%     -    0s
     0     0   78.20396    0  270  139.55835   78.20396  44.0%     -    0s
     0     0   78.20397    0  270  139.55835   78.20397  44.0%     -    0s
     0     0   78.20397    0  270  139.55835   78.20397  44.0%     -    0s
     0     0   78.20398    0  270  139.55835   78.20398  44.0%     -    0s
     0     0   78.20398    0  270  139.55835   78.20398  44.0%     -    0s
     0     0   78.20398    0  270  139.55835   78.20398  44.0%     -    0s
     0     0   78.20398    0  273  139.55835   78.20398  44.0%     -    0s
     0     0   78.20398    0  270  139.55835   78.20398  44.0%     -    0s
     0     0   78.20398    0  270  139.55835   78.20398  44.0%     -    0s
     0     0   78.20398    0  270  139.55835   78.20398  44.0%     -    0s
     0     0   78.20398    0  270  139.55835   78.20398  44.0%     -    0s
     0     0   78.20398    0  270  139.55835   78.20398  44.0%     -    0s
     0     0   78.20399    0  270  139.55835   78.20399  44.0%     -    0s
     0     0   78.20399    0  270  139.55835   78.20399  44.0%     -    0s
     0     0   78.20400    0  270  139.55835   78.20400  44.0%     -    0s
     0     0   78.20400    0  270  139.55835   78.20400  44.0%     -    0s
     0     0   78.20400    0  270  139.55835   78.20400  44.0%     -    0s
     0     0   78.20401    0  270  139.55835   78.20401  44.0%     -    0s
     0     0   78.20401    0  270  139.55835   78.20401  44.0%     -    0s
     0     0   78.20401    0  270  139.55835   78.20401  44.0%     -    0s
     0     0   78.20401    0  270  139.55835   78.20401  44.0%     -    0s
     0     0   78.20402    0  270  139.55835   78.20402  44.0%     -    0s
     0     0   78.20402    0  270  139.55835   78.20402  44.0%     -    0s
     0     0   78.20402    0  270  139.55835   78.20402  44.0%     -    0s
     0     0   78.20403    0  270  139.55835   78.20403  44.0%     -    0s
     0     0   78.20403    0  270  139.55835   78.20403  44.0%     -    0s
     0     0   78.20403    0  270  139.55835   78.20403  44.0%     -    0s
     0     0   78.20403    0  270  139.55835   78.20403  44.0%     -    0s
     0     0   78.20404    0  270  139.55835   78.20404  44.0%     -    0s
     0     0   78.20404    0  270  139.55835   78.20404  44.0%     -    0s
     0     0   78.20405    0  270  139.55835   78.20405  44.0%     -    0s
     0     0   78.20405    0  270  139.55835   78.20405  44.0%     -    0s
     0     0   78.20405    0  270  139.55835   78.20405  44.0%     -    0s
     0     0   78.20405    0  270  139.55835   78.20405  44.0%     -    1s
     0     0   78.20406    0  270  139.55835   78.20406  44.0%     -    1s
     0     0   78.20406    0  270  139.55835   78.20406  44.0%     -    1s
     0     0   78.20406    0  270  139.55835   78.20406  44.0%     -    1s
     0     0   78.20407    0  270  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  270  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  262  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  262  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  262  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  262  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  262  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  262  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  262  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  266  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  265  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  264  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  258  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  258  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  256  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  256  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  256  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  256  139.55835   78.20407  44.0%     -    1s
     0     0   78.20407    0  256  139.55835   78.20407  44.0%     -    1s
H    0     0                      78.2052816   78.20407  0.00%     -    1s

Cutting planes:
  Learned: 23
  MIR: 22
  RLT: 1

Explored 1 nodes (8607 simplex iterations) in 1.74 seconds (1.45 work units)
Thread count was 8 (of 52 available processors)

Solution count 2: 78.2053 139.558 

Optimal solution found (tolerance 1.00e-04)
Best objective 7.820528158763e+01, best bound 7.820406804572e+01, gap 0.0016%

User-callback calls 1263, time in user-callback 0.01 sec
--------------------------------------------------
Solve the problem in the proposed formulation with cut
78.20528158762946
The root upper bound is: 139.55835095261568, lower bound is: 78.20406804572386. The root gap is: 43.9632%. Runtime: 1.7419657707214355.
--------------------------------------------------
    m    n   dataset formulation  ...     end_lb   end_gap  node_count        time
0   2   50   autompg    original  ...  13.477040  0.000000       987.0    0.143679
1   2   50   autompg         opt  ...  13.477040  0.000000       185.0    0.204820
2   2   50   autompg     opt_cut  ...  13.476018  0.000076         1.0    0.427783
3   2   60   autompg    original  ...  15.882434  0.000000     29340.0    1.159530
4   2   60   autompg         opt  ...  15.882434  0.000000       424.0    0.269396
5   2   60   autompg     opt_cut  ...  15.881267  0.000073         1.0    0.537511
6   2   70   autompg    original  ...  17.972364  0.000000     78473.0    3.126956
7   2   70   autompg         opt  ...  17.972364  0.000000       548.0    0.328985
8   2   70   autompg     opt_cut  ...  17.970774  0.000089        19.0    1.467074
9   2   80   autompg    original  ...  20.929447  0.000000    476643.0   15.951053
10  2   80   autompg         opt  ...  20.929447  0.000000       841.0    0.367925
11  2   80   autompg     opt_cut  ...  20.927765  0.000080         1.0    3.429426
12  2   90   autompg    original  ...  24.143764  0.000000   2228170.0   81.510934
13  2   90   autompg         opt  ...  24.143764  0.000000       918.0    0.468860
14  2   90   autompg     opt_cut  ...  24.141946  0.000075         1.0    1.659184
15  2  100   autompg    original  ...  25.330774  0.000000   3689803.0  142.390159
16  2  100   autompg         opt  ...  25.330774  0.000000      2899.0    1.223506
17  2  100   autompg     opt_cut  ...  25.328842  0.000076         1.0    0.927402
18  2  120   autompg    original  ...  28.559842  0.148020   6562358.0  300.003432
19  2  120   autompg         opt  ...  33.521731  0.000000      6372.0    1.858597
20  2  120   autompg     opt_cut  ...  33.520458  0.000038         1.0    0.787283
21  2  150   autompg    original  ...  33.869957  0.297969   5989982.0  300.006846
22  2  150   autompg         opt  ...  48.245685  0.000000      3739.0    2.486141
23  2  150   autompg     opt_cut  ...  48.242579  0.000064         1.0    0.988786
24  2  200   autompg    original  ...  40.793079  0.435888   4440447.0  300.007618
25  2  200   autompg         opt  ...  72.313781  0.000000      3168.0    3.767727
26  2  200   autompg     opt_cut  ...  72.312785  0.000014         1.0   23.892898
27  2   50  diabetes    original  ...  18.525737  0.000000    175326.0    3.872641
28  2   50  diabetes         opt  ...  18.525737  0.000000      3953.0    0.451626
29  2   50  diabetes     opt_cut  ...  18.525258  0.000026      1018.0    1.569300
30  2   60  diabetes    original  ...  22.068124  0.000004   2200400.0   51.412170
31  2   60  diabetes         opt  ...  22.068208  0.000000      3261.0    0.524591
32  2   60  diabetes     opt_cut  ...  22.067654  0.000025         1.0    1.399760
33  2   70  diabetes    original  ...  24.644680  0.019986  11280078.0  300.006553
34  2   70  diabetes         opt  ...  25.147268  0.000000      3459.0    0.884182
35  2   70  diabetes     opt_cut  ...  25.146075  0.000047       202.0    1.423506
36  2   80  diabetes    original  ...  25.849613  0.140627  10210416.0  300.007493
37  2   80  diabetes         opt  ...  30.079615  0.000000      3410.0    0.999763
38  2   80  diabetes     opt_cut  ...  30.078779  0.000028         1.0    0.788437
39  2   90  diabetes    original  ...  26.801958  0.197341   8594053.0  300.008093
40  2   90  diabetes         opt  ...  33.391463  0.000000     11158.0    2.062166
41  2   90  diabetes     opt_cut  ...  33.390274  0.000036      1671.0    3.321699
42  2  100  diabetes    original  ...  28.289806  0.224443   7903825.0  300.007634
43  2  100  diabetes         opt  ...  36.476754  0.000000      5681.0    2.645229
44  2  100  diabetes     opt_cut  ...  36.475957  0.000022       643.0    3.199784
45  2  120  diabetes    original  ...  31.883137  0.318873   6236067.0  300.006636
46  2  120  diabetes         opt  ...  46.809382  0.000000      5164.0    3.967117
47  2  120  diabetes     opt_cut  ...  46.808751  0.000014         1.0    1.316244
48  2  150  diabetes    original  ...  36.661628  0.382714   5167644.0  300.007080
49  2  150  diabetes         opt  ...  59.391606  0.000000      5981.0    4.536483
50  2  150  diabetes     opt_cut  ...  59.388942  0.000045       387.0   40.806977
51  2  200  diabetes    original  ...  43.594954  0.442557   4094093.0  300.005936
52  2  200  diabetes         opt  ...  78.205281  0.000000      7793.0    7.395298
53  2  200  diabetes     opt_cut  ...  78.204068  0.000016         1.0    1.741966

[54 rows x 12 columns]
